{"version":3,"file":"qute-dev-all-0.9.0.min.js","sources":["../polyfill/lib/index.esm.js","../../core/commons/lib/index.esm.js","../../core/runtime/lib/index.esm.js","../../core/compiler/lib/index.esm.js","../../core/dev/lib/index.esm.js","../../plugins/router/lib/index.esm.js","../../components/modal/lib/index.esm.js","../../components/popup/lib/index.esm.js","../../components/spinner/lib/index.esm.js"],"sourcesContent":["import window from '@qutejs/window';\n\n/* Polyfill from https://developer.mozilla.org/en-US/docs/Web/API/Element/classList */\n\n// removed polyfill code for IE7-8 the target is IE>=9\nif (!window.DOMException) { (window.DOMException = function(reason) {\n    this.message = reason;\n}).prototype = new Error; }\n\nvar wsRE = /[\\11\\12\\14\\15\\40]/,\n    wsIndex = 0,\n    checkIfValidClassListEntry = function(O, V) {\n        if (V === \"\") { throw new DOMException(\n            \"Failed to execute '\" + O + \"' on 'DOMTokenList': The token provided must not be empty.\"); }\n        if ((wsIndex = V.search(wsRE)) !== -1) { throw new DOMException(\"Failed to execute '\" + O + \"' on 'DOMTokenList': \" +\n            \"The token provided ('\" + V[wsIndex] + \"') contains HTML space characters, which are not valid in tokens.\"); }\n    };\n\n// 1. Implement the barebones DOMTokenList livelyness polyfill\nif (typeof window.DOMTokenList !== \"function\") {\n    var hasOwnProp = Object.prototype.hasOwnProperty;\n    var defineProperty = Object.defineProperty,\n        allowTokenListConstruction = 0,\n        skipPropChange = 0;\n\n    var DOMTokenList = function() {\n        if (!allowTokenListConstruction) { throw TypeError(\"Illegal constructor\"); } // internally let it through\n    };\n    DOMTokenList.prototype.toString = DOMTokenList.prototype.toLocaleString = function() {\n        return this.value\n    };\n    DOMTokenList.prototype.add = function() {\n        var arguments$1 = arguments;\n\n        a: for (var v = 0, argLen = arguments.length, val = \"\", ele = this[\" uCL\"], proto = ele[\" uCLp\"]; v !== argLen; ++v) {\n            val = arguments$1[v] + \"\", checkIfValidClassListEntry(\"add\", val);\n            for (var i = 0, Len = proto.length, resStr = val; i !== Len; ++i)\n                { if (this[i] === val) { continue a; }\n                else { resStr += \" \" + this[i]; } }\n            this[Len] = val, proto.length += 1, proto.value = resStr;\n        }\n        skipPropChange = 1,\n        ele.className = proto.value,\n        skipPropChange = 0;\n    };\n    DOMTokenList.prototype.remove = function() {\n        var arguments$1 = arguments;\n\n        for (var v = 0, argLen = arguments.length, val = \"\", ele = this[\" uCL\"], proto = ele[\" uCLp\"]; v !== argLen; ++v) {\n            val = arguments$1[v] + \"\", checkIfValidClassListEntry(\"remove\", val);\n            for (var i = 0, Len = proto.length, resStr = \"\", is = 0; i !== Len; ++i)\n                { if (is) {\n                    this[i - 1] = this[i];\n                } else {\n                    if (this[i] !== val) {\n                        resStr += this[i] + \" \";\n                    } else {\n                        is = 1;\n                    }\n                } }\n            if (!is) { continue; }\n            delete this[Len], proto.length -= 1, proto.value = resStr;\n        }\n        skipPropChange = 1, ele.className = proto.value, skipPropChange = 0;\n    };\n    window.DOMTokenList = DOMTokenList;\n\n    var whenPropChanges = function() {\n        var evt = window.event,\n            prop = evt.propertyName;\n        if (!skipPropChange && (prop === \"className\" || (prop === \"classList\" && !defineProperty))) {\n            var target = evt.srcElement,\n                protoObjProto = target[\" uCLp\"],\n                strval = \"\" + target[prop];\n            var tokens = strval.trim().split(wsRE),\n                resTokenList = target[prop === \"classList\" ? \" uCL\" : \"classList\"];\n            var oldLen = protoObjProto.length;\n            a: for (var cI = 0, cLen = protoObjProto.length = tokens.length, sub = 0; cI !== cLen; ++cI) {\n                for (var innerI = 0; innerI !== cI; ++innerI)\n                    { if (tokens[innerI] === tokens[cI]) {\n                        sub++;\n                        continue a;\n                    } }\n                resTokenList[cI - sub] = tokens[cI];\n            }\n            for (var i = cLen - sub; i < oldLen; ++i) { delete resTokenList[i]; } //remove trailing indexs\n            if (prop !== \"classList\") { return; }\n            skipPropChange = 1, target.classList = resTokenList, target.className = strval;\n            skipPropChange = 0, resTokenList.length = tokens.length - sub;\n        }\n    };\n\n    var polyfillClassList = function(ele) {\n        if (!ele || !(\"innerHTML\" in ele)) { throw TypeError(\"Illegal invocation\"); }\n        ele.detachEvent(\"onpropertychange\", whenPropChanges); // prevent duplicate handler infinite loop\n        allowTokenListConstruction = 1;\n        var protoObj = function() {};\n        try {\n            protoObj.prototype = new DOMTokenList();\n        } finally {\n            allowTokenListConstruction = 0;\n        }\n        var protoObjProto = protoObj.prototype,\n            resTokenList = new protoObj();\n        a: for (var toks = ele.className.trim().split(wsRE), cI = 0, cLen = toks.length, sub = 0; cI !== cLen; ++cI) {\n            for (var innerI = 0; innerI !== cI; ++innerI)\n                { if (toks[innerI] === toks[cI]) {\n                    sub++;\n                    continue a;\n                } }\n            this[cI - sub] = toks[cI];\n        }\n        protoObjProto.length = cLen - sub, protoObjProto.value = ele.className, protoObjProto[\" uCL\"] = ele;\n        if (defineProperty) {\n            defineProperty(ele, \"classList\", { // IE8 & IE9 allow defineProperty on the DOM\n                enumerable: 1,\n                get: function() {\n                    return resTokenList\n                },\n                configurable: 0,\n                set: function(newVal) {\n                    skipPropChange = 1, ele.className = protoObjProto.value = (newVal += \"\"), skipPropChange = 0;\n                    var toks = newVal.trim().split(wsRE),\n                        oldLen = protoObjProto.length;\n                    a: for (var cI = 0, cLen = protoObjProto.length = toks.length, sub = 0; cI !== cLen; ++cI) {\n                        for (var innerI = 0; innerI !== cI; ++innerI)\n                            { if (toks[innerI] === toks[cI]) {\n                                sub++;\n                                continue a;\n                            } }\n                        resTokenList[cI - sub] = toks[cI];\n                    }\n                    for (var i = cLen - sub; i < oldLen; ++i) { delete resTokenList[i]; } //remove trailing indexs\n                }\n            });\n            defineProperty(ele, \" uCLp\", { // for accessing the hidden prototype\n                enumerable: 0,\n                configurable: 0,\n                writeable: 0,\n                value: protoObj.prototype\n            });\n            defineProperty(protoObjProto, \" uCL\", {\n                enumerable: 0,\n                configurable: 0,\n                writeable: 0,\n                value: ele\n            });\n        } else {\n            ele.classList = resTokenList, ele[\" uCL\"] = resTokenList, ele[\" uCLp\"] = protoObj.prototype;\n        }\n        ele.attachEvent(\"onpropertychange\", whenPropChanges);\n    };\n    window.Object.defineProperty(window.Element.prototype, \"classList\", {\n        enumerable: 1,\n        get: function(val) {\n            if (!hasOwnProp.call(this, \"classList\")) { polyfillClassList(this); }\n            return this.classList;\n        },\n        configurable: 0,\n        set: function(val) {\n            this.className = val;\n        }\n    });\n}\n\n// 2. Patch in unsupported methods in DOMTokenList\nvar DOMTokenListProto = window.DOMTokenList.prototype;\nvar testClass = window.document.createElement(\"div\").classList;\nif (!DOMTokenListProto.item) { DOMTokenListProto.item = function(i) {\n    function NullCheck(n) {\n        return n === void 0 ? null : n\n    }\n    return NullCheck(this[i]);\n}; }\nif (!DOMTokenListProto.toggle || testClass.toggle(\"a\", 0) !== false) { DOMTokenListProto.toggle = function(val) {\n    if (arguments.length > 1) { return (this[arguments[1] ? \"add\" : \"remove\"](val), !!arguments[1]); }\n    var oldValue = this.value;\n    return (this.remove(oldValue), oldValue === this.value && (this.add(val), true) /*|| false*/ );\n}; }\nif (!DOMTokenListProto.replace || typeof testClass.replace(\"a\", \"b\") !== \"boolean\")\n    { DOMTokenListProto.replace = function(oldToken, newToken) {\n        checkIfValidClassListEntry(\"replace\", oldToken), checkIfValidClassListEntry(\"replace\", newToken);\n        var oldValue = this.value;\n        return (this.remove(oldToken), this.value !== oldValue && (this.add(newToken), true));\n    }; }\nif (!DOMTokenListProto.contains) { DOMTokenListProto.contains = function(value) {\n    for (var i = 0, Len = this.length; i !== Len; ++i)\n        { if (this[i] === value) { return true; } }\n    return false;\n}; }\nif (!DOMTokenListProto.forEach) { DOMTokenListProto.forEach = function(f) {\n    if (arguments.length === 1)\n        { for (var i = 0, Len = this.length; i !== Len; ++i) { f(this[i], i, this); } }\n    else\n        { for (var i = 0, Len = this.length, tArg = arguments[1]; i !== Len; ++i) { f.call(tArg, this[i], i, this); } }\n}; }\nif (!DOMTokenListProto.entries) { DOMTokenListProto.entries = function() {\n    var nextIndex = 0,\n        that = this;\n    return {\n        next: function() {\n            return nextIndex < that.length ? {\n                value: [nextIndex, that[nextIndex]],\n                done: false\n            } : {\n                done: true\n            };\n        }\n    };\n}; }\nif (!DOMTokenListProto.values) { DOMTokenListProto.values = function() {\n    var nextIndex = 0,\n        that = this;\n    return {\n        next: function() {\n            return nextIndex < that.length ? {\n                value: that[nextIndex],\n                done: false\n            } : {\n                done: true\n            };\n        }\n    };\n}; }\nif (!DOMTokenListProto.keys) { DOMTokenListProto.keys = function() {\n    var nextIndex = 0,\n        that = this;\n    return {\n        next: function() {\n            return nextIndex < that.length ? {\n                value: nextIndex,\n                done: false\n            } : {\n                done: true\n            };\n        }\n    };\n}; }\n\n/* Polyfill from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign */\nif (typeof Object.assign !== 'function') {\n  // Must be writable: true, enumerable: false, configurable: true\n  Object.defineProperty(Object, \"assign\", {\n    value: function assign(target, varArgs) { // .length of function is 2\n      var arguments$1 = arguments;\n\n      if (target === null || target === undefined) {\n        throw new TypeError('Cannot convert undefined or null to object');\n      }\n\n      var to = Object(target);\n\n      for (var index = 1; index < arguments.length; index++) {\n        var nextSource = arguments$1[index];\n\n        if (nextSource !== null && nextSource !== undefined) {\n          for (var nextKey in nextSource) {\n            // Avoid bugs when hasOwnProperty is shadowed\n            if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n              to[nextKey] = nextSource[nextKey];\n            }\n          }\n        }\n      }\n      return to;\n    },\n    writable: true,\n    configurable: true\n  });\n}\n\n/*\n * Polyfill from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith\n */\n\nif (!String.prototype.startsWith) {\n    Object.defineProperty(String.prototype, 'startsWith', {\n        value: function(search, rawPos) {\n            var pos = rawPos > 0 ? rawPos|0 : 0;\n            return this.substring(pos, pos + search.length) === search;\n        }\n    });\n}\n\n/*\n * Polyfill from https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfills\n */\n\nif ( typeof window.CustomEvent !== \"function\" ) {\n\twindow.CustomEvent = function ( event, params ) {\n\t\tparams = params || { bubbles: false, cancelable: false, detail: null };\n\t\tvar evt = window.document.createEvent( 'CustomEvent' );\n\t\tevt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );\n\t\treturn evt;\n\t};\n}\n\n/**\n * Polyfill from https://developer.mozilla.org/en-US/docs/Web/API/Element/matches\n */\n\n// matches polyfill\nvar Element = window.Element;\nif (!Element.prototype.matches) {\n  Element.prototype.matches =\n      Element.prototype.matchesSelector ||\n      Element.prototype.mozMatchesSelector ||\n      Element.prototype.msMatchesSelector ||\n      Element.prototype.oMatchesSelector ||\n      Element.prototype.webkitMatchesSelector ||\n      function(s) {\n        var matches = (this.document || this.ownerDocument).querySelectorAll(s),\n            i = matches.length;\n        while (--i >= 0 && matches.item(i) !== this) {}\n        return i > -1;\n      };\n}\n\n// Polyfill from https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\n// closest polyfill\nif (!Element.prototype.closest) {\n  Element.prototype.closest = function(s) {\n    var el = this;\n    do {\n      if (el.matches(s)) { return el; }\n      el = el.parentElement || el.parentNode;\n    } while (el !== null && el.nodeType === 1);\n    return null;\n  };\n}\n//# sourceMappingURL=index.esm.js.map\n","var CAMEL_TO_KEBAB_RX = /([\\$A-Za-z0-9])([A-Z])/g;\n\nfunction camelToKebab(value) {\n\treturn value.replace(CAMEL_TO_KEBAB_RX, '$1-$2').toLowerCase();\n}\n\nfunction capitalizeFirst(value) {\n\treturn value[0].toUpperCase()+value.substring(1);\n}\n\nfunction kebabToCamel(value) {\n\tvar i = value.indexOf('-');\n\tif (i == -1) { return value; }\n\tvar out = value.substring(0, i);\n\tvar s = i+1;\n\ti = value.indexOf('-', s);\n\twhile (i > -1) {\n\t\tout += capitalizeFirst(value.substring(s, i));\n\t\ts = i+1;\n\t\ti = value.indexOf('-', s);\n\t}\n\tif (s < value.length) {\n\t\tout += capitalizeFirst(value.substring(s));\n\t}\n\treturn out;\n}\n\nexport { camelToKebab, capitalizeFirst, kebabToCamel };\n//# sourceMappingURL=index.esm.js.map\n","import window, { document } from '@qutejs/window';\nimport { kebabToCamel } from '@qutejs/commons';\n\nfunction ERR() {\n\tERR.resolve.apply(null, arguments);\n}\n\nERR.resolve = function() {\n\tthrow new Error('Qute Error: '+Array.prototype.slice.call(arguments));\n};\n\nfunction stopEvent(e) {\n\te.preventDefault();\n\te.stopPropagation();\n}\n\nfunction chainFnAfter(fn, prevFn) {\n\treturn prevFn ? function(arg) {\n\t\tprevFn(arg);\n\t\treturn fn(arg);\n\t} : fn;\n}\n\nfunction closestVM(el) {\n\twhile (el && !el.__qute__) {\n\t\tel = el.parentNode;\n\t}\n\treturn el && el.__qute__;\n}\n\n// filter is a an array whoes first item is true or false. See compiler x-attrs encoding\nfunction filterKeys(obj, filter) {\n\tvar keys = Object.keys(obj);\n\tif (filter) {\n\t\tvar incl = filter[0]; // true: include, false: exclude\n\t\treturn keys.filter(function(key) {\n\t\t\treturn (filter.indexOf(key, 1) > -1) === incl;\n\t\t});\n\t} else {\n\t\treturn keys;\n\t}\n}\n\nvar UpdateQueue = {\n\tmaxNestedLoops: 50,\n\tqueue: [],\n\tafter: null, // routines to run after the queue is processed\n\tpush: function(op) {\n\t\tif (!this.queue.length) { // schedule\n\t\t\tvar self = this;\n\t\t\twindow.setTimeout(function() {\n\t\t\t\tself.run();\n\t\t\t}, 0);\n\t\t}\n\t\tthis.queue.push(op);\n\t},\n\t// Add a callback to be invoked after the current queue run. If the queue is empty then the callback is immediately run\n\t// As queue tasks may push tasks into the queue, pushing a regular task in the queue after an update does not guarantee\n\t// the task will be run at the end.\n\t// This is usefull to test (to make assertion after all the uopdates where done)\n\t// Usually this method is called after an update\n\trunAfter: function(runAfterCb) {\n\t\tif (!this.queue.length) {\n\t\t\trunAfterCb();\n\t\t} else {\n\t\t\tif (!this.after) { this.after = [runAfterCb]; }\n\t\t\telse { this.after.push(runAfterCb); }\n\t\t}\n\t},\n\trun: function() {\n\t\tvar queue = this.queue;\n\t\tvar cnt = queue.length;\n\t\tvar max = cnt+this.maxNestedLoops; // allowed iteration to avoid infintite loops\n\t\twhile (queue.length > 0) {\n\t\t\tqueue[0]();\n\t\t\t// remove from queue after execution\n\t\t\tqueue.shift();\n\t\t\tif (++cnt > max) { ERR(30); }\n\t\t}\n\n\t\t// run the 'after' routines if any\n\t\tif (this.after) {\n\t\t\tvar after = this.after;\n\t\t\tfor (var i=0,l=after.length; i<l; i++) {\n\t\t\t\tafter[i]();\n\t\t\t}\n\t\t\tthis.after = null; // clear the after array\n\t\t}\n\t}\n\n};\n\nfunction Context(data) {\n\tif (data) { Object.assign(this, data); }\n\tthis.$topics = {lifecycle:[]}; // lifecycle is a bultin topic\n}\n\nContext.prototype = {\n\tpost: function(topic, msg, data) {\n\t\tvar listeners = this.$topics[topic];\n\t\tif (!listeners) { ERR(38, topic); }\n\t\tfor (var i=0,l=listeners.length;i<l;i++) {\n\t\t\tif (listeners[i](msg, data) === false) {\n\t\t\t\tbreak; // stop if one of the listeners returns false\n\t\t\t}\n\t\t}\n\t},\n\tpostAsync: function(topic, msg, data) {\n\t\tvar self = this;\n\t\twindow.setTimeout(function() { self.post(topic, msg, data); }, 0);\n\t},\n\tsubscribe: function(topic, listenerFn) {\n\t\tvar listeners = this.$topics[topic];\n\t\tif (!listeners) {\n\t\t\tthis.$topics[topic] = listeners = [];\n\t\t}\n\t\tlisteners.push(listenerFn);\n\t\treturn this;\n\t},\n\tsubscribeOnce: function(topic, event, listenerFn) {\n\t\tvar self = this;\n\t\tvar onceSubscription = function(msg, data) {\n\t\t\tif (msg === event) {\n\t\t\t\tlistenerFn(msg, data);\n\t\t\t\tself.unsubscribe(topic, onceSubscription);\n\t\t\t}\n\t\t};\n\t\tthis.subscribe(topic, onceSubscription);\n\t\treturn onceSubscription;\n\t},\n\tunsubscribe: function(topic, listenerFn) {\n\t\tvar listeners = this.$topics[topic];\n\t\tif (listeners) {\n\t\t\tvar i = listeners.indexOf(listenerFn);\n\t\t\tif (i > -1) {\n\t\t\t\tlisteners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t},\n\tfreeze: function() {\n\t\tObject.freeze(this);\n\t}\n};\n\nvar VMS = {};\nvar XTAGS = {};\n\nfunction getTag(tag) {\n\treturn XTAGS[tag];\n}\n\nfunction registerTag(tag, templateFn, isCompiled) {\n\tXTAGS[tag] = templateFn;\n\ttemplateFn.$compiled = !!isCompiled;\n\ttemplateFn.$tag = tag;\n\treturn templateFn;\n}\n\nfunction getVM(tag) {\n\treturn VMS[tag];\n}\n\nfunction registerVM(tag, vm) {\n\tVMS[tag] = vm;\n}\n\nfunction getVMOrTag(tag) {\n\treturn VMS[tag] || XTAGS[tag];\n}\n\nfunction snapshotRegistry() {\n\treturn {VMS: Object.assign({}, VMS), XTAGS: Object.assign({}, XTAGS)};\n}\n\nfunction restoreRegistry(snapshot) {\n\tVMS = snapshot.VMS;\n\tXTAGS = snapshot.XTAGS;\n}\n\nfunction addClassMap(cl, value) {\n\tvar keys = Object.keys(value);\n\tfor (var i=0,l=keys.length; i<l; i++) {\n\t\tvar key = keys[i];\n\t\tvar val = value[key];\n\t\tif (val) { cl.add(key); } else { cl.remove(key); }\n\t}\n}\n\nfunction bindClass(elt, value) {\n\tif (!value) { return; }\n\tvar cl = elt.classList;\n\tif (Array.isArray(value)) {\n\t\tfor (var i=0,l=value.length; i<l; i++) {\n\t\t\tvar val = value[i];\n\t\t\tif (val) {\n\t\t\t\tif (typeof val === 'string') {\n\t\t\t\t\tcl.add(val);\n\t\t\t\t} else { // an object?\n\t\t\t\t\taddClassMap(cl, val);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else { // an object\n\t\taddClassMap(cl, value);\n\t}\n}\n\nfunction bindStyle(elt, value) {\n\tif (!value) { return; }\n\tvar style = elt.style;\n\tif (Array.isArray(value)) {\n\t\tfor (var i=0,l=value.length; i<l; i++) {\n\t\t\tObject.assign(style, value[i]);\n\t\t}\n\t} else { // an object\n\t\tObject.assign(style, value);\n\t}\n\n}\n\n// the listeners injected from a vm to a nested functional view\n// must run in parent vm, context not in fucntional view context!\n// This is why we need to use the vm from the closure scope when the listener was created\nfunction createListener(vm, fn) {\n\treturn function(e) {\n\t\tif (fn.call(vm, e) === false) {\n\t\t\tstopEvent(e);\n\t\t}\n\t};\n}\n\nfunction createListeners(vm, $listeners) {\n\tif ($listeners) {\n\t\tfor (var key in $listeners) {\n\t\t\t$listeners[key] = createListener(vm, $listeners[key]);\n\t\t}\n\t}\n\treturn $listeners;\n}\n\nfunction SetText(el, model, expr) {\n\treturn function() {\n\t\tvar val = expr(model);\n\t\tif (val !== el.nodeValue) {\n\t\t\tel.nodeValue = val;\n\t\t}\n\t}\n}\n\nfunction SetAttr(el, model, key, valFn) {\n\treturn function(changedKey) {\n\t\t//if (!changedKey || changedKey === key) {\n\t\t\tvar val = valFn(model);\n\t\t\tif (el.getAttribute(key) !== val) {\n\t\t\t\tif (val == null) {\n\t\t\t\t\tel.removeAttribute(key);\n\t\t\t\t} else {\n\t\t\t\t\tel.setAttribute(key, val);\n\t\t\t\t}\n\t\t\t}\n\t\t//}\n\t}\n}\n\n/*\nexport function SetBindings(el, model, bindFn) {\n\treturn function(changedKey) {\n\t\tvar bindings = bindFn(model);\n\t\tfor (var key in bindings) {\n\t\t\tvar val = bindings[key];\n\t\t\tif (el.getAttribute(key) !== val) {\n\t\t\t\tel.setAttribute(key, val);\n\t\t\t}\n\t\t}\n\t}\n}\n*/\nfunction SetInnerHTML(el, model, valFn) {\n\treturn function() {\n\t\tvar val = valFn(model);\n\t\tif (el.innerHTML !== val) {\n\t\t\tel.innerHTML = val || '';\n\t\t}\n\t}\n}\n\nfunction SetDisplay(el, model, valFn) {\n\treturn function() {\n\t\tvar val = valFn(model);\n\t\tvar display = el.style.display;\n\t\t// backup the current diaply when toggliong OFF to be able to restore if needed\n\t\tif (val) {\n\t\t\tif (display === 'none') {\n\t\t\t\tel.style.display = el.__qute_display || ''; // remove 'none'\n\t\t\t}\n\t\t} else if (display !== 'none') {\n\t\t\tif (el.__qute_display == null) { el.__qute_display = display; }\n\t\t\tel.style.display = 'none';\n\t\t}\n\t}\n}\n\n\nfunction SetToggle(el, model, valFn) {\n\t// valFn returns a map of attr keys to values\n\treturn function() {\n\t\tvar attrs = valFn(model);\n\t\tvar keys = Object.keys(attrs);\n\t\tfor (var i=0,l=keys.length;i<l;i++) {\n\t\t\tvar key = keys[i];\n\t\t\tif (attrs[key]) {\n\t\t\t\tel.setAttribute(key, key);\n\t\t\t} else {\n\t\t\t\tel.removeAttribute(key);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction SetClass(el, model, valFn) {\n\treturn function() {\n\t\t//TODO only if modified\n\t\tbindClass(el, valFn(model));\n\t}\n}\n\nfunction SetStyle(el, model, valFn) {\n\treturn function() {\n\t\t//TODO only if modified\n\t\tbindStyle(el, valFn(model));\n\t}\n}\n\nfunction SetProp(vm, model, key, valFn) {\n\treturn function(changedKey) {\n\t\t//if (!changedKey || changedKey === key) {\n\t\t\tvm.$set(key, valFn(model));\n\t\t//}\n\t}\n}\n\nfunction SetDOMAttrs(el, model, filter) {\n\treturn function() {\n\t\tvar $attrs = model.$attrs;\n\t\tif ($attrs) {\n\t\t\tvar keys = filterKeys($attrs, filter);\n\t\t\tfor (var i=0,l=keys.length; i<l; i++) {\n\t\t\t\tvar key = keys[i];\n\t\t\t\tel.setAttribute(key, $attrs[key]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction SetFuncAttrs($attrs, vm, filter) { // vm is the parent vm (i.e. current model)\n\treturn function() {\n\t\tvar vmAttrs = vm.$attrs;\n\t\tif (vmAttrs) {\n\t\t\tvar keys = filterKeys(vmAttrs, filter);\n\t\t\tfor (var i=0,l=keys.length; i<l; i++) {\n\t\t\t\tvar key = keys[i];\n\t\t\t\t$attrs[key] = vmAttrs[key];\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction SetFuncAttr($attrs, vm, key, val) { // vm is the parent vm (i.e. current model)\n\treturn function() {\n\t\t$attrs[key] = val(vm);\n\t}\n}\n// TODO set $attrs on VMs\nfunction SetVMAttrs(vm, parentVM, filter) {\n\treturn function() {\n\t\tvar parentAttrs = parentVM.$attrs;\n\t\tif (parentAttrs) {\n\t\t\tvar keys = filterKeys(parentAttrs, filter);\n\t\t\tfor (var i=0,l=keys.length; i<l; i++) {\n\t\t\t\tvar key = keys[i];\n\t\t\t\tvm.$set(key, parentAttrs[key]);\n\t\t\t}\n\t\t}\n\t}\n}\n\n// emitter prototype\nvar Emitter = {\n\temit: function(event, data) {\n\t\tif (!this.$el) { ERR(35); }\n\t\tthis.$el.dispatchEvent(new window.CustomEvent(event, {bubbles: true, detail: data === undefined ? this : data }));\n\n\t},\n\temitAsync: function(event, data, timeout) {\n\t\tvar self = this;\n\t\twindow.setTimeout(function() { self.emit(event, data); }, timeout || 0);\n\t}\n};\n\nfunction ViewRenderingContext(model, marker, isExpr, changeCb, noCache, xattrs, childrenFn) {\n\n\tvar cache = noCache ? null : {};\n\tvar r = null; // the view rendering context\n\tvar cview = null; // current element\n\treturn function(propKey, initialUpdate) {\n\t\tvar el, viewXTag = isExpr(model);\n\t\tif (viewXTag !== cview) {\n\t\t\tvar parent = marker.parentNode;\n\t\t\tif (r) {\n\t\t\t\tr.$disconnect();\n\t\t\t\tparent.removeChild(marker.previousSibling);\n\t\t\t}\n\t\t\tif (viewXTag) {\n\t\t\t\tr = cache && cache[viewXTag];\n\t\t\t\tif (!r) {\n\t\t\t\t\tr = new Rendering(model);\n\t\t\t\t\tif (cache) { cache[viewXTag] = r; }\n\t\t\t\t}\n\t\t\t\tel = r.r(viewXTag, xattrs, childrenFn(r));\n\t\t\t\tparent.insertBefore(el, marker);\n\t\t\t\tr.$connect();\n\t\t\t} else {\n\t\t\t\tr = null;\n\t\t\t}\n\n\t\t\tif (changeCb && !initialUpdate) { // avoid calling changeCb the first time the if is rendered\n\t\t\t\tchangeCb.call(model, el && el.__qute__);\n\t\t\t}\n\t\t\tcview = viewXTag;\n\t\t} else if (r) {\n\t\t\t// only update children\n\t\t\tr.$update();\n\t\t}\n\t}\n}\n\nfunction IfRenderingContext(model, start, end, expr, changeCb, _if, _else) {\n\tvar r = null; // the IF / ELSE rendering context\n\tvar state = undefined; // the current IF / ELSE value\n\treturn function(propKey, initialUpdate) {\n\t\tvar newState = !!expr(model);\n\t\tif (newState !== state) {\n\t\t\tr && r.$disconnect();\n\t\t\tvar parent = start.parentNode;\n\t\t\t// remove current if branch\n\t\t\twhile (start.nextSibling && start.nextSibling !== end) {\n\t\t\t\tparent.removeChild(start.nextSibling);\n\t\t\t}\n\t\t\tr = new Rendering(model); // create the IF / ELSE rendering context\n\t\t\tstate = newState;\n\t\t\tvar children = state ? _if(r) : (_else ? _else(r) : []); //_else may not be defined\n\t\t\tfor (var i=0,l=children.length; i<l; i++) {\n\t\t\t\tparent.insertBefore(children[i], end);\n\t\t\t}\n\t\t\tr.$connect();\n\t\t\tif (changeCb && !initialUpdate) { // avoid calling changeCb the first time the if is rendered\n\t\t\t\tchangeCb.call(model, state);\n\t\t\t}\n\t\t} else if (r) {\n\t\t\t// only update children\n\t\t\tr.$update();\n\t\t}\n\t}\n}\n\nfunction ForRenderingContext(model, start, end, listFn, iterationFn) {\n\tvar r = null; // the for rendering context\n\tvar list = null; // the current list\n\treturn function(propKey) {\n\t\tvar newList = listFn(model);\n\t\tif (newList !== list) {\n\t\t\tr && r.$disconnect();\n\t\t\tvar parent = start.parentNode;\n\t\t\t// remove current for content\n\t\t\twhile (start.nextSibling && start.nextSibling !== end) {\n\t\t\t\tparent.removeChild(start.nextSibling);\n\t\t\t}\n\t\t\tr = new Rendering(model); // create the FOR rendering context\n\t\t\tlist = newList;\n\t\t\t// render content\n\t\t\tif (list) {\n\t\t\t\tif (!Array.isArray(list)) {\n\t\t\t\t\t//if (list instanceof List) ERR(25);\n\t\t\t\t\tif (list.$createListFragment) { ERR(25); }\n\t\t\t\t\tlist = Object.keys(list);\n\t\t\t\t}\n\t\t\t\tif (list.length > 0) {\n\t\t\t\t\tvar l = list.length-1;\n\t\t\t\t\tfor (var i=0; i<l; i++) {\n\t\t\t\t\t\tvar children = iterationFn(list[i], i, true);\n\t\t\t\t\t\tif (children) {\n\t\t\t\t\t\t\tfor (var k=0,ll=children.length; k<ll; k++) {\n\t\t\t\t\t\t\t\tparent.insertBefore(children[k], end);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar children = iterationFn(list[i], i, false);\n\t\t\t\t\tif (children) {\n\t\t\t\t\t\tfor (var i=0,l=children.length; i<l; i++) {\n\t\t\t\t\t\t\tparent.insertBefore(children[i], end);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tr.$connect();\n\t\t} else if (r) {\n\t\t\t// just update children\n\t\t\tr.$update();\n\t\t}\n\t}\n}\n\nfunction isVM(obj) {\n\treturn obj && obj.prototype && obj.prototype.__VM__;\n}\n\nfunction appendChildren(parent, children) {\n\tfor (var i=0, l=children.length; i<l; i++) { parent.appendChild(children[i]); }\n}\n\nfunction applyListeners(el, vm, listeners, doNotWrap) {\n\tfor (var key in listeners) {\n\t\tvar fn = listeners[key];\n\t\tif (key === 'create') {\n\t\t\tfn.call(el, vm);\n\t\t} else {\n\t\t\tel.addEventListener(key, doNotWrap ? fn : createListener(vm, fn));\n\t\t}\n\t}\n}\n\nfunction extractSlots(children) {\n\tif (children && children.length) {\n\t\tvar namedSlots = {}, nestedCnt = 0, hasContent = false;\n\t\tfor (var i=0,l=children.length; i<l; i++) {\n\t\t\tvar child = children[i];\n\t\t\tvar nodeType = child.nodeType;\n\t\t\tswitch (nodeType) {\n\t\t\t\tcase 1:\n\t\t\t\t\tif (child.nodeName === 'NESTED') { // select only 'nested' elements\n\t\t\t\t\t\tvar slot = child.getAttribute('name') || 'default';\n\t\t\t\t\t\tvar slotChildren = [];\n\t\t\t\t\t\tvar node = child.firstChild;\n\t\t\t\t\t\twhile (node) {\n\t\t\t\t\t\t\tslotChildren.push(node);\n\t\t\t\t\t\t\tnode = node.nextSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnamedSlots[slot] = slotChildren;\n\t\t\t\t\t\tnestedCnt++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\thasContent = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tif (child.nodeValue.trim()) { hasContent = true; }\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (nestedCnt) {\n\t\t\treturn namedSlots;\n\t\t} else if (hasContent) { // default slot\n\t\t\tnamedSlots.default = children;\n\t\t\treturn namedSlots;\n\t\t}\n\t}\n\treturn null;\n}\n\n// ==============================================\n\n\nvar RenderingProto = {\n\tx: function(expr) { // expression {{ ... }}\n\t\tvar text = expr(this.vm);\n\t\tvar el = document.createTextNode(text);\n\t\tthis.up(SetText(el, this.vm, expr));\n\t\treturn el;\n\t},\n\tt: function(value) { // text\n\t\treturn document.createTextNode(value);\n\t},\n\tg: function(isFn, xattrs, children) { // dynamic tag using 'is'\n\t\tvar tag = isFn(this.vm);\n\t\tvar XTag = getVMOrTag(tag);\n\t\treturn XTag ? this.v(XTag, xattrs, children) : this.h(tag, xattrs, children);\n\t},\n\th: function(tag, xattrs, children) { // dom node\n\t\tvar el = document.createElement(tag);\n\t\tif (xattrs) {\n\t\t\tvar vm = this.vm;\n\t\t\tfor (var key in xattrs) {\n\t\t\t\tvar up = null;\n\t\t\t\tvar val = xattrs[key];\n\t\t\t\tif (key.charCodeAt(0) === 36) { // $ - extended attribute\n\t\t\t\t\tif (key === '$on') {\n\t\t\t\t\t\tapplyListeners(el, vm, val);\n\t\t\t\t\t} else if (key === '$class') {\n\t\t\t\t\t\tup = SetClass(el, vm, val);\n\t\t\t\t\t} else if (key === '$style') {\n\t\t\t\t\t\tup = SetStyle(el, vm, val);\n\t\t\t\t\t} else if (key === '$show') {\n\t\t\t\t\t\tup = SetDisplay(el, vm, val);\n\t\t\t\t\t} else if (key === '$toggle') {\n\t\t\t\t\t\tup = SetToggle(el, vm, val);\n\t\t\t\t\t} else if (key === '$html') {\n\t\t\t\t\t\tup = SetInnerHTML(el, vm, val);\n\t\t\t\t\t} else if (key === '$attrs') {\n\t\t\t\t\t\tup = SetDOMAttrs(el, vm, val);\n\t\t\t\t\t} else if (key === '$listeners') {\n\t\t\t\t\t\t//TODO filter like for $attrs\n\t\t\t\t\t\t//TODO value must be a function ... and not use directly vm.$listeners\n\t\t\t\t\t\tapplyListeners(el, vm, vm.$listeners, true); // do not wrap listeners fns (already wrapped by the parent context)\n\t\t\t\t\t\t//TODO\n\t\t\t\t\t} else if (key === '$channel') {\n\t\t\t\t\t\tERR(28, tag);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tERR(26, key);\n\t\t\t\t\t}\n\t\t\t\t} else if (typeof val === 'function') { // a dynamic binding\n\t\t\t\t\tup = SetAttr(el, vm, key, val);\n\t\t\t\t} else {\n\t\t\t\t\tel.setAttribute(key, val);\n\t\t\t\t}\n\t\t\t\tif (up) {\n\t\t\t\t\tthis.up(up)(); // push then execute\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (children) { appendChildren(el, children); }\n\t\treturn el;\n\t},\n\t// element with static children (innerHTML is set from the subtree)\n\thh:function(tag, xattrs, content, type) {\n\t\tvar el = this.h(tag, xattrs);\n\t\tif (type) { // convert can be a function to convert the content before injecting in the dom\n\t\t\tvar converter = Context.Qute.converters[type];\n\t\t\tif (!converter) {\n\t\t\t\tERR(27, type);\n\t\t\t}\n\t\t\tcontent = converter(content, this);\n\t\t}\n\t\tel.innerHTML = content;\n\t\treturn el;\n\t},\n\tr: function(tag, xattrs, children) {\n\t\tvar XTag = getVMOrTag(tag);\n\t\tif (!XTag) { ERR(23, tag); }\n\t\treturn this._v(XTag, xattrs, extractSlots(children));\n\t},\n\tv: function(XTag, xattrs, children) { // xtag is specified as a func reference. TODO No more used\n\t\treturn this._v(XTag, xattrs, extractSlots(children));\n\t},\n\t// vm component\n\t_v: function(XTag, xattrs, slots) { // a vm component (viewmodel)\n\t\tif (isVM(XTag)) {\n\t\t\tvar vm = new XTag(this.vm.$ctx);\n\t\t\treturn vm.$create(this, xattrs, slots);\n\t\t} else if (XTag.$compiled) { // a compiled template\n\t\t\tvar oldVm = this.vm;\n\t\t\tthis.vm = this.functx(this.vm, xattrs, slots);\n\t\t\tvar el = XTag(this, xattrs, slots); // pass xattrs and slots too?\n\t\t\tthis.vm.$el = el;\n\t\t\t// apply root bindings if any (x-class, x-style or x-show)\n\t\t\tif (this.vm.$bindings) {\n\t\t\t\tvar bindings = this.vm.$bindings;\n\t\t\t\tfor (var i=0,l=bindings.length; i<l; i+=2) {\n\t\t\t\t\tvar up = bindings[i](el, oldVm, bindings[i+1]);\n\t\t\t\t\tthis.up(up)();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.vm.$listeners) { applyListeners(el, this.vm, this.vm.$listeners, true); }\n\t\t\tthis.vm = oldVm;\n\t\t\treturn el;\n\t\t} else { // a hand written function\n\t\t\treturn XTag(this, xattrs, slots);\n\t\t}\n\t},\n\ts: function(slotName, defaultChildren) {\n\t\tvar vm = this.vm;\n\t\tvar slots = vm.$slots;\n\t\tvar children = slots && slots[slotName || 'default'] || defaultChildren;\n\t\tif (children) {\n\t\t\tvar frag = document.createDocumentFragment();\n\t\t\tappendChildren(frag, children);\n\t\t\treturn frag;\n\t\t}\n\t\treturn document.createComment('[slot/]'); // placeholder\n\t},\n\tw: function(isExpr, changeCb, noCache, xattrs, childrenFn) { // dynamic view\n\t\tvar marker = document.createComment('[view/]');\n\t\tvar frag = document.createDocumentFragment();\n\t\tfrag.appendChild(marker);\n\t\tvar viewFrag = ViewRenderingContext(this.vm, marker, isExpr, changeCb, noCache, xattrs, childrenFn);\n\t\tmarker.__qute__ = viewFrag;\n\t\tviewFrag(null, true);\n\t\tthis.up(viewFrag);\n\t\treturn frag;\n\t},\n\ti: function(expr, changeCb, _if, _else) { // if / else\n\t\tvar start = document.createComment('[if]');\n\t\tvar end = document.createComment('[/if]');\n\t\tvar frag = document.createDocumentFragment();\n\t\tfrag.appendChild(start);\n\t\tfrag.appendChild(end);\n\t\tvar ieFrag = IfRenderingContext(this.vm, start, end, expr, changeCb, _if, _else);\n\t\tstart.__qute__ = ieFrag;\n\t\tieFrag(null, true);\n\t\tthis.up(ieFrag);\n\t\treturn frag;\n\t},\n\t// dynamic lists - which is tracking changes and update itself\n\tl: function(listFn, iterationFn) {\n\t\tvar list = listFn(this.vm);\n\t\t//if (!list instanceof List)) ERR(24);\n\t\tif (!list.$createListFragment) { ERR(24); }\n\t\treturn list.$createListFragment(this, iterationFn);\n\t},\n\t// static array variant of lists - this cannot be updated it is rendered once at creation\n\ta: function(listFn, iterationFn) {\n\t\tvar start = document.createComment('[for]');\n\t\tvar end = document.createComment('[/for]');\n\t\tvar frag = document.createDocumentFragment();\n\t\tfrag.appendChild(start);\n\t\tfrag.appendChild(end);\n\t\tvar forFrag = ForRenderingContext(this.vm, start, end, listFn, iterationFn);\n\t\tstart.__qute__ = forFrag;\n\t\tforFrag(null);\n\t\tthis.up(forFrag);\n\t\treturn frag;\n\t},\n\tup: function(fn) { // register a live update function\n\t\tthis.ups.push(fn);\n//\t\tthis.ups[this.ups.length-1].push(fn);\n\t\treturn fn;\n\t},\n\t//======\n\t// eval the value of an xattr given the key - if a fucntion invoke the function within the current context otherwise return the value as is\n\teval: function(xattr) {\n\t\treturn typeof xattr === 'function' ? xattr(this.vm) : xattr;\n\t},\n\n\t// connect all nested  VMs\n\t$connect: function() {\n\t\tif (!this.isc) {\n\t\t\tvar vms = this.vms;\n\t\t\tfor (var i=0,l=vms.length; i<l; i++) { vms[i].$connect(); }\n\t\t\tthis.isc = true;\n\t\t}\n\t\treturn this;\n\t},\n\t// disconnect all nested VMs\n\t$disconnect: function() {\n\t\tif (this.isc) {\n\t\t\tvar vms = this.vms;\n\t\t\tfor (var i=0,l=vms.length; i<l; i++) { vms[i].$disconnect(); }\n\t\t\tthis.isc = false;\n\t\t}\n\t\treturn this;\n\t},\n\t$push: function(r) { // push a sub-renderings\n\t\tthis.vms.push(r);\n\t\tif (this.isc) { r.$connect(); }\n\t},\n\t// refresh the DOM - call all nested update functions\n\t$update: function() {\n\t\tvar model = this.vm, ups = this.ups;\n\t\tfor (var i=0,l=ups.length;i<l;i++) { ups[i](model); }\n\t\treturn this;\n\t},\n\tfunctx: function(vm, xattrs, slots) { // functional context\n\t\tvar $attrs = {};\n\t\tvar ctx = {\n\t\t\t$parent: vm,\n\t\t\t$attrs: $attrs,\n\t\t\t$listeners: null,\n\t\t\t$slots: slots,\n\t\t\t$el: null,\n\t\t\t$bindings: null,\n\t\t\temit: Emitter.emit,\n\t\t\temitAsync: Emitter.emitAsync\n\t\t};\n\t\tvar bindings = null;\n\n\t\tif (xattrs) {\n\t\t\tfor (var key in xattrs) { // class, style and show, $attrs, $listeners are ignored\n\t\t\t\tvar val = xattrs[key];\n\t\t\t\tif (key.charCodeAt(0) !== 36 || key === '$html') { // $ - extended attribute -> ignore all extended attrs but $html\n\t\t\t\t\tif (typeof val === 'function') {\n\t\t\t\t\t\tthis.up(SetFuncAttr($attrs, vm, key, val))();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$attrs[key] = val;\n\t\t\t\t\t}\n\t\t\t\t\t//setFnContextAttr($attrs, vm, key, val);\n\t\t\t\t} else if (key === '$attrs') {\n\t\t\t\t\tif (vm.$attrs) {\n\t\t\t\t\t\t// inject attributes in functional tags\n\t\t\t\t\t\t// we need to create an update function to reinject attrs when model changes\n\t\t\t\t\t\t// otherwise we loose the reactivity on func tags 'x-attrs' attribute\n\t\t\t\t\t\tthis.up(SetFuncAttrs($attrs, vm, val))();\n\t\t\t\t\t}\n\t\t\t\t} else if (key === '$on') {\n\t\t\t\t\tctx.$listeners = createListeners(vm, val);\n\t\t\t\t} else if (key === '$class') {\n\t\t\t\t\tif (!bindings) { bindings = []; }\n\t\t\t\t\tbindings.push(SetClass, val);\n\t\t\t\t} else if (key === '$style') {\n\t\t\t\t\tif (!bindings) { bindings = []; }\n\t\t\t\t\tbindings.push(SetStyle, val);\n\t\t\t\t} else if (key === '$show') {\n\t\t\t\t\tif (!bindings) { bindings = []; }\n\t\t\t\t\tbindings.push(SetDisplay, val);\n\t\t\t\t} else if (key === '$toggle') {\n\t\t\t\t\tif (!bindings) { bindings = []; }\n\t\t\t\t\tbindings.push(SetToggle, val);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tctx.$bindings = bindings;\n\t\treturn ctx;\n\t}\n\n};\n\nfunction Rendering(vm) {\n\tthis.vm = vm; // defaults to current vm -> changed by functional views\n\tthis.ups = [];\n\t// vms are usually ViewModels but can be any object providing $connect and $disconnect methods\n\t// if you enrich the vms api you mustr check list.js since it register a ListFragment instance as a vm\n\tthis.vms = [];\n\tthis.isc = false; // is connected?\n}\nRendering.prototype = RenderingProto;\n\nfunction ListFragment(rendering, listFn) {\n\tthis.start = document.createComment('[list]');\n\tthis.end = document.createComment('[/list]');\n\tthis.r = rendering;\n\tthis.listFn = listFn;\n\tthis.length = 0;\n\n\tthis.updateChildren = function(model) {\n\t\tvar first = this.start.nextSibling;\n\t\tif (!first || first === this.end || !first.$up) { return; }\n\t\tvar n = first, end = this.end;\n\t\twhile (n && n !== end) {\n\t\t\tif (n.$up) {\n\t\t\t\tvar ups = n.$up;\n\t\t\t\tfor (var i=0,l=ups.length;i<l;i++) {\n\t\t\t\t\tups[i](model);\n\t\t\t\t}\n\t\t\t}\n\t\t\tn = n.nextSibling;\n\t\t}\n\t};\n\n\tthis.clear = function() {\n\t\tvar n = this.start;\n\t\tvar end = this.end;\n\t\tvar parent = n.parentNode;\n\t\twhile (n.nextSibling && n.nextSibling !== end) {\n\t\t\tparent.removeChild(n.nextSibling);\n\t\t}\n\t\tif (!n.nextSibling) { ERR(10); }\n\t\tthis.length = 0;\n\t};\n\n\tthis.get = function(index) {\n\t\tif (index < 0 || index > this.length) {\n\t\t\treturn null;\n\t\t}\n\t\tvar l = this.length, n = null;\n\t\tif (index < l/2) { // from start\n\t\t\tn = this.start.nextSibling;\n\t\t\twhile (index-- > 0) { n = n.nextSibling; }\n\t\t} else { // from end\n\t\t\tindex = l - index - 1;\n\t\t\tn = this.end.previousSibling;\n\t\t\twhile (index-- > 0) { n = n.previousSibling; }\n\t\t}\n\t\treturn n;\n\t};\n\n\tthis.getInsertion = function(index) {\n\t\tif (index < 0 || index > this.length) { ERR(11, index, length); }\n\t\tif (index === 0) {\n\t\t\treturn this.start.nextSibling;\n\t\t}\n\t\tif (index === this.length) {\n\t\t\treturn this.end;\n\t\t}\n\t\treturn this.get(index);\n\t};\n\n\tthis.createItem = function(r, item, index, hasNext) {\n\t\treturn listFn(r, item, index, hasNext);\n\t};\n\n\tthis.insert = function(data, from, count) {\n\t\tif (!from) { from = 0; } // if undefined null or 0\n\t\tif (!count) { count = data.length - from; } // if undefined null or 0\n\t\tif (count < 1) { return; }\n\t\tvar l = from+count;\n\t\tvar listFn = this.listFn;\n\t\tvar r = this.r;\n\t\tvar node = this.getInsertion(from);\n\t\tif (!node) { ERR(12, index, this.length); }\n\t\t//TODO redraw if list fragment is broken insted of throwing an error?\n\t\tvar childR, vm = r.vm, parent = node.parentNode;\n\t\tvar ll = l-1;\n\t\tfor (var i=from; i<ll; i++) {\n\t\t\t// we need to wrapp each child in a rendering ctx to be able to disconnect when items are removed\n\t\t\tchildR = new Rendering(vm);\n\t\t\tvar child = this.createItem(childR, data[i], i, true);\n\t\t\tif (child) {\n\t\t\t\tparent.insertBefore(child, node);\n\t\t\t\tr.$push(childR);\n\t\t\t\tchild.__qute_ctx__ = childR;\n\t\t\t}\n\t\t}\n\t\tchildR = new Rendering(vm);\n\t\tvar child = this.createItem(childR, data[ll], ll, l<data.length);\n\t\tif (child) {\n\t\t\tparent.insertBefore(child, node);\n\t\t\tr.$push(childR);\n\t\t\tchild.__qute_ctx__ = childR;\n\t\t}\n\t\tthis.length = data.length;\n\t};\n\n\tthis.remove = function(from, count) {\n\t\tif (from + count > this.length) {\n\t\t\t// TODO enable only if debug mode\n\t\t\t//throw new Error('Removed range exceed the list length: '+from+'#'+count+'. Length is '+this.length);\n\t\t\treturn;\n\t\t}\n\t\tvar node = this.get(from);\n\t\tif (!node) { ERR(13, from, this.length); }\n\t\tvar i=0, parent = this.start.parentNode;\n\t\tnode = node.previousSibling; // cannot be null\n\t\twhile (i++<count) {\n\t\t\tvar child = node.nextSibling;\n\t\t\tchild.__qute_ctx__ && child.__qute_ctx__.$disconnect();\n\t\t\tparent.removeChild(child);\n\t\t}\n\t\tthis.length -= count;\n\t};\n\n\tthis.move = function(from, to) {\n\t\t// TODO this can be optimized (we can search for the 2 nodes in the same time: get2(i1, i2))\n\t\tvar node = this.get(from);\n\t\tif (!node) { ERR(14, from, this.length); }\n\t\tvar dstNode = this.get(to);\n\t\tif (!dstNode) { ERR(15, to, this.length); }\n\t\tdstNode = dstNode.nextSibling;\n\t\tif (dstNode) {\n\t\t\tdstNode.parentNode.insertBefore(node, dstNode);\n\t\t} else {\n\t\t\tdstNode.parentNode.append(node);\n\t\t}\n\t};\n}\n\n\n\nvar AP = Array.prototype;\nvar ListProto = {\n\t$createListFragment: function(rendering, listFn) {\n\t\tvar listRendering = new Rendering(rendering.vm);\n\t\tif (!this.lfs) { this.lfs = []; }\n\t\tvar lf = new ListFragment(listRendering, listFn);\n\t\tvar frag = document.createDocumentFragment();\n\t\tfrag.appendChild(lf.start);\n\t\tfrag.appendChild(lf.end);\n\t\tlf.insert(this.$data); // initialize\n\t\trendering.up(lf.updateChildren.bind(lf)); // register children updates\n\t\tthis.lfs.push(lf);\n\t\trendering.$push(listRendering);\n\t\treturn frag;\n\t},\n\t/*\n\t$destroy: function() { //TODO not used\n\t\tthis.lfs = null;\n\t},\n\t*/\n\t$updateNow: function() {\n\t\tif (this.lfs) {\n\t\t\tvar ops = this.ops;\n\t\t\tvar data = this.$data;\n\t\t\tvar lfs = this.lfs;\n\t\t\tvar l = lfs.length;\n\t\t\twhile (ops.length) {\n\t\t\t\tvar op = ops.shift();\n\t\t\t\tfor (var i=0,l=lfs.length; i<l; i++) {\n\t\t\t\t\top(lfs[i], data);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t$update: function(op) {\n\t\tif (this.lfs) {\n\t\t\tif (this.ops.push(op) === 1) { // if queue is empty start an update task\n\t\t\t\tvar self = this;\n\t\t\t\tUpdateQueue.push(function() {\n\t\t\t\t\tself.$updateNow();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\t$redraw: function() {\n\t\tthis.$update(function(lf, data) {\n\t\t\tlf.clear();\n\t\t\tlf.insert(data);\n\t\t});\n\t},\n\t$insert: function(from, count) {\n\t\tthis.$update(function(lf, data) {\n\t\t\tlf.insert(data, from, count);\n\t\t});\n\t},\n\t$remove: function(from, count) {\n\t\tthis.$update(function(lf, data) {\n\t\t\tlf.remove(from, count);\n\t\t});\n\t},\n\t$move: function(from, to) {\n\t\tthis.$update(function(lf, data) {\n\t\t\tlf.move(from, to);\n\t\t});\n\t},\n\n\ttoJSON: function() {\n\t\treturn this.$data;\n\t},\n\tdata: function() {\n\t\treturn this.$data;\n\t},\n\tnewList: function() {\n\t\treturn new List(this.$data);\n\t},\n\n\tclear: function() {\n\t\tthis.replace([]);\n\t},\n\treplace: function (ar) {\n\t\tthis.$data = ar;\n\t\tthis.$redraw();\n\t},\n\n\tmove: function(from, to) {\n\t\tthis.$data.splice(to, 0, this.$data.splice(from, 1)[0]);\n\t\tthis.$move(from, to);\n\t},\n\n\tremove: function(item) {\n\t\tvar i = this.$data.indexOf(item);\n\t\tif (i > -1) {\n\t\t\treturn this.splice(i, 1);\n\t\t}\n\t},\n\n\tpush: function() {\n\t\tvar from = this.$data.length;\n\t\tvar r = AP.push.apply(this.$data, arguments);\n\t\tthis.$insert(from, arguments.length);\n\t\treturn r;\n\t},\n\tunshift: function() {\n\t\tvar from = this.$data.length;\n\t\tvar r = AP.unshift.apply(this.$data, arguments);\n\t\tthis.$insert(0, arguments.length);\n\t\treturn r;\n\t},\n\tpop: function() {\n\t\tvar r = AP.pop.apply(this.$data, arguments);\n\t\tthis.$remove(this.$data.length, 1);\n\t\treturn r;\n\t},\n\tshift: function() {\n\t\tvar r = AP.shift.apply(this.$data, arguments);\n\t\tthis.$remove(0, 1);\n\t\treturn r;\n\t},\n\tsplice: function(start, deleteCount) {\n\t\tvar argsl = arguments.length;\n\t\tvar len = this.$data.length;\n\t\tvar r = AP.splice.apply(this.$data, arguments);\n\t\tif (argsl === 1) {\n\t\t\tthis.$remove(start, len-start);\n\t\t} else if (argsl === 2) {\n\t\t\tthis.$remove(start, deleteCount);\n\t\t} else { // some inserted items\n\t\t\tif (deleteCount) { this.$remove(start, deleteCount); }\n\t\t\tthis.$insert(start, argsl-2);\n\t\t}\n\t\treturn r;\n\t},\n\tsort: function(cmp) {\n\t\tthis.$data.sort(cmp);\n\t\tthis.$redraw();\n\t\treturn this.$data;\n\t},\n\treverse: function() {\n\t\tthis.$data.reverse();\n\t\tthis.$redraw();\n\t\treturn this.$data;\n\t},\n\tget: function(i) {\n\t\treturn this.$data[i];\n\t},\n\tslice: function() {\n\t\treturn AP.slice.apply(this.$data, arguments);\n\t},\n\tforEach: function(cb, thisArg) {\n\t\tthis.$data.forEach(cb, thisArg);\n\t},\n\tmap: function(cb, thisArg) {\n\t\treturn this.$data.map(cb, thisArg);\n\t},\n\tfilter: function(cb, thisArg) {\n\t\treturn this.$data.filter(cb, thisArg);\n\t},\n\tfind: function(cb, thisArg) {\n\t\treturn this.$data.find(cb, thisArg);\n\t},\n\tfindIndex: function(cb, thisArg) {\n\t\treturn this.$data.findIndex(cb, thisArg);\n\t},\n\treduce: function(cb, initialValue) {\n\t\treturn this.$data.reduce(cb, initialValue);\n\t},\n\treduceRight: function(cb, initialValue) {\n\t\treturn this.$data.reduceRight(cb, initialValue);\n\t},\n\tindexOf: function(elem, from) {\n\t\treturn this.$data.indexOf(elem, from || 0);\n\t},\n\tlastIndexOf: function(elem, from) {\n\t\treturn this.$data.lastIndexOf(elem, from || this.$data.length-1);\n\t},\n\t//TODO add some, every, ...\n};\nObject.defineProperty(ListProto, 'length', {get:function() {return this.$data.length}});\n\nfunction List(data) {\n\tthis.ops = []; // update operations queue\n\tthis.lfs = null; // the list fragment\n\tthis.$data = data || []; // the backed data\n}\nList.prototype = ListProto;\n\nfunction isEnumerable(key) {\n\treturn key.charCodeAt(0) !== 95; // keys starting with _ are not enumerable\n}\n\nfunction defProp(key) {\n\treturn {\n\t\tget: function() {\n\t\t\treturn this.$data[key];\n\t\t},\n\t\tset: function(value) {\n\t\t\tvar old = this.$data[key];\n\t\t\tif (old !== value) {\n\t\t\t\tthis.$data[key] = value;\n\t\t\t\tvar watcher = this.$el && this.$watch && this.$watch[key]; // if not connected whatchers are not enabled\n\t\t\t\t// avoid updating if watcher return false\n\t\t\t\tif (watcher && watcher.call(this, value, old) === false) { return; }\n\t\t\t\tthis.update(key);\n\t\t\t}\n\t\t},\n\t\tenumerable: isEnumerable(key) // keys starting with _ are not enumerable\n\t}\n}\n\nfunction listProp(key) {\n\treturn {\n\t\tget: function() {\n\t\t\treturn this.$data[key];\n\t\t},\n\t\tset: function(value) {\n\t\t\tvar old = this.$data[key];\n\t\t\tif (old !== value) {\n\t\t\t\tif (!value) { // remove list content\n\t\t\t\t\tthis.$data[key].clear();\n\t\t\t\t} else if (Array.isArray(value)) {\n\t\t\t\t\tthis.$data[key].replace(value);\n\t\t\t\t} else if (value instanceof List) {\n\t\t\t\t\t//TODO should we copy the data?\n\t\t\t\t\tif (old) { old.$disconnect(); }\n\t\t\t\t\tthis.$data[key] = value;\n\t\t\t\t} else {\n\t\t\t\t\tERR(31, value);\n\t\t\t\t}\n\t\t\t\tvar watcher = this.$watch && this.$watch[key];\n\t\t\t\t// avoid updating if watcher return false\n\t\t\t\tif (watcher && watcher.call(this, value, old) === false) { return; }\n\t\t\t\tthis.update(key);\n\t\t\t}\n\t\t},\n\t\tenumerable: isEnumerable(key) // keys starting with _ are not enumerable\n\t}\n}\n\nfunction ViewModel(ctx, attrs) {\n\tvar prop = {};\n\t// the attributes set on vm tag which are not declared as props\n\tprop.value = {};\n\tObject.defineProperty(this, '$attrs', prop);\n\t// the app context if any\n\tprop.value = ctx instanceof Context ? ctx : new Context(ctx);\n\tObject.defineProperty(this, '$ctx', prop);\n\t// the listeners registered on the vm tag\n\tprop.value = null;\n\tprop.writable = true;\n\t// the associated rendering context\n\tObject.defineProperty(this, '$r', prop);\n\t// listeners injected through tag attributes (e.g. @click)\n\tObject.defineProperty(this, '$listeners', prop);\n\t// the slots injected by the caller\n\tObject.defineProperty(this, '$slots', prop);\n\t// the view root element\n\tObject.defineProperty(this, '$el', prop);\n\t// chained cleanup functions if any was registered\n\tObject.defineProperty(this, '$clean', prop);\n\t// States: 0 - initial, 1 - connected, 2 - updating\n\tprop.value = 0;\n\tObject.defineProperty(this, '$st', prop); // state: 0 - default, 1 updating , 2 frozen\n\n\tvar data = this.init(ctx) || {};\n\tprop.value = data;\n\tObject.defineProperty(this, '$data', prop);\n\tif (data) {\n\t\tfor (var key in data) {\n\t\t\tObject.defineProperty(this, key, data[key] instanceof List ? listProp(key) : defProp(key));\n\t\t}\n\t}\n\n\tif (!this.render) { ERR(32); }\n\n\t// initialize data model from attributes if any - this will not trigger an update\n\tif (attrs) {\n\t\tvar $data = this.$data;\n\t\tvar $attrs = this.$attrs;\n\t\tObject.keys(attrs).forEach(function(key) {\n\t\t\tvar value = attrs[key];\n\t\t\tif (key in $data) { // a declared property\n\t\t\t\t$data[key] = value;\n\t\t\t} else {\n\t\t\t\tvar camelKey = kebabToCamel(key);\n\t\t\t\tif (camelKey !== key && camelKey in $data) {\n\t\t\t\t\t$data[camelKey] = value;\n\t\t\t\t} else if ($attrs[key] !== value) {\n\t\t\t\t\t// attributes are not camelized\n\t\t\t\t\t$attrs[key] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nViewModel.prototype = {\n\t__VM__:true,\n\ttoString: function() {\n\t\treturn 'ViewModel <'+this.$tag+'/>';\n\t},\n\t// set an attribute value (can be either a free property (i.e $attrs[key]) or managed property (i.e. $data[key]))\n\t$set: function(key, value) {\n\t\tif (key in this.$data) { // a declared property\n\t\t\tthis[key] = value;\n\t\t} else {\n\t\t\tvar camelKey = kebabToCamel(key);\n\t\t\tif (camelKey !== key && camelKey in this.$data) {\n\t\t\t\tthis[camelKey] = value;\n\t\t\t} else if (this.$attrs[key] !== value) {\n\t\t\t\t// attributes are not camelized\n\t\t\t\tthis.$attrs[key] = value;\n\t\t\t\tthis.update();\n\t\t\t}\n\t\t}\n\t},\n\t// subscribe to the given channel name - for use on root VMs\n\tlisten: function(channelName) {\n\t\tif (!this.$channel) { ERR(39, this.$tag); }\n\t\t// add an init function\n\t\tthis.$init = chainFnAfter(function(thisObj) {\n\t\t\tthisObj.subscribe(channelName, thisObj.$channel);\n\t\t}, this.$init);\n\t\treturn this;\n\t},\n\t//TODO use setup in listen and $on\n\tsetup: function(setupFn) {\n\t\tthis.$init = chainFnAfter(setupFn, this.$init);\n\t\treturn this;\n\t},\n\tcleanup: function(fn) { // register a cleanup function when component is disconnected\n\t\tthis.$clean = chainFnAfter(fn, this.$clean);\n\t\treturn this;\n\t},\n\t$parent: function() {\n\t\tif (!this.$el) { ERR(35); }\n\t\treturn closestVM(this.$el.parentNode);\n\t},\n\t$root: function() {\n\t\tvar parent = this.$parent();\n\t\treturn parent ? parent.$root() : this;\n\t},\n\t$connect: function() {\n\t\tif (this.$st & 1) { return; } // ignore\n\t\tthis.$st |= 1; // set connected flag\n\t\t// $init may be defined by the prototype to do automatic setup when connected\n\t\t// (e.g. automatic installed listeners defined though VM definitioan 'on' property)\n\t\tif (this.$init) {\n\t\t\tthis.$init(this);\n\t\t}\n\t\tif (this.$listeners) {\n\t\t\tvar listeners = this.$listeners;\n\t\t\tfor (var key in listeners) {\n\t\t\t\tthis.$on(key, listeners[key]);\n\t\t\t}\n\t\t}\n\t\t// connect children vms\n\t\tthis.$r.$connect();\n\t\t// call the connected callback\n\t\tthis.connected && this.connected();\n\t\treturn this;\n\t},\n\t$disconnect: function() {\n\t\tif (!(this.$st & 1)) { return; } // ignore\n\t\tthis.$st ^= 1; // clear connected flag\n\t\tif (this.$clean) {\n\t\t\tthis.$clean();\n\t\t\tthis.$clean = null;\n\t\t}\n\t\tthis.$r.$disconnect(); // disconnect children vms\n\t\tthis.disconnected && this.disconnected();\n\t},\n\t// initialize a vm from tag raw data\n\t$load: function(rendering, xattrs, slots) {\n\t\tvar bindings = null;\n\t\tvar parentVM = rendering.vm;\n\t\tthis.$slots = slots;\n\t\tif (xattrs) {\n\t\t\tfor (var key in xattrs) {\n\t\t\t\tvar val = xattrs[key];\n\t\t\t\tif (key.charCodeAt(0) === 36) { // $ - extended attribute\n\t\t\t\t\tif (key === '$on') {\n\t\t\t\t\t\t//TODO we should make a copy of val since it is modified by createListeners!!!\n\t\t\t\t\t\tthis.$listeners = createListeners(parentVM, val); // use parent vm when creating listeners\n\t\t\t\t\t} else if (key === '$attrs') { // we must not delete keys from xattrs since it can break when vm is loaded by a dynamic component\n\t\t\t\t\t\t//TODO DO WE NEED to add an update fn? x-attrs are static\n\t\t\t\t\t\trendering.up(SetVMAttrs(this, parentVM, val))();\n\t\t\t\t\t} else if (key === '$class') {\n\t\t\t\t\t\tif (!bindings) { bindings = []; }\n\t\t\t\t\t\tbindings.push(SetClass, val);\n\t\t\t\t\t} else if (key === '$style') {\n\t\t\t\t\t\tif (!bindings) { bindings = []; }\n\t\t\t\t\t\tbindings.push(SetStyle, val);\n\t\t\t\t\t} else if (key === '$show') {\n\t\t\t\t\t\tif (!bindings) { bindings = []; }\n\t\t\t\t\t\tbindings.push(SetDisplay, val);\n\t\t\t\t\t} else if (key === '$toggle') {\n\t\t\t\t\t\tif (!bindings) { bindings = []; }\n\t\t\t\t\t\tbindings.push(SetToggle, val);\n\t\t\t\t\t} else if (key === '$channel') {\n\t\t\t\t\t\tthis.listen(val);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tERR(26, key);\n\t\t\t\t\t}\n\t\t\t\t} else if (typeof val === 'function') { // a dynamic binding\n\t\t\t\t\trendering.up(SetProp(this, parentVM, key, val))();\n\t\t\t\t} else { // static binding\n\t\t\t\t\tthis.$set(key, val);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn bindings;\n\t},\n\t$create: function(parentRendering, xattrs, slots) {\n\t\t// load definition\n\t\tvar bindings = parentRendering && this.$load(parentRendering, xattrs, slots);\n\t\tvar rendering = new Rendering(this);\n\t\t// must never return null - for non rendering components like popups we return a comment\n\t\tvar el = this.render(rendering) || document.createComment('<'+this.$tag+'/>');\n\t\tthis.$r = rendering;\n\t\tel.__qute__ = this;\n\t\tthis.$el = el;\n\t\tif (bindings) { for (var i=0,l=bindings.length; i<l; i+=2) {\n\t\t\tvar binding = bindings[i];\n\t\t\tvar up = bindings[i](el, parentRendering.vm, bindings[i+1]);\n\t\t\tparentRendering.up(up)();\n\t\t} }\n\t\tthis.created && this.created(el);\n\t\t// this can trigger a connect if tree is already connected (for example when inserting a comp in a connected list)\n\t\tparentRendering && parentRendering.$push(this);\n\t\treturn el;\n\t},\n\n\t// manual mount (only roots must be moutned this way)\n\tmount: function(elOrId, insertBefore) {\n\t\tif (this.$el) { ERR(33); } //TODO should check if connected and if not root\n\t\tvar target;\n\t\tif (elOrId) {\n\t\t\ttarget = typeof elOrId === 'string' ? document.getElementById(elOrId) : elOrId;\n\t\t} else {\n\t\t\ttarget = document.body;\n\t\t}\n\t\tvar el = this.$create();\n\t\tif (insertBefore) {\n\t\t\ttarget.parentNode.insertBefore(el, target);\n\t\t} else {\n\t\t\ttarget.appendChild(el);\n\t\t}\n\t\tthis.$connect();\n\t\t// announce the tree was attached to the DOM\n\t\treturn this;\n\t},\n\t// only manually mounted vms can be unmounted\n\tunmount: function() {\n\t\t// a child vm?\n\t\t//if (this.$p) ERR();\n\t\tif (!this.$el) { ERR(34); } // TODO check if root and mounted\n\t\tthis.$disconnect();\n\t\tthis.$el.parentNode.removeChild(this.$el);\n\t},\n\t$update: function(key) {\n\t\tif (this.$el) { // only if connected\n\t\t\tthis.$r.$update();\n\t\t}\n\t},\n\tupdate: function(key) {\n\t\tif (this.$st === 1) { // only if connected and not already scheduled to update\n\t\t\tthis.$st |= 2; // set updating flag\n\t\t\tvar self = this;\n\t\t\tUpdateQueue.push(function() {\n\t\t\t\tself.$update(key);\n\t\t\t\tself.$st ^= 2; // remove updating flag\n\t\t\t});\n\t\t}\n\t},\n\t$on: function(type/*, selector, cb*/) {\n\t\tif (!this.$el) { ERR(34); }\n\t\t//if (!this.$clean) this.$clean = [];\n\t\tvar selector, cb;\n\t\tif (arguments.length === 3) {\n\t\t\tselector = arguments[1];\n\t\t\tcb = arguments[2];\n\t\t\tif (!cb) {\n\t\t\t\tcb = selector;\n\t\t\t\tselector = null;\n\t\t\t\tif (!cb) { throw new Error('on function requires a callback argument'); }\n\t\t\t}\n\t\t} else if (arguments.length === 2) {\n\t\t\tcb = arguments[1];\n\t\t} else {\n\t\t\tthrow new Error('on function takes 2 or 3 arguments: eventType[, seelctor], callback');\n\t\t}\n\t\tvar self = this;\n\t\tvar wrapper = function(e) {\n\t\t\tif (!selector || e.target.matches(selector)) {\n\t\t\t\tif (cb.call(self, e) === false) {\n\t\t\t\t\tstopEvent(e);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tthis.$el.addEventListener(type, wrapper);\n\t\tthis.cleanup(function() {\n\t\t\tself.$el.removeEventListener(type, wrapper);\n\t\t});\n\t\t//this.$clean.push(type, wrapper);\n\t},\n\temit: Emitter.emit,\n\temitAsync: Emitter.emitAsync,\n\t// -------- ctx event bus -------------\n\tpost: function(topic, msg, data) {\n\t\tthis.$ctx.post(topic, msg, data);\n\t},\n\tpostAsync: function(topic, msg, data) {\n\t\tthis.$ctx.postAsync(topic, msg, data);\n\t},\n\t// subscribe and register cleanup to remove subscription at disconnect\n\tsubscribe: function(name, listenerFn) {\n\t\tvar ctx = this.$ctx;\n\t\tctx.subscribe(name, listenerFn.bind(this));\n\t\tthis.cleanup(function() {\n\t\t\tctx.unsubscribe(name, listenerFn);\n\t\t});\n\t\treturn this;\n\t},\n\tsubscribeOnce: function(topic, event, listenerFn) {\n\t\tvar ctx = this.$ctx;\n\t\tvar onceSubscription = ctx.subscribeOnce(topic, event, listenerFn.bind(this));\n\t\tthis.cleanup(function() {\n\t\t\tctx.unsubscribe(topic, onceSubscription);\n\t\t});\n\t\treturn this;\n\t},\n\ttoHTML: function() {\n\t\treturn this.$el && this.$el.outerHTML;\n\t},\n\t// ---------------------------------------------\n\tinit: function() {} // do nothing\n};\n\n/**\n * We cannot use Object.assign since getter are lost. So we copy the prop def itself\n */\nfunction assignPropDefs(dst, src) {\n\tvar keys = Object.keys(src);\n    for(var i=0,l=keys.length; i<l; i++) {\n      var key = keys[i];\n      Object.defineProperty(dst, key, Object.getOwnPropertyDescriptor(src, key));\n    }\n    return dst;\n}\n\nfunction Qute(tag, def, BaseVm) {\n\tif (!tag) { ERR(5); }\n\n\tfunction ViewModelImpl(ctx, attrs) {\n\t\tViewModel.call(this, ctx, attrs);\n\t}\n\n\tvar VMType, VMProto;\n\tif (typeof def === 'function') {\n\t\tif (def.prototype instanceof ViewModel)\t{\n\t\t\t// VM is defined as a class\n\t\t\tVMType = def;\n\t\t\tVMProto = VMType.prototype;\n\t\t} else {\n\t\t\t// a rendering function - we simply register the rendering fucntion for the given tag\n\t\t\treturn registerTag(tag, def);\n\t\t}\n\t} else { // VM definition object\n\t\tif (!BaseVm) { BaseVm = ViewModel; }\n\t\tVMProto = Object.create(BaseVm.prototype, {\n\t\t\tconstructor: {value:ViewModelImpl},\n\t\t});\n\t\tif (def) { assignPropDefs(VMProto, def); } // this is preserving getters\n\t\tVMProto.$super = BaseVm.prototype; // to be able to override methods and call the super method if needed\n\t\tViewModelImpl.prototype = VMProto;\n\n\t\tVMType = ViewModelImpl;\n\t}\n\n\t// add the rendering method of the tag if no one was provided\n\tif (!VMProto.render) {\n\t\tVMProto.render = Qute.template(tag);\n\t\tif (!VMProto.render) {\n\t\t\tERR(36, tag);\n\t\t}\n\t}\n\t// add the tag meta property\n\tVMProto.$tag = tag;\n\n\tregisterVM(tag, VMType);\n\n\tVMType.watch = function(prop, fn) {\n\t\tif (!VMProto.$watch) { Object.defineProperty(VMProto, '$watch', {value:{}}); }\n\t\tVMProto.$watch[prop] = fn;\n\t\treturn VMType;\n\t};\n\tVMType.on = function(key, selector, cb) {\n\t\tVMProto.$init = chainFnAfter(function(thisObj) {\n\t\t\tthisObj.$on(key, selector, cb);\n\t\t}, VMProto.$init);\n\t\treturn VMType;\n\t};\n\tVMType.channel = function(listenFn) {\n\t\tVMProto.$channel = listenFn;\n\t\treturn this;\n\t};\n\n\treturn VMType;\n}\n\nQute.List = List;\nQute.ViewModel = ViewModel;\n\n// link a viewmodel to a template. Usefull for classes where defining prototype methods is not part of the class syntax\nQute.link = function(VMType, renderFn) {\n\tVMType.prototype.render = renderFn;\n};\n\n\nvar QUTE_STYLE=null;\nQute.css = function(css) {\n\tvar doc = window.document;\n\tif (!QUTE_STYLE) {\n\t\tvar style = doc.getElementById('--qute-inline-styles');\n\t\tif (!style) {\n\t\t\tstyle = doc.createElement('STYLE');\n\t\t\tstyle.id = '--qute-inline-styles';\n\t\t\tstyle.type = 'text/css';\n\t\t\tstyle.textContent = \"\\n\";\n\t\t\tdoc.head.insertBefore(style, doc.head.firstChild);\n\t\t}\n\t\tQUTE_STYLE = style;\n\t}\n\tQUTE_STYLE.textContent += css;\n};\n\nQute.converters = {};\nContext.Qute = Qute; // we need this to access globals defined in Qute like converters\nQute.Context = Context;\nQute.UpdateQueue = UpdateQueue;\nQute.Rendering = Rendering;\n// render a functional template given its tag name and a model\nQute.render = function(xtagName, model) {\n\treturn getTag(xtagName)(new Rendering(model));\n};\n\nQute.register = registerTag;\nQute.template = getTag;\nQute.snapshotRegistry = snapshotRegistry;\nQute.restoreRegistry = restoreRegistry;\nQute.vm = getVM;\nQute.vmOrTemplate = getVMOrTag;\n\nQute.runAfter = function(cb) { UpdateQueue.runAfter(cb); };\nQute.closest = closestVM;\nQute.ERR = ERR;\n\nexport default Qute;\n//# sourceMappingURL=index.esm.js.map\n","function splitList(text) {\n\tif (!text) { return undefined; }\n\ttext = text.trim();\n\tif (!text) { return undefined; }\n\tvar rx = text.indexOf(',') > -1 ? /\\s*,\\s*/ : /\\s+/;\n\treturn makeSymbols(text.split(rx));\n}\n\nfunction makeSymbols(keys) {\n\treturn keys.reduce(function(acc, value) {\n\t\tacc[value] = true;\n\t\treturn acc;\n\t}, {});\n}\n\nfunction ERR(msg) {\n\tthrow new Error(msg);\n}\n\n// A regex HTML PARSER extended to support special attr names (inspired from https://johnresig.com/blog/pure-javascript-html-parser/)\n\n\nvar STAG_RX = /^<([-A-Za-z0-9_:]+)((?:\\s+[-\\w@#:]+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|(?:\\{[^}]*\\})|[^>\\s]+))?)*)\\s*(\\/?)>/,\n    ETAG_RX = /^<\\/([-A-Za-z0-9_:]+)[^>]*>/,\n    ATTR_RX = /([-A-Za-z0-9_@#:]+)(?:\\s*=\\s*(?:(?:\"((?:\\\\.|[^\"])*)\")|(?:'((?:\\\\.|[^'])*)')|(?:\\{((?:\\\\.|[^}])*)\\})|([^>\\s]+)))?/g;\n\nvar voids = {else:true, case:true, area:true, base:true, br:true, col:true, embed:true, hr:true, img:true, input:true, link:true, meta:true, param:true, source:true, track:true, wbr:true};\n\nfunction parseHTML(html, handler) {\n    function handleStartTag(tagName, attrsDecl, isVoid) { // void elements are tags with no close tag\n        tagName = tagName.toLowerCase();\n        isVoid = isVoid || voids[tagName];\n        if (!isVoid) { stack.push(tagName); }\n        var attrs = [];\n        ATTR_RX.lastIndex = 0;\n        var m = ATTR_RX.exec(attrsDecl);\n        while (m) {\n            // preserve empty values like: \"\" or ''. If attribute with no value then the boolean true is used as the value\n            var v = m[2] != null ? m[2] : (m[3] != null ? m[3] : (m[4] != null ? m[4] : (m[5] != null ? m[5] : true)));\n            attrs.push({ name: m[1], value: v, expr: m[4] != null });\n            m = ATTR_RX.exec(attrsDecl);\n        }\n        handler.start(tagName, attrs, !!isVoid);\n    }\n\n    function handleEndTag(tagName) {\n        tagName = tagName.toLowerCase();\n        var top = stack.pop();\n        if (top !== tagName) { throw new Error('Unmatched close tag. Current Open tag is <'+top+'> but found </'+tagName+'>') }\n        handler.end(tagName);\n    }\n\n    var text = '', match = null, stack = [];\n    while (html) {\n        var i = html.indexOf('<');\n        if (i === -1) {\n            text += html;\n            html = null; // exit\n        } else if (i > 0) {\n            text += html.substring(0, i);\n            html = html.substring(i);\n        } else { // i === 0\n            var c = html.charAt(i+1);\n            if (c === '!' && html.substring(i+2, i+4) === '--') { // <!--\n                if (text && handler.text) { handler.text(text); text = ''; }\n                var k = html.indexOf('-->', i+3);\n                if (k === -1) {\n                    throw new Error('Parse error: comment not closed');\n                }\n                if (handler.comment) { handler.comment(html.substring(i+3, k)); }\n                html = html.substring(k+3);\n            } else if (c === '/' && (match = ETAG_RX.exec(html))) { // end tag\n                if (text && handler.text) { handler.text(text); text = ''; }\n                html = html.substring(i+match[0].length);\n                handleEndTag(match[1]);\n            } else if (match = STAG_RX.exec(html)) { // start tag\n                if (text && handler.text) { handler.text(text); text = ''; }\n                html = html.substring(i+match[0].length);\n                handleStartTag(match[1], match[2], match[3]);\n            } else { // not a html tag\n                // get the next <\n                var next = html.indexOf('<', i+1);\n                if (next === -1) {\n                    text += html;\n                    html = null;\n                } else {\n                    text += html.substring(i, next);\n                    html = html.substring(next);\n                }\n            }\n        }\n    }\n    if (text && handler.text) { handler.text(text); }\n    if (stack.length > 0) {\n        throw new Error(\"Unclosed tag: \"+stack[0]);\n    }\n}\n\n/**\n * Transform jsq files to js files\n * No map file is required since the transformation preserve original code lines\n */\n\n\nvar TAG_RX = /(?:^|\\n)\\s*<(?:(x-tag)|(x-style))(\\s+[^>]*)?>/;\nvar TAG_END_RX = /\\s*<\\/(?:(x-tag)|(x-style))\\s*>/;\nvar ATTR_RX$1 = /([-A-Za-z0-9_]+)(?:\\s*=\\s*(?:(?:\"((?:\\\\.|[^\"])*)\")|(?:'((?:\\\\.|[^'])*)')|([^>\\s]+)))?/g;\nvar CNT_LINES_RX = /\\n/g;\n\nfunction getTagName(match) {\n    if (match[1]) { return 'x-tag'; }\n    if (match[2]) { return 'x-style'; }\n    ERR(\"Bug?\");\n}\n\n\nfunction parseAttrs(attrsDecl) {\n    var attrs = {};\n    ATTR_RX$1.lastIndex = 0;\n    var m = ATTR_RX$1.exec(attrsDecl);\n    while (m) {\n        // preserve empty values like: \"\" or ''. If attribute with no value then the boolean true is used as the value\n        attrs[m[1]] = m[2] != null ? m[2] : (m[3] != null ? m[3] : (m[4] != null ? m[4] : true));\n        m = ATTR_RX$1.exec(attrsDecl);\n    }\n    return attrs;\n}\n\nfunction newLines(text) { // remove any characters but new lines from given text\n\tvar ar = text.match(CNT_LINES_RX);\n    return ar ? ar.join('') : '';\n}\n\nfunction parseXTags(source, handler) {\n    var m = TAG_RX.exec(source);\n    while (m) {\n    \tvar lfs = newLines(m[0]);\n        var partText = source.substring(0, m.index);\n        if (partText) {\n            handler.text(partText+lfs);\n        }\n        source = source.substring(m.index+m[0].length);\n        var stag = getTagName(m);\n        var attrs = m[3];\n        if (attrs) { attrs = attrs.trim(); }\n        m = TAG_END_RX.exec(source);\n        if (!m) { ERR((\"Invalid qute file: No closing </\" + stag + \"> found.\")); }\n\n        var etag = getTagName(m);\n        if (etag !== stag) { ERR((\"Invalid qute file: Found closing tag '\" + etag + \"'. Expecting '\" + stag + \"'\")); }\n\n        partText = source.substring(0, m.index);\n        handler.tag(stag, attrs ? parseAttrs(attrs) : null, partText);\n\n        source = source.substring(m.index+m[0].length);\n        m = TAG_RX.exec(source);\n    }\n    // scan for imports on the remaining text\n    if (source)  {\n        handler.text(source);\n    }\n}\n\n\n// ======================= transform JSQ to JS =====================\n\nfunction handleTemplate(compiler, attrs, text) {\n\tif (!attrs || !attrs.name) { ERR(\"x-tag attribute 'name' is required\"); }\n    var name = attrs.name;\n    //var fname = kebabToCamel(name);\n    var imports = attrs.import || null;\n\n    var compiledFn = compiler.compile(text, splitList(imports));\n    return 'Qute.register(\"'+name+'\", '+compiledFn+', true);\\n';\n}\n\nfunction handleStyle(compiler, attrs, text) {\n    return 'Qute.css('+JSON.stringify(text.trim())+');\\n';\n}\n\nfunction transpile(compiler, source, opts) {\n    // We do not validate source -> If the source is not including a import Qute from ... then\n    // a syntgax error will be trown by javascript (since Qute symbol will not be found)\n\n\tvar out = '';\n    parseXTags(source, {\n        tag: function(tag, attrs, text) {\n            if (text) {\n                if (tag === 'x-tag') {\n                    out += handleTemplate(compiler, attrs, text);\n                } else if (tag === 'x-style') {\n                    out += handleStyle(compiler, attrs, text);\n                } else {\n                \tERR((\"Unsupported tag: '\" + tag + \"'\"));\n                }\n                if (!(opts && opts.removeNewLines)) { out += newLines(text); }\n            }\n        },\n        text: function(text) {\n        \tif (text) { out += text; }\n        }\n    });\n\n    return out;\n}\n\n/*\n  cb is a callback which will be called when an xtag was parsed:\n  cb(xtagName, xtagFn, isCompiled)\n */\nfunction loadXTags(compiler, source, cb) {\n    parseXTags(source, {\n        tag: function(tag, attrs, text) {\n            if (tag !== 'x-tag') { ERR((\"Unsupported tag: '\" + tag + \"'\")); }\n            if (!attrs || !attrs.name) { ERR(\"x-tag attribute 'name' is required\"); }\n            var fn = compiler.compileFn(text, splitList(attrs.import));\n            cb(attrs.name, fn, !attrs.static);\n        },\n        text: function(){} // ignore\n    });\n}\n\n/*\nattrs: {key: value, $, @}\n\nh(tag, attrs[, bindings, events], children) - output dom node\nv(expr) - variable text\nt(text) - static text\nf(list, item, index, hasNext, node) - for\nx(expr, ifFragment, elseFragment) - if\nc(tag, attrs, children) - view\n*/\n\n\n\n/*\n1. Rewrite var names inside a literal object representation: we need to avoid rewriting words inside simple or double quoted strings or unquoted keys (which looks like vars)\n\nQSTR:\n'(?:\\\\.|[^'])*'\nDQSTR:\n\"(?:\\\\.|[^\"])*\"\nVAR:\n[a-zA-Z_\\$][0-9a-zA-Z_\\$]*\nKEY:\n[\\{,]\\s*[a-zA-Z_\\$][0-9a-zA-Z_\\$]*\\s*\\:\n\n((?:QSTR)|(?:DQSTR)|(?:KEY))|(VAR)\n=> p1: ignore (String or key), p2: var\n\n2. Rewrite var names in expressions (no literal obj reprentation)\nWe can do this using the same regex as above like this:\n((?:QSTR)|(?:DQSTR))|(VAR)\n=> p1: ignore (String), p2: var\n*/\nvar VAR_RX = /^[a-zA-Z_\\$][0-9a-zA-Z_\\$]*$/;\nvar EXPR_RX = /((?:'(?:\\\\.|[^'])*')|(?:\"(?:\\\\.|[^\"])*\"))|([a-zA-Z_\\$][0-9a-zA-Z_\\$\\.]*)/g;\nvar OBJ_RX = /((?:'(?:\\\\.|[^'])*')|(?:\"(?:\\\\.|[^\"])*\")|(?:[\\{,]\\s*[a-zA-Z_\\$][0-9a-zA-Z_\\$\\.]*\\s*\\:))|([a-zA-Z_\\$][0-9a-zA-Z_\\$\\.]*)/g;\n\nvar ARROW_FN_RX = /^(\\(?)\\s*((?:[a-zA-Z_$][a-zA-Z_$0-9]*)(?:\\s*,\\s*[a-zA-Z_$][a-zA-Z_$0-9]*)*)(\\)?)\\s*=>\\s*(.*)$/;\n// nested is a special tag we added for convenience in the regular html tags - it is used as a more meaningful replacement of template or div\nvar HTML_TAGS = makeSymbols(\"nested html head meta link title base body style nav header footer main aside article section h1 h2 h3 h4 h5 h6 div p pre blockquote hr ul ol li dl dt dd span a em strong b i u s del ins mark small sup sub dfn code var samp kbd q cite ruby rt rp br wbr bdo bdi table caption tr td th thead tfoot tbody colgroup col img figure figcaption map area video audio source track script noscript object param embed iframe canvas abbr address meter progress time form button input textarea select option optgroup label fieldset legend datalist menu output details summary command keygen acronym applet bgsound basefont big center dir font frame frameset noframes strike tt xmp template\".split(\" \"));\n\n\nfunction _s(val) {\n    return JSON.stringify(val);\n}\n\nfunction _key(match) {\n\tvar i = match.indexOf('.');\n\treturn i > 0 ? match.substring(0,i) : match;\n}\n// write expr (without literal objects) by rewriting vars\nfunction __x(expr, ctx) {\n    return expr.replace(EXPR_RX, function(match, p1, p2) {\n    \tif (!p2) { return match; }\n    \tif (p2 === 'this') { // replace by 'm'\n    \t\treturn 'm';\n    \t} else if (p2.startsWith('this.')) {\n    \t\treturn 'm'+p2.substring(4);\n    \t}\n    \treturn !ctx.symbols[_key(match)] ? 'm.'+p2 : match;\n    });\n}\nfunction _x(expr, ctx) {\n    return '(' + __x(expr, ctx) + ')';\n}\n// write literal object by rewriting vars\nfunction _o(expr, ctx) {\n    return '(' + expr.replace(OBJ_RX, function(match, p1, p2) {\n    \tif (!p2) { return match; }\n    \tif (p2 === 'this') { // replace by 'm'\n    \t\treturn 'm';\n    \t} else if (p2.startsWith('this.')) {\n    \t\treturn 'm'+p2.substring(4);\n    \t}\n    \treturn !ctx.symbols[_key(match)] ? 'm.'+p2 : match;\n    }) + ')';\n}\nfunction _xo(expr, ctx) {\n\tif (expr == null) { return 'null'; }\n\tvar c = expr.charAt(0);\n\treturn (c === '{' || c === '[' ? _o : _x)(expr, ctx);\n}\n// used to wrap a compiled expr in a lambda function\nfunction _v(expr) {\n\treturn 'function(m){return '+expr+'}';\n}\nfunction _r(expr) { // a sub-rendering context fn\n\treturn 'function($){return '+expr+'}';\n}\n\nfunction getArrowFn(expr, ctx) {\n\tvar m = ARROW_FN_RX.exec(expr);\n\tif (m) {\n\t\tvar open = m[1];\n\t\tvar args = m[2].trim();\n\t\tvar close = m[3];\n\t\tvar body = m[4].trim();\n\n\t\tif (!!open !== !!close) {\n\t\t\tERR('Invalid arrow function syntax: '+expr);\n\t\t}\n\t\tif (!body) {\n\t\t\tERR('Invalid arrow function syntax: '+expr);\n\t\t}\n\t\t// 123 = { and 125 = }\n\t\tvar bs = body.charCodeAt(0);\n\t\tvar be = body.charCodeAt(body.length-1);\n\t\tif (bs === 123) {\n\t\t\tif (be !== 125) {\n\t\t\t\tERR('Invalid arrow function syntax: '+expr);\n\t\t\t} // else body is in the form { ... }\n\t\t} else if (be === 125) {\n\t\t\tERR('Invalid arrow function syntax: '+expr);\n\t\t} else { // no { ... }\n\t\t\tbody = '{'+body+';}';\n\t\t}\n\t\t// push in ctx.symbols  the local vars\n\t\tvar symbols = ctx.symbols;\n\t\tvar localSymbols = Object.assign({},symbols);\n\t\targs.split(/\\s*,\\s*/).forEach(function (key) { localSymbols[key] = true; });\n\t\tctx.symbols = localSymbols;\n\t\tvar r = '(function('+args+')'+__x(body, ctx)+')($1,m)'; // call the inline fn with the m (this) and the $1 argument\n\t\tctx.symbols = symbols; // restore symbols\n\t\treturn r;\n\t\t// pop from ctx symbols the local vars\n\t}\n\treturn null;\n}\n// write a callback (e.g. they are used by events)\n// if the event is a var name => we generate a fn: function(e) { expr(e) }\n// otherwise we generate a function: function() { expr }\nfunction _cb(expr, ctx) {\n\tif (VAR_RX.test(expr)) {\n\t\t// event listeners will be called with args:\n\t\t// 1. for functions: VM.callback(event) - where this is the VM\n\t\t// 2. for vm methods: VM.callback(event) - where this is the VM\n\t\t// 3. for expressions: $1 - the event, this - the vm\n\t\t// the event cb function must always be called with the element as the 'this' object\n\t\tif (ctx.imports[expr]) { // an imported function\n\t\t\treturn \"function($1){return \"+expr+\".call(this, $1)}\";\n\t\t} else { // a vm method\n\t\t\treturn \"function($1){return this.\"+expr+\"($1)}\";\n\t\t}\n\t} else {\n\t\tvar arrowFn = getArrowFn(expr, ctx);\n\t\tif (arrowFn) {\n\t\t\t//return \"function(this,$1){\"+arrowFn+\"}\";\n\t\t\treturn \"function($1){var m=this;\"+arrowFn+\"}\";\n\t\t} else {\n\t\t\treturn \"function($1){var m=this;\"+_x(expr, ctx)+\"}\";\n\t\t}\n\t}\n}\n\nfunction _fn(name) {\n\t//TODO '$' must not be used as a for argument!!\n\tvar r = '$.'+name+'(';\n\tif (arguments.length>1) {\n\t\tr += Array.prototype.slice.call(arguments, 1).join(',');\n\t}\n\treturn r+')';\n}\nfunction _node(xattrs, ctx) {\n\treturn xattrs ? xattrs.compile(ctx) : 'null';\n}\nfunction _nodes(children, ctx) {\n\tif (!children || !children.length) { return 'null'; }\n\treturn '['+children.map(function(child) {\n\t\treturn child.compile(ctx);\n\t}).join(',')+']';\n}\n/*\nfunction _bindings(bindings, ctx) {\n\tvar out = [];\n\tfor (var key in bindings) {\n\t\tout.push(_s(key)+':'+_v(_xo(bindings[key], ctx)));\n\t}\n\treturn out.length ? '{'+out.join(',')+'}' : null;\n}\n*/\n/*\nfunction _bindings(bindings, ctx) {\n\tvar out = [];\n\tfor (var key in bindings) {\n\t\tout.push(_s(key)+':'+_xo(bindings[key], ctx));\n\t}\n\treturn out.length ? _v('{'+out.join(',')+'}') : null;\n}\n*/\nfunction _events(events, ctx) {\n\tvar out = [];\n\tfor (var key in events) {\n\t\tout.push(_s(key)+':'+_cb(events[key], ctx));\n\t}\n\treturn out.length ? '{'+out.join(',')+'}' : null;\n}\n/*\nfunction _attrs(attrs) {\n\tvar out = null;\n\tif (attrs) {\n\t\tout = [];\n\t\tfor (var key in attrs) {\n\t\t\tout.push(_s(key)+':'+_s(attrs[key]));\n\t\t}\n\t}\n\treturn out && out.length ? '{'+out.join(',')+'}' : 'null';\n}\n*/\n/*\nol impl which compile each binding as a function\nfunction _xattrs(bindings, events, ctx) {\n\tvar out = null;\n\tif (bindings) {\n\t\tout = [];\n\t\tfor (var key in bindings) {\n\t\t\t// TODO use v(..) only if not a literal to optimize literal assignment like boolean or number (do not enclose in a function)\n\t\t\tout.push(_s(key)+':'+_v(_xo(bindings[key], ctx)));\n\t\t}\n\t}\n\tif (events) {\n\t\tout || (out = []);\n\t\tvar v = _events(events, ctx);\n\t\tif (v) out.push('\"$on\":'+v);\n\t}\n\treturn out && out.length ? '{'+out.join(',')+'}' : 'null';\n}\n*/\nfunction _xattrs(attrs, bindings, xattrs, directives, events, ctx) {\n\tvar out = null;\n\tif (attrs) {\n\t\tout = [];\n\t\tfor (var key in attrs) {\n\t\t\tout.push(_s(key)+':'+_s(attrs[key]));\n\t\t}\n\t}\n\tif (bindings) {\n\t\tout || (out = []);\n\t\tfor (var key in bindings) {\n\t\t\tout.push(_s(key)+':'+_v(_xo(bindings[key], ctx)));\n\t\t}\n\t}\n\tif (xattrs) {\n\t\tout || (out = []);\n\t\tfor (var key in xattrs) {\n\t\t\tvar val;\n\t\t\tif (key === '$attrs' || key === '$listeners') {\n\t\t\t\tval = xattrs[key];\n\t\t\t} else {\n\t\t\t\tval = _v(_xo(xattrs[key], ctx));\n\t\t\t}\n\t\t\tout.push(_s(key)+':'+val);\n\t\t}\n\t}\n\tif (directives) {\n\t\tout || (out = []);\n\t\tfor (var key in directives) {\n\t\t\tout.push(_s(key)+':'+directives[key]); // directives are already encoded\n\t\t}\n\t}\n\tif (events) {\n\t\tout || (out = []);\n\t\tvar v = _events(events, ctx);\n\t\tif (v) { out.push('\"$on\":'+v); }\n\t}\n\treturn out && out.length ? '{'+out.join(',')+'}' : 'null';\n}\n\nfunction attrValue(attr) {\n\treturn attr.value === true ? attr.name : attr.value;\n}\n\nfunction RootNode() {\n\tthis.name = 'root';\n\tthis.children = [];\n\tthis.append = function(child) {\n        this.children.push(child);\n\t};\n\tthis.lastChild = function() {\n\t\treturn this.children[this.children.length-1];\n\t};\n\tthis.compile = function(ctx) {\n\t\tvar children = this.children;\n\t\tif (children.length !== 1) { ERR(\"the root node must have a single children element\"); }\n\t\treturn this.children[0].compile(ctx);\n\t};\n\t// trim the children (remove trailing and leading blank nodes)\n\tthis.trim = function() {\n\t\tvar children = this.children;\n\t\tif (children.length > 1) {\n\t\t\tvar child = children[0];\n\t\t\tif (child instanceof TextNode && child.isBlank) { children.shift(); }\n\t\t\tchild = children[children.length-1];\n\t\t\tif (child instanceof TextNode && child.isBlank) {\n\t\t\t\tchild.pop();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n}\n\nfunction DomNode(name, attrs) {\n\tthis.name = name;\n\tthis.attrs = null;\n\tthis.bindings = null;\n\tthis.xattrs = null; // directives like x-show\n\t// for future use (not yet used)\n\t// directives are custom attrs that can be  contirbuted by apps\n\t// They are treated like xattrs but are output as is (as they are encoded at read time)\n\tthis.directives = null;\n\tthis.events = null;\n\tthis.children = [];\n\n\tthis.attr = function(name, value) {\n\t\tif (!this.attrs) { this.attrs = {}; }\n\t\tthis.attrs[name] = value;\n\t};\n\tthis.bind = function(name, value) {\n\t\tvar bindings = this.bindings || (this.bindings = {});\n\t\tbindings[name] = value.trim();\n\t};\n\tthis.xattr = function(name, value) {\n\t\tif (!this.xattrs) { this.xattrs = {}; }\n\t\tthis.xattrs[name] = value.trim();\n\t};\n\tthis.directive = function(name, value) {\n\t\tif (!this.directives) { this.directives = {}; }\n\t\tthis.directives[name] = value;\n\t};\n\tthis.on = function(name, value) {\n\t\tvar events = this.events || (this.events = {});\n\t\tevents[name] = value.trim();\n\t};\n\n\tthis.append = function(node) {\n\t\tthis.children.push(node);\n\t};\n\n\tthis.compile = function(ctx) {\n\t\tif (this.name === 'tag') {\n\t\t\tvar attrs = this.attrs;\n\t\t\tif (!attrs || !attrs.is) { ERR(\"<tag> requires an 'is' attribute\"); }\n\t\t\tvar isAttr = attrs.is;\n\t\t\tdelete attrs.is;\n\t\t\treturn _fn('g', _v(_x(isAttr, ctx)), // g from tag\n\t\t\t\t//_attrs(this.attrs),\n\t\t\t\t_xattrs(this.attrs, this.bindings, this.xattrs, this.directives, this.events, ctx),\n\t\t\t\t_nodes(this.children, ctx));\n\t\t}\n\t\tif (this.name === 'view') {\n\t\t\tvar attrs = this.attrs;\n\t\t\tif (!attrs || !attrs.is) { ERR(\"<view> requires an 'is' attribute\"); }\n\n\t\t\tvar isExpr = _v(_x(attrs.is, ctx));\n\t\t\tdelete attrs.is;\n\t\t\tvar noCache = 'false';\n\t\t\tif ('x-nocache' in attrs) {\n\t\t\t\tdelete attrs['x-nocache'];\n\t\t\t\tnoCache = 'true';\n\t\t\t}\n\t\t\tvar onChange = 'null';\n\t\t\tif ('x-change' in attrs) {\n\t\t\t\tonChange = _cb(attrs['x-change'], ctx);\n\t\t\t\tdelete attrs['x-change'];\n\t\t\t}\n\n\t\t\treturn _fn('w', // w from view ?\n\t\t\t\tisExpr,\n\t\t\t\tonChange,\n\t\t\t\tnoCache,\n\t\t\t\t_xattrs(this.attrs, this.bindings, this.xattrs, this.directives, this.events, ctx), //xattrs\n\t\t\t\t_r(_nodes(this.children, ctx)) // childrenFn\n\t\t\t);\n\t\t}\n\t\tvar fname, tag;\n\t\t//if (ctx.isXTag(this.name))\n\t\tif (this.name in HTML_TAGS) { // a dom element\n\t\t\tfname = 'h'; // h from html\n\t\t\ttag = _s(this.name);\n\t\t} else { // a component\n\t\t\tvar tag = ctx.resolve(this.name);\n\t\t\tif (tag) { // resolved compile time\n\t\t\t\tfname = 'v'; // v from view model\n\t\t\t} else { // should resolve at runtime\n\t\t\t\tfname = 'r'; // r from runtime\n\t\t\t\ttag = _s(this.name);\n\t\t\t}\n\t\t}\n\t\tif (this.name==='pre') {\n\t\t\tctx = ctx.push();\n\t\t\tctx.pre = true;\n\t\t}\n\t\treturn _fn(fname, tag,\n\t\t\t//_attrs(this.attrs),\n\t\t\t_xattrs(this.attrs, this.bindings, this.xattrs, this.directives, this.events, ctx),\n\t\t\t_nodes(this.children, ctx));\n\t};\n\n\tthis.xcontent = function(type, attr) {\n\t\tif (attr.value === true) {\n\t\t\treturn new StaticNode(this, type);\n\t\t} else {\n\t\t\t//TODO: use type ...\n    \t\tthis.xattr('$html', attr.value);\n    \t}\n    \treturn this;\n\t};\n\n\tfunction parseXAttrs(val) {\n\t\tif (val === true) { return 'null'; }\n\t\tvar first = true;\n\t\tif (val.charCodeAt(0) === 33) { // a ! -> exclude rule\n\t\t\tval = val.substring(1);\n\t\t\tfirst = false;\n\t\t}\n\t\tvar ar;\n\t\tval = val.trim();\n\t\tif (val.indexOf(',') > -1) {\n\t\t\tar = val.split(/\\s*,\\s*/);\n\t\t} else {\n\t\t\tar = val.split(/\\s+/);\n\t\t}\n\t\tar.unshift(first); // insert the filter type (true for inclusion, false for exclusion) as the first item\n\t\treturn _s(ar);\n\t}\n\n\tthis.parseAttrs = function(attrs) {\n\t\tvar r = this;\n\t\tfor (var i=0,l=attrs.length; i<l; i++) {\n\t    \tvar attr = attrs[i];\n\t    \tvar name = attr.name;\n\t        var c = name[0];\n\t        if (c === ':') {\n\t        \tthis.bind(name.substring(1), attr.value);\n\t        } else if (c === '@') {\n\t        \tthis.on(name.substring(1), attr.value);\n\t        } else if ('x-for' === name) {\n\t        \tr = new ListNode(attr.value, this);\n\t        } else if ('x-attrs' === name) {\n\t        \tthis.xattr('$attrs', parseXAttrs(attr.value));\n\t        } else if ('x-listeners' === name) {\n\t        \tthis.xattr('$listeners', parseXAttrs(attr.value));\n\t        } else if ('x-channel' === name) {\n\t        \tthis.attr('$channel', attr.value); // use a regular attr since valkue is always a string literal\n\t\t\t} else if ('x-show' === name) {\n\t\t\t\tthis.xattr('$show', attr.value);\n\t\t\t} else if ('x-class' === name) {\n\t\t\t\tthis.xattr('$class', attr.value);\n\t\t\t} else if ('x-style' === name) {\n\t\t\t\tthis.xattr('$style', attr.value);\n\t\t\t} else if ('x-toggle' === name) {\n\t\t\t\tthis.xattr('$toggle', attr.value);\n\t\t\t} else if ('x-html' === name) {\n\t\t\t\tif (attr.value === true) {\n\t\t\t\t\tr = new StaticNode(this, null);\n\t\t\t\t} else {\n    \t\t\t\tthis.xattr('$html', attr.value);\n    \t\t\t}\n\t\t\t} else if ('x-markdown' === name) {\n\t\t\t\tr = new StaticNode(this, 'markdown');\n\t        } else if (name.startsWith('x-content-')) {\n\t        \tvar ctype = name.substring('x-content-'.length);\n\t        \tr = new StaticNode(this, ctype !== 'html' ? ctype : null);\n\t        } else if (attr.expr) {\n\t        \t// an expression: support { ... } as an alternative for :name\n\t    \t\tthis.bind(name, attr.value);\n\t    \t} else if (name.startsWith('x-bind:')) {\n\t    \t\tthis.bind(name.substring(7), attr.value);\n\t    \t} else if (name.startsWith('x-on:')) {\n\t    \t\tthis.on(name.substring(5), attr.value);\n\t        } else {\n\t        \tthis.attr(name, attrValue(attr));\n\t        }\n\t\t}\n\t\treturn r;\n\t};\n\n\treturn this.parseAttrs(attrs);\n}\n// a DomNode that has static children (set with innerHTML from the template content)\nfunction StaticNode(node, type) {\n\tthis.node = node;\n\tthis.compile = function(ctx) {\n\t\treturn _fn('hh', _s(this.node.name),\n\t\t\t//_attrs(this.node.attrs),\n\t\t\t_xattrs(this.node.attrs, this.node.bindings, this.node.xattrs, this.node.directives, this.node.events, ctx),\n\t\t\t_s(this.html.join('')),\n\t\t\t_s(type)\n\t\t);\n\t};\n\n\t// compile logic\n\tthis.tag = node.name;\n\tthis.stack = [];\n\tthis.html = [];\n\tthis.start = function(tagName, attrs, isVoid) {\n\t\tvar html = this.html;\n\t\thtml.push('<', tagName);\n\t\tfor (var i=0,l=attrs.length; i<l; i++) {\n\t\t\tvar attr = attrs[i];\n\t\t\thtml.push(' ', attr.name);\n\t\t\tif (attr.value !== true) {\n\t\t\t\thtml.push('=\"', attr.value, '\"');\n\t\t\t}\n\t\t}\n\t\thtml.push(isVoid?'/>':'>');\n\t\tif (!isVoid) { this.stack.push(tagName); }\n\t};\n\tthis.end = function(tagName) {\n\t\tvar tag = this.stack.pop();\n\t\tif (tag) { // subtree traversed\n\t\t\tif (tag !== tagName) { ERR((\"Closing tag '\" + tagName + \"' doesn't match the start tag '\" + tag + \"'\")); }\n\t\t\tthis.html.push('</', tagName, '>');\n\t\t} else {\n\t\t\treturn true; // finished\n\t\t}\n\t};\n\tthis.text = function(text) {\n\t\tthis.html.push(text);\n\t};\n}\n\nfunction TextNode(value) {\n\tthis.value = value;\n\tthis.isBlank = value.trim().length===0;\n\tthis.compile = function(ctx) {\n\t\tvar value = this.isBlank && !ctx.pre ? this.value.trim()+' ' : this.value;\n\t\treturn _fn('t', _s(value));\n\t};\n\tthis.append = function(text) {\n\t\tthis.value += text;\n\t\tif (this.isBlank) { this.isBlank = this.value.trim().length===0; }\n\t};\n}\n\nfunction ExprNode() {\n\tthis.parts = [];\n\tthis.text = function(text) {\n\t\tthis.parts.push(false, text);\n\t};\n\tthis.expr = function(expr) {\n\t\tthis.parts.push(true, expr);\n\t};\n\tthis.compile = function(ctx) {\n\t\tvar parts = this.parts;\n\t\tvar out = [];\n\t\tfor (var i=0,l=parts.length; i<l; i+=2) {\n\t\t\tif (parts[i]) { out.push(_x(parts[i+1], ctx)); }\n\t\t\telse { out.push(_s(parts[i+1])); }\n\t\t}\n\t\treturn _fn('x', _v(out.join('+')));\n\t};\n}\n\nvar FOR_RX = /^\\s*(.+)\\s+in\\s+(.+)\\s*$/;\nfunction parseForExpr(listNode, expr) {\n\tvar m = FOR_RX.exec(expr);\n\tif (!m) { ERR(\"Invalid for expression\"); }\n\tlistNode.list = m[2].trim();\n\tvar item = m[1].trim();\n\tif (item.indexOf(',') > -1) {\n\t\tvar args = item.split(/\\s*,\\s*/);\n\t\tlistNode.item = args[0];\n\t\tlistNode.index = args[1];\n\t\tif (args.length > 2) { listNode.hasNext = args[2]; }\n\t} else {\n\t\tlistNode.item = item;\n\t}\n}\nfunction ListNode(expr, node) {\n\tthis.node = node;\n\tthis.list = null;\n\tthis.item = null;\n\t//TODO can we just not include them in args list? instead of using _?\n\tthis.index = '_';\n\tthis.hasNext = '__';\n\n\t// parse expr\n\tparseForExpr(this, expr);\n\n\tthis.append = function(node) {\n\t\tthis.node.append(node);\n\t};\n\n\tthis.compile = function(ctx) {\n\t\t// we wrap children in a inline fucntion def so that item, index and has_next are resolved inside the children nodes\n\t\t// also, _x function must not rewrite item, index and has_next variable ...\n\t\t// 1. compile children and avoid rewriting iteration vars\n\t\tvar forCtx = ctx.push();\n\t\tvar forSymbols = forCtx.symbols;\n\t\tforSymbols[this.item] = true;\n\t\tforSymbols[this.index] = true;\n\t\tforSymbols[this.hasNext] = true;\n\t\tvar children = _node(this.node, forCtx);\n\t\t// 2. wrap children\n\t\tvar childrenFn = 'function($,'+this.item+','+this.index+','+this.hasNext+'){return '+children+'}';\n\t\treturn _fn('l', _v(_x(this.list, ctx)), childrenFn);\n\t};\n\n}\n\nfunction ForNode(tag, attrs) {\n\tthis.list = null;\n\tthis.item = null;\n\tthis.index = '_';\n\tthis.hasNext = '__';\n\n\tthis.children = [];\n\tthis.append = function(child) {\n        this.children.push(child);\n\t};\n\tthis.lastChild = function() {\n\t\treturn this.children[this.children.length-1];\n\t};\n\tthis.compile = function(ctx) {\n\t\t// we wrap children in a inline fucntion def so that item, index and has_next are resolved inside the children nodes\n\t\t// also, _x function must not rewrite item, index and has_next variable ...\n\t\t// 1. compile children and avoid rewriting iteration vars\n\t\tvar forCtx = ctx.push();\n\t\tvar forSymbols = forCtx.symbols;\n\t\tforSymbols[this.item] = true;\n\t\tforSymbols[this.index] = true;\n\t\tforSymbols[this.hasNext] = true;\n\t\tvar children = _nodes(this.children, forCtx);\n\t\t// 2. wrap children\n\t\tvar childrenFn = 'function('+this.item+','+this.index+','+this.hasNext+'){return '+children+'}';\n\t\treturn _fn('a', _v(_x(this.list, ctx)), childrenFn);\n\t};\n\n\tif (attrs.length !== 1) { ERR(\"For directive take exatcly one attribute\"); }\n\tparseForExpr(this, attrs[0].value);\n}\n\nfunction IfNode(tag, attrs) {\n\tthis.children = [];\n\tthis._else = null;\n\tthis.change = null; // onchange event handler if any\n\tthis.expr = null;\n\n\t// we don't check the attr name - any name may be used (not only 'value')\n\tvar valueAttr = attrs[0];\n\tif (attrs.length === 2) {\n\t\tvar changeAttr = attrs[1];\n\t\tif (valueAttr.name === 'x-change') {\n\t\t\tchangeAttr = valueAttr;\n\t\t\tvalueAttr = attrs[1];\n\t\t} else if (changeAttr.name !== 'x-change') {\n\t\t\tERR((\"Invalid if attribute '\" + (changeAttr.name) + \"'. You may want to use x-change?\"));\n\t\t}\n\t\tthis.change = changeAttr.value;\n\t} else if (attrs.length !== 1) {\n\t\tERR(\"if has only one required attribute: value='expr' and an optional one: x-change='onChangeHandler'\");\n\t}\n\tthis.expr = attrValue(valueAttr);\n\n\tthis.append = function(node) {\n\t\tif (node instanceof ElseNode) {\n\t\t\tthis._else = [];\n\t\t} else if (this._else) {\n\t\t\tthis._else.push(node);\n\t\t} else {\n\t\t\tthis.children.push(node);\n\t\t}\n\t};\n\n\tthis.compile = function(ctx) {\n\t\tvar change = this.change ? _cb(this.change, ctx) : 'null';\n\t\tif (this._else) {\n\t\t\treturn _fn('i', _v(_x(this.expr, ctx)), change, _r(_nodes(this.children, ctx)), _r(_nodes(this._else, ctx)));\n\t\t} else {\n\t\t\treturn _fn('i', _v(_x(this.expr, ctx)), change, _r(_nodes(this.children, ctx)));\n\t\t}\n\t};\n}\n\nfunction ElseNode() {\n}\n\n\n//TODO\nfunction SlotNode(tagName, attrs) {\n\tthis.name = tagName;\n\tthis.children = [];\n\tthis.append = function(child) {\n        this.children.push(child);\n\t};\n\t//TODO is this needed?\n\tthis.lastChild = function() {\n\t\treturn this.children[this.children.length-1];\n\t};\n\tthis.process = function(processor) {\n\t\treturn processor.processSlot(this);\n\t};\n\tthis.compile = function(ctx) {\n\t\t// we push the 'm' (current model) because the slot renderer (i.e. r.s)\n\t\t// needs the current model to fetch the slot value\n\t\treturn _fn('s', _s(this.slotName), _nodes(this.children, ctx));\n\t};\n\tif (attrs.length > 1) { ERR(\"slot node take zero or one 'name' parameter\"); }\n\tthis.slotName = attrs.length ? attrValue(attrs[0]) : null;\n}\n\n\nvar MUSTACHE_RX = /\\{\\{([^\\}]+)\\}\\}/g;\n//var BLANK_RX = /^\\s*$/;\n\nvar NODES = {\n\t'if':  IfNode,\n\t'else':  ElseNode,\n\t'for':  ForNode,\n\t'slot': SlotNode\n};\n\nvar SYMBOLS = {\n\t\"true\": true, \"false\": true, \"undefined\": true, \"null\":true, \"$1\": true,\n\t\"this\":true, \"JSON\": true, \"Object\":true, \"console\":true, \"window\": true, \"$\": true\n};\n\n\n\nfunction Compiler() {\n\tfunction Context(symbols, imports, resolve, pre) {\n\t\tthis.pre = pre; // if pre then do not compact spaces in TextNodes\n\t\tthis.resolve = resolve;\n\t\tthis.symbols = symbols;\n\t\tthis.imports = imports;\n\t\tthis.push = function() {\n\t\t\treturn new Context(Object.assign({}, this.symbols), this.imports, this.resolve, this.pre);\n\t\t};\n\t}\n\t// collector is used only when static html should be collected sue to an x-html attribute\n\t// See StaticNode\n\tthis.collector = null;\n\tthis.top = null;\n\tthis.stack = [];\n\tthis.lastText = null; // used to merge adjacent text nodes\n\n\tthis.resolve = function(tag) {\n\t\treturn null;// the default is to resolve at runtime\n\t};\n\n\tthis.pushText = function(text) {\n\t\tif (this.lastText) { this.lastText.append(text); }\n\t\telse {\n\t\t\tvar node = new TextNode(text);\n\t\t\tthis.push(node, true);\n\t\t\tthis.lastText = node;\n\t\t}\n\t};\n\n\tthis.push = function(node, isVoid) {\n\t\tthis.lastText = null;\n\t\tthis.top.append(node);\n\t\tif (!isVoid) {\n\t\t\tthis.stack.push(this.top);\n\t\t\tthis.top = node;\n\t\t}\n\t};\n\n\tthis.pop = function() {\n\t\tthis.lastText = null;\n        var top = this.top;\n        this.top = this.stack.pop();\n        return top;\n\t};\n\n\n\tthis.text = function(text) {\n\t\tif (this.collector) {\n\t\t\tthis.collector.text(text);\n\t\t\treturn;\n\t\t}\n\t    var i = text.indexOf('{{'), s = 0;\n\t    if (i > -1) {\n\t        MUSTACHE_RX.lastIndex = i;\n\t        var match = MUSTACHE_RX.exec(text);\n\t        if (match) {\n\t           \tvar node = new ExprNode();\n\t            do {\n\t                var index = match.index;\n\t                if (index > s) {\n\t                    node.text(text.substring(s, index));\n\t                }\n\t                node.expr(match[1]);\n\t                s = MUSTACHE_RX.lastIndex;\n\t                match = MUSTACHE_RX.exec(text);\n\t            } while (match);\n\t            if (s < text.length) {\n\t                node.text(text.substring(s));\n\t            }\n\t            this.push(node, true);\n\t            return;\n\t        }\n\t    }\n\t    this.pushText(text);\n\t};\n\n\tthis.start = function(tagName, attrs, isVoid) {\n\t\tif (this.collector) {\n\t\t\tthis.collector.start(tagName, attrs, isVoid);\n\t\t} else {\n\t\t\tvar NodeType = NODES[tagName];\n\t\t\tvar node;\n\t\t\tif (NodeType) {\n\t\t\t\tnode = new NodeType(tagName, attrs, isVoid);\n\t\t\t} else {\n\t\t\t\tnode = new DomNode(tagName, attrs, isVoid);\n\t\t\t\tif (node instanceof StaticNode) {\n\t\t\t\t\t// allow <div x-conent-{random} />\n\t\t\t\t\t//if (isVoid) ERR(\"Static node (x-html) must have some content\");\n\t\t\t\t\tthis.collector = node;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.push(node, isVoid);\n\t\t}\n\t};\n\n\tthis.end = function(tagName) {\n\t\tif (this.collector) {\n\t\t\tif (!this.collector.end(tagName)) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\t// subtree traversed - remove collector\n\t\t\tthis.collector = null;\n\t\t}\n\t\tthis.pop();\n\t};\n\n\tthis.parse = function(text) {\n\t\tthis.top = new RootNode();\n\t\tparseHTML(text.trim(), {\n\t\t\tstart: this.start.bind(this),\n\t\t\tend: this.end.bind(this),\n\t\t\ttext: this.text.bind(this)\n\t\t});\n\t\t// \"trim\" the root node (blank text mnodes mayt appear because of comments)\n\t\treturn this.top.trim();\n\t};\n\n    this.compile = function(text, imports, pre) { // r is the Renderer\n    \tvar ctx = new Context(Object.assign(imports || {}, SYMBOLS), imports || {}, this.resolve, pre);\n    \tvar r = this.parse(text).compile(ctx);\n    \t//console.log(\"COMPILED:\",r);\n        return 'function($){return '+r+';}';\n    };\n\n\tthis.compileFn = function(text, imports, pre) {\n\t\tvar ctx = new Context(Object.assign(imports || {}, SYMBOLS), imports || {}, this.resolve, pre);\n    \tvar r = this.parse(text).compile(ctx);\n    \t//console.log(\"COMPILED:\",r);\n\t\treturn new Function('$', 'return '+r+';');\n\t};\n\n\tthis.transpile = function(source, opts) {\n\t\treturn transpile(this, source, opts);\n\t};\n\n\tthis.loadXTags = function(source, cb) {\n\t\treturn loadXTags(this, source, cb);\n\t};\n\n}\n\nexport default Compiler;\n//# sourceMappingURL=index.esm.js.map\n","import window, { document } from '@qutejs/window';\nimport Qute from '@qutejs/runtime';\nimport Compiler from '@qutejs/compiler';\nimport { capitalizeFirst, kebabToCamel } from '@qutejs/commons';\n\nvar IMPORT_RX = /^\\s*import\\s+(\\S+)\\s+from\\s+(?:(\\\"[^\"]+\\\")|(\\'[^']+\\')|([^\"'][^;\\s]*));?$/mg;\nvar EXPORT_RX = /^\\s*export\\s+default\\s+/m;\n\n\nfunction Loader() {\n\tthis.createScript = function(code, name) {\n\t\tvar deps = {};\n\t\tcode = code.replace(IMPORT_RX, function(m, p1, p2, p3, p4) {\n\t\t\tvar path = p2 || p3 || p4;\n\n\t\t\tif (path) {\n\t\t\t\tif (path[0] === '.' && path[1] === '/') {\n\t\t\t\t\t//TODO resolve file path\n\t\t\t\t\tdeps[p1] = path;\n\t\t\t\t} else if (p1 !== 'Qute') {\n\t\t\t\t\tconsole.warning('Imports are ignored in dev version!');\n\t\t\t\t\tthrow new Error('Only relative paths are supported for import statements: '+m.trim());\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn m.replace('import ', '//import ');\n\t\t});\n\t\tvar hasExport = false;\n\t\tcode = code.replace(EXPORT_RX, function(m) {\n\t\t\thasExport = true;\n\t\t\treturn \"var __DEFAULT_EXPORT__ = \";\n\t\t});\n\t\tcode = new Compiler().transpile(code);\n\t\t// apply buble if needed\n\t\tif (window.buble && window.buble.transform) {\n\t\t\tcode = window.buble.transform(code).code;\n\t\t}\n\t\tif (hasExport) { code += '\\nreturn __DEFAULT_EXPORT__;\\n'; }\n\t\t// for now script deps are expected to be declared above the script - otherwise compiling will fail\n\t\tvar comp = (new Function(code))();\n\n\t\tvar script = new Script();\n\t\tscript.name = comp ? name || capitalizeFirst(kebabToCamel(comp.prototype.$tag)) : null;\n\t\tscript.code = code;\n\t\tscript.deps = deps;\n\t\tscript.comp = comp;\n\n\t\treturn script;\n\t};\n\n\tthis.loadScript = function(scriptEl, wnd) {\n\t\treturn this.createScript(scriptEl.textContent, scriptEl.getAttribute('name')).load(wnd);\n\t};\n\n\tthis.load = function(wnd) {\n\t\tvar scripts = (wnd ? wnd.document : document).querySelectorAll('script[type=\"text/jsq\"]');\n\t\tfor (var i=0,l=scripts.length; i<l; i++) {\n\t\t\tthis.loadScript(scripts[i], wnd);\n\t\t}\n\t};\n\n}\n\nfunction Script() {\n\tthis.name = null;\n\tthis.code = null;\n\tthis.comp = null;\n\tthis.deps = null;\n\n\tthis.load = function(wnd) {\n\t\tif (this.name) { window[this.name] = this.comp; }\n\t\treturn this;\n\t};\n\n/*\n\tthis.resolve = function(path) {\n\t\tif (!this.file) return null;\n\t\tvar parts = this.file.split('/').pop();\n\t\tpath.split('/').forEach(function(part) {\n\t\t\tif (part === '..') {\n\t\t\t\tparts.pop();\n\t\t\t} else if (part !== '.') {\n\t\t\t\tparts.push(part);\n\t\t\t}\n\t\t});\n\t\treturn parts.join('/');\n\t}\n*/\n\n}\n\nvar PRINT_RX = /%s/g;\nfunction print(text) {\n\tvar i = 1, args = arguments;\n\treturn text.replace(PRINT_RX, function(match, p1) {\n\t\treturn args[i++];\n\t});\n}\n\nQute.ERR.resolve = function (code) {\n\tvar text = errors[code];\n\tif (!text) { text = \"Qute Error: \"+code; }\n\telse {\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\targs[0] = text;\n\t\ttext = print.apply(null, args);\n\t}\n\tthrow new Error(text);\n};\n\nvar errors = {\n\n\n\t// ------------------------------------------------------\n\t// index.js\n\t/*\n\t1: \"Unsupported tag: '%s'\",\n\t2: \"template 'name' is required\",\n\t*/\n\t// runtime.js\n\t5: \"Usage: Qute(tag[, viewModelDefinition])\",\n\t// list.js\n\t10: \"Broken list fragment. Ignoring updates\",\n\t11: \"Invalid index: '%s'. Length is %s\",\n\t12: \"Invalid insertion index: '%s'. Length is %s'\",\n\t13: \"Remove anchor is invalid: '%s'. Length is %s\",\n\t14: \"Invalid move from index: '%s'. Length is %s\",\n\t15: \"Invalid move to index: '%s'. Length is %s\",\n\t// rendering.js\n\t20: \"Invalid dynamic component. Should be a ViewModel constructor or a xtag name\",\n\t// no more used\n\t//21: \"Found a 'nested' element without a 'name' attribute\",\n\t23: \"Could not resolve ViewModel at runtime for tag: '%s'\",\n\t24: \"dynamic for directive accepts only List instances and not regular arrays\",\n\t25: \"List properties cannot be used with the static for directive\",\n\t26: \"Bug? Unknown xattr name: %s\",\n\t27: \"Unknown converter: %s\",\n\t28: \"x-channel cannot be used on regular DOM elements: %s\",\n\t// update.js\n\t30: \"Possible infinite loop detected\",\n\t// vm.js\n\t31: \"Incompatible assign for list property: %s\",\n\t32: \"No render function defined for the ViewModel!\",\n\t33: \"VM is already mounted!\",\n\t34: \"VM is not mounted!\",\n\t35: \"View not connected\",\n\t36: \"No template found for tag '%s'\",\n\t37: \"Failed to install plugin %s. Plugins must provide an install(ctx) method.\",\n\t38: 'Posting message to unknown topic %s',\n\t39: \"x-channel used on a VM not defining channels: %s\",\n\t//36: \"Cannot unmount a child view\",\n\t// compiler.js\n\t/*\n\t50: \"<tag> requires an 'is' attribute\",\n\t51: \"Invalid for expression\",\n\t52: \"For directive take exatcly one attribute\",\n\t53: \"if has only one required attribute: value='expr' and an optional one: @change='onChangeHandler'\",\n\t54: \"slot node take zero or one 'name' parameter\",\n\t55: \"the root node must have a single children element\",\n\t56: \"Invalid if attribute '%s'\",\n\t57: \"Closing tag '%s' doesn't match the start tag '%s'\",\n\t58: \"Static node (x-html) must have some content\",\n\t*/\n\t// rollup-plugin.js\n\t/*\n\t60: \"Tag not supported: '%s'\",\n\t61: \"The <template> tag requires a name attribute\",\n\t62: \"Unresolved tag: '%s'. Please import the implementation in camel case! Ex: \\nimport '%s' from 'some-module'\",\n\t*/\n\t// xtags-parser.js\n\t/*\n\t70: \"Bug?\",\n\t72: \"Invalid qute file: No closing </'%s'> found.\",\n\t73: \"Invalid qute file: Found closing tag '%s'. Expecting '%s'\",\n\t*/\n\t// binding.js\n\t//80: \"Invalid x-radio expression: '%s'. Must be a tag name with a class. Ex: li.active\"\n};\n\nQute.Compiler = Compiler;\nQute.compile = function(text, symbols) {\n\treturn new Compiler().compileFn(text, symbols);\n};\n\nQute.css('x-tag { display:none; }\\n');\n\nfunction loadXTag(text) {\n\tnew Compiler().loadXTags(text, function(xtagName, xtagFn, isCompiled) {\n\t\tQute.register(xtagName, xtagFn, isCompiled);\n\t});\n}\n// load templates\nQute.load = function(textOrId) {\n\tif (!textOrId) {\n\t\tvar xtags = document.getElementsByTagName('x-tag');\n\t    for (var i=0,l=xtags.length; i<l; i++) {\n\t    \tloadXTag(xtags[i].innerHTML);\n\t    }\n\t} else {\n\t\tloadXTag(textOrId[0] === '#' ? document.getElementById(textOrId.substring(1)).textContent : textOrId);\n\t}\n};\n\nQute.Loader = Loader;\nQute.loadScripts = function() {\n\tnew Loader().load();\n};\n\nexport default Qute;\n//# sourceMappingURL=index.esm.js.map\n","import Qute from '@qutejs/runtime';\nimport window, { document } from '@qutejs/window';\n\n/*\n* Extracted from Backbone.js History 1.1.0\n*/\n\n//helper functions\nvar objectAssign = Object.assign ? Object.assign : function extend(obj, source) {\n  for (var prop in source) {\n    obj[prop] = source[prop];\n  }\n  return obj;\n};\nfunction on(obj, type, fn) {\n  if (obj.attachEvent) {\n    obj['e'+type+fn] = fn;\n    obj[type+fn] = function(){ obj['e'+type+fn]( window.event ); };\n    obj.attachEvent( 'on'+type, obj[type+fn] );\n  } else {\n    obj.addEventListener( type, fn, false );\n  }\n}\nfunction off(obj, type, fn) {\n  if (obj.detachEvent) {\n    obj.detachEvent('on'+type, obj[type+fn]);\n    obj[type+fn] = null;\n  } else {\n    obj.removeEventListener(type, fn, false);\n  }\n}\n\n// handlers were removed - we simply use listeners without regex matching\n//\n// Backbone.History\n// ----------------\n\n// Handles cross-browser history management, based on either\n// [pushState](http://diveintohtml5.info/history.html) and real URLs, or\n// [onhashchange](https://developer.mozilla.org/en-US/docs/DOM/window.onhashchange)\n// and URL fragments.\nvar History = function() {\n  this.listeners = [];\n\n  var self = this;\n  var checkUrl = this.checkUrl;\n  this.checkUrl = function () {\n    checkUrl.apply(self, arguments);\n  };\n\n  // Ensure that `History` can be used outside of the browser.\n  if (typeof window !== 'undefined') {\n    this.location = window.location;\n    this.history = window.history;\n  }\n};\n\n// Cached regex for stripping a leading hash/slash and trailing space.\nvar routeStripper = /^[#\\/]|\\s+$/g;\n\n// Cached regex for stripping leading and trailing slashes.\nvar rootStripper = /^\\/+|\\/+$/g;\n\n// Cached regex for removing a trailing slash.\nvar trailingSlash = /\\/$/;\n\n// Cached regex for stripping urls of hash.\nvar pathStripper = /#.*$/;\n\n// MODIFICATION OF ORIGINAL BACKBONE.HISTORY\n// Has the history handling already been started?\n// History.started = false;\n\n// Set up all inheritable **Backbone.History** properties and methods.\nobjectAssign(History.prototype, {\n\n  // Are we at the app root?\n  atRoot: function() {\n    return this.location.pathname.replace(/[^\\/]$/, '$&/') === this.root;\n  },\n\n  // Gets the true hash value. Cannot use location.hash directly due to bug\n  // in Firefox where location.hash will always be decoded.\n  getHash: function(window) {\n    var match = (window || this).location.href.match(/#(.*)$/);\n    return match ? match[1] : '';\n  },\n\n  // Get the cross-browser normalized URL fragment, either from the URL,\n  // the hash, or the override.\n  getFragment: function(fragment, forcePushState) {\n    if (fragment == null) {\n      if (this._hasPushState || !this._wantsHashChange || forcePushState) {\n        fragment = decodeURI(this.location.pathname + this.location.search);\n        var root = this.root.replace(trailingSlash, '');\n        if (!fragment.indexOf(root)) { fragment = fragment.slice(root.length); }\n      } else {\n        fragment = this.getHash();\n      }\n    }\n    return fragment.replace(routeStripper, '');\n  },\n\n  // Start the hash change handling, returning `true` if the current URL matches\n  // an existing route, and `false` otherwise.\n  start: function(options) {\n    // MODIFICATION OF ORIGINAL BACKBONE.HISTORY\n    // if (History.started) throw new Error(\"LocationBar has already been started\");\n    // History.started = true;\n    this.started = true;\n\n    // Figure out the initial configuration.\n    // Is pushState desired ... is it available?\n    this.options          = objectAssign({root: '/'}, options);\n    this.location         = this.options.location || this.location;\n    this.history          = this.options.history || this.history;\n    this.root             = this.options.root;\n    this._wantsHashChange = this.options.hashChange !== false;\n    this._wantsPushState  = !!this.options.pushState;\n    this._hasPushState    = !!(this.options.pushState && this.history && this.history.pushState);\n    var fragment          = this.getFragment();\n\n    // Normalize root to always include a leading and trailing slash.\n    this.root = ('/' + this.root + '/').replace(rootStripper, '/');\n\n    // Depending on whether we're using pushState or hashes, and whether\n    // 'onhashchange' is supported, determine how we check the URL state.\n    if (this._hasPushState) {\n      on(window, 'popstate', this.checkUrl);\n    } else {\n      on(window, 'hashchange', this.checkUrl);\n    }\n\n    // Determine if we need to change the base url, for a pushState link\n    // opened by a non-pushState browser.\n    this.fragment = fragment;\n    var loc = this.location;\n\n    // Transition from hashChange to pushState or vice versa if both are\n    // requested.\n    if (this._wantsHashChange && this._wantsPushState) {\n\n      // If we've started off with a route from a `pushState`-enabled\n      // browser, but we're currently in a browser that doesn't support it...\n      if (!this._hasPushState && !this.atRoot()) {\n        this.fragment = this.getFragment(null, true);\n        this.location.replace(this.root + '#' + this.fragment);\n        // Return immediately as browser will do redirect to new url\n        return true;\n\n      // Or if we've started out with a hash-based route, but we're currently\n      // in a browser where it could be `pushState`-based instead...\n      } else if (this._hasPushState && this.atRoot() && loc.hash) {\n        this.fragment = this.getHash().replace(routeStripper, '');\n        this.history.replaceState({}, document.title, this.root + this.fragment);\n      }\n\n    }\n\n    if (!this.options.silent) { return this.loadUrl(); }\n  },\n\n  // Disable Backbone.history, perhaps temporarily. Not useful in a real app,\n  // but possibly useful for unit testing Routers.\n  stop: function() {\n    off(window, 'popstate', this.checkUrl);\n    off(window, 'hashchange', this.checkUrl);\n    this.started = false;\n  },\n\n\n  // Checks the current URL to see if it has changed, and if it has,\n  // calls `loadUrl`.\n  checkUrl: function() {\n    var current = this.getFragment();\n    if (current === this.fragment) { return false; }\n    this.loadUrl();\n  },\n\n  // Attempt to load the current URL fragment. If a route succeeds with a\n  // match, returns `true`. If no defined routes matches the fragment,\n  // returns `false`.\n  loadUrl: function(fragment) {\n    fragment = this.fragment = this.getFragment(fragment);\n    var listeners = this.listeners;\n    for (var i=0,l=listeners.length; i<l; i++) {\n      listeners[i](fragment);\n    }\n  },\n\n  // Save a fragment into the hash history, or replace the URL state if the\n  // 'replace' option is passed. You are responsible for properly URL-encoding\n  // the fragment in advance.\n  //\n  // The options object can contain `trigger: true` if you wish to have the\n  // route callback be fired (not usually desirable), or `replace: true`, if\n  // you wish to modify the current URL without adding an entry to the history.\n  navigate: function(fragment, options) {\n    if (!this.started) { return false; }\n    if (!options || options === true) { options = {trigger: !!options}; }\n\n    var url = this.root + (fragment = this.getFragment(fragment || ''));\n\n    // Strip the hash for matching.\n    fragment = fragment.replace(pathStripper, '');\n\n    if (this.fragment === fragment) { return; }\n    this.fragment = fragment;\n\n    // Don't include a trailing slash on the root.\n    if (fragment === '' && url !== '/') { url = url.slice(0, -1); }\n\n    // If pushState is available, we use it to set the fragment as a real URL.\n    if (this._hasPushState) {\n      this.history[options.replace ? 'replaceState' : 'pushState']({}, document.title, url);\n\n    // If hash changes haven't been explicitly disabled, update the hash\n    // fragment to store history.\n    } else if (this._wantsHashChange) {\n      this._updateHash(this.location, fragment, options.replace);\n    // If you've told us that you explicitly don't want fallback hashchange-\n    // based history, then `navigate` becomes a page refresh.\n    } else {\n      return this.location.assign(url);\n    }\n    if (options.trigger) { return this.loadUrl(fragment); }\n  },\n\n  // Update the hash location, either replacing the current entry, or adding\n  // a new one to the browser history.\n  _updateHash: function(location, fragment, replace) {\n    if (replace) {\n      var href = location.href.replace(/(javascript:|#).*$/, '');\n      location.replace(href + '#' + fragment);\n    } else {\n      // Some browsers require that `hash` contains a leading #.\n      location.hash = '#' + fragment;\n    }\n  }\n\n});\n\n\n\n// add some features to History\n\n// a more intuitive alias for navigate\nHistory.prototype.update = function () {\n  this.navigate.apply(this, arguments);\n};\n\n// a generic callback for any changes\nHistory.prototype.onChange = function (callback) {\n  this.listeners.push(callback);\n};\n\n// checks if the browser has pushstate support\nHistory.prototype.hasPushState = function () {\n  // MODIFICATION OF ORIGINAL BACKBONE.HISTORY\n  if (!this.started) {\n    throw new Error(\"only available after LocationBar.start()\");\n  }\n  return this._hasPushState;\n};\n\nvar VARS_RX = /\\$\\{([a-zA-Z_$][a-zA-Z_0-9$]*)\\}/g;\n\nfunction expandVars$1(text, vars) {\n\treturn text.replace(VARS_RX, function(m, p1) {\n\t\tvar val = vars[p1];\n\t\treturn val === undefined ? m : String(val);\n\t})\n}\n\nfunction absPath(path) {\n\treturn path.charCodeAt(0) !== 47 ? '/'+path : path;\n}\n\nvar VARS_RX$1 = /<([^>:]*)(?:\\:([^>]*))?>/;\n\nfunction RxMatcher(rx, vars) {\n\treturn function(segment, params) {\n\t\tvar m = rx.exec(segment);\n\t\tif (m) {\n\t\t\tfor (var i=1, l=m.length; i<l; i++) {\n\t\t\t\tvar v = vars[i-1];\n\t\t\t\tif (v) {\n\t\t\t\t\tvar param = m[i];\n\t\t\t\t\tif (param) {\n\t\t\t\t\t\tif (v.mod) { // remove leading / if any\n\t\t\t\t\t\t\tif (param.charCodeAt(0) === 47) {\n\t\t\t\t\t\t\t\tparam = param.substring(1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparams[v.name] = param;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}\n\nfunction TextMatcher(text) {\n\treturn function(segment, params) {\n\t\treturn segment === text;\n\t}\n}\n\nfunction ANY() { return true; }\nANY.$vars = 100000; // should be the last when sorting\n\nfunction PathBinding(pattern, value) {\n\n\tfunction isModifier(path, index) {\n\t\tif (path.length === index+1 || path.charCodeAt(index+1) === 47) { // next is / or end of path\n\t\t\tswitch (path.charCodeAt(index)) {\n\t\t\t\tcase 63: return 1; // ?\n\t\t\t\tcase 42: return 2; // *\n\t\t\t\tcase 43: return 3; // +\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfunction compilePath(path) {\n\t\tif (path === '/*') { return ANY; }\n\t\tvar i = path.indexOf('<');\n\t\tif (i === -1) { return TextMatcher(path); }\n\n\t\tvar m = VARS_RX$1.exec(path);\n\n\t\tif (!m) { return TextMatcher(path); }\n\n\t\tvar out = '', vars = [];\n\t\twhile (m) {\n\t\t\tvar prefix = m.index > 0 ? path.substring(0, m.index).replace(/\\.\\(\\)\\$\\^\\[\\]\\?\\*\\+/g, '\\\\$1') : null;\n\t\t\tvar nextIndex = m.index+m[0].length, rx = m[2] || '[^/]+';\n\t\t\tvar nextCh = path.charCodeAt(nextIndex);\n\t\t\tvar mod = isModifier(path, nextIndex);\n\t\t\t// if next chars are +/, */, ?/ or +, *, ?\n\t\t\tif (mod) { // ?+* modifier is present\n\t\t\t\tif (prefix && prefix.charCodeAt(prefix.length-1) === 47) {\n\t\t\t\t\t// remove trailing / since it will be included in the rx\n\t\t\t\t\tprefix = prefix.substring(0, prefix.length-1);\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error('Modifier +, * and ? can be used only on named path segments: '+path);\n\t\t\t\t}\n\t\t\t\t// remove modifier char from path\n\t\t\t\tnextIndex++;\n\t\t\t\tif (mod === 1) {\n\t\t\t\t\trx = '((?:/'+rx+')?)';\n\t\t\t\t} else if (mod === 2) {\n\t\t\t\t\trx = '((?:/'+rx+')*)';\n\t\t\t\t} else if (mod === 3) {\n\t\t\t\t\trx = '((?:/'+rx+')+)';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trx = '('+rx+')';\n\t\t\t}\n\t\t\tvars.push({name: m[1].trim(), mod: mod});\n\t\t\tout += prefix ? prefix+rx : rx;\n\t\t\tpath = path.substring(nextIndex);\n\t\t\tm = VARS_RX$1.exec(path);\n\t\t}\n\t\tif (path.length) {\n\t\t\tout += path.replace(/\\.\\(\\)\\$\\^\\[\\]\\?\\*\\+/g, '\\\\$1');\n\t\t}\n\t\tvar matcher = RxMatcher(new RegExp(out), vars);\n\t\tmatcher.$vars = vars.length;\n\t\treturn matcher;\n\t}\n\n\tthis.pattern = absPath(pattern);\n\tthis.match = compilePath(this.pattern);\n\tthis.vars = this.match.$vars || 0; // how many vars in pattern\n\tthis.value = value;\n}\n\nfunction PathMapping(bindings) {\n\tthis.bindings = [];\n\tbindings && this.map(bindings);\n}\n\nPathMapping.prototype = {\n\tadd: function(path, value) {\n\t\tthis.bindings.push(new PathBinding(path, value));\n\t},\n\tmap: function(bindings) {\n\t\tif (bindings) {\n\t\t\tvar self = this;\n\t\t\tObject.keys(bindings).forEach(function(key) {\n\t\t\t\tself.add(key, bindings[key]);\n\t\t\t});\n\t\t\t// sort bindings\n\t\t\tthis.sort();\n\t\t}\n\t},\n\tsort: function() {\n\t\tthis.bindings.sort(function(a, b) {\n\t\t\tvar r = a.vars - b.vars;\n\t\t\treturn r ? r : b.pattern.localeCompare(a.pattern);\n\t\t});\n\t},\n\tget: function(path) {\n\t\tpath = absPath(path);\n\t\tvar params = {};\n\t\tvar bindings = this.bindings;\n\t\tfor (var i=0,l=bindings.length; i<l; i++) {\n\t\t\tvar binding = bindings[i];\n\t\t\tif (binding.match(path, params)) {\n\t\t\t\treturn [binding.value, params];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n};\n\nfunction detectCycles(redirects, from) {\n\tvar visited = {};\n\tvisited[from] = true;\n\tvar to = redirects[from];\n\twhile (to) {\n\t\tif (visited[to]) { throw new Error('Found a redirection cycle: ['+from+\"] -> [\"+to+\"]\"); }\n\t\tvisited[to] = true;\n\t\tto = redirects[to];\n\t}\n}\n\nfunction Router(bindings) {\n\n\tthis.navigo = new History();\n\tthis.routes = new PathMapping();\n\tthis.redirects = {};\n\n\tbindings && this.map(bindings);\n}\n\nRouter.prototype = {\n\thandlerFromString: function(to) {\n\t\treturn null;\n\t},\n\tcreateRedirect: function(path, to) {\n\t\tto = absPath(to);\n\t\tthis.redirects[path] = to;\n\t\tdetectCycles(this.redirects);\n\t\tvar self = this;\n\t\treturn function(path, params) {\n\t\t\tself.navigate(expandVars$1(to, params), true); // replace the existing entry\n\t\t}\n\t},\n\tmap: function(bindings) {\n\t\tif (bindings) {\n\t\t\tvar self = this;\n\t\t\tObject.keys(bindings).forEach(function(key) {\n\t\t\t\tself.add(key, bindings[key]);\n\t\t\t});\n\t\t}\n\t\treturn this;\n\t},\n\tadd: function(path, to) {\n\t\tpath = absPath(path);\n\t\tvar handler = null;\n\t\tif (typeof to === 'string') {\n\t\t\thandler = this.handlerFromString(path, to);\n\t\t\tif (!handler) { // a redirect?\n\t\t\t\thandler = this.createRedirect(path, to);\n\t\t\t}\n\t\t}\n\t\tif (!handler) {\n\t\t\thandler = to;\n\t\t}\n\t\tthis.routes.add(path, handler);\n\t\treturn this;\n\t},\n\tstart: function(settings) {\n\t\tif (!this.routes.bindings.length) { throw new Error('No routes set!'); }\n\t\tthis.routes.sort();\n\n\t\tvar self = this;\n\t\tthis.navigo.onChange(function(path) {\n\t\t\tvar r = self.routes.get(path);\n\t\t\tif (r) {\n\t\t\t\tr[0](path, r[1]);\n\t\t\t} else {\n\t\t\t\tthrow new Error('No route found for \"'+path+'\"');\n\t\t\t}\n\t\t});\n\t\tvar loadCb = function() {\n\t\t\tself.navigo.start(settings);\n\t\t\twindow.removeEventListener('load', loadCb);\n\t\t};\n\t\twindow.addEventListener('load', loadCb);\n\t\treturn this;\n\t},\n\tstop: function() {\n\t\tthis.navigo.stop();\n\t},\n\tnavigate: function(path, replace) {\n\t\tpath = absPath(path);\n\t\tif (!this.navigo.hasPushState()) {\n\t\t\tpath = '#'+path;\n\t\t}\n\t\tthis.navigo.navigate(path, replace ? {replace:true} : undefined);\n\t},\n\troute: function(path, replace) { // an alias to navigate\n\t\tthis.navigate(path, replace);\n\t},\n\tonChange: function(callback) {\n\t\tthis.navigo.onChange(function(path) {\n\t\t\tcallback(absPath(path));\n\t\t});\n\t},\n\tpath: function() {\n\t\treturn absPath(this.navigo.getFragment());\n\t}\n};\n\nfunction QuteRouter(bindings, quteCtx) {\n\tRouter.call(this, bindings);\n\tthis.ctx = null;\n\tquteCtx && this.install(quteCtx);\n}\n\nvar QuteRouterProto = Object.create(Router.prototype);\nQuteRouterProto.handlerFromString = function(path, to) {\n\tif (to.substring(0, 5) === 'post:') {\n\t\tif (!this.ctx) { throw new Error('Using \"post:\" protocol without a Qute context!'); }\n\t\tvar target = to.substring(5);\n\t\tvar i = target.indexOf('/');\n\t\tif (i === -1) { throw new Error('Invalid message post target. Expecting \"post:channel/message-name\" but got '+to); }\n\t\tvar msg = target.substring(i+1);\n\t\tvar channel = target.substring(0,  i);\n\t\tvar ctx = this.ctx;\n\t\treturn function(path, params) {\n\t\t\tctx.postAsync(expandVars(channel, params), expandVars(msg, params), params);\n\t\t}\n\t}\n\treturn null;\n};\nQuteRouterProto.install = function(ctx) {\n\tif (this.ctx) { throw new Error('Qute Router already installed!'); }\n\tif (ctx.$ctx) { ctx = ctx.$ctx; } // accept Qute components too.\n\tthis.ctx = ctx;\n\tctx.router = this;\n\tctx.subscribe('route', function(msg, data) {\n\t\t// data can be 'true' to replace the current entry in history\n\t\tctx.router.navigate(msg, data);\n\t});\n\treturn this;\n};\n\nQuteRouter.prototype = QuteRouterProto;\n\nQute.Router = QuteRouter;\n\nexport default QuteRouter;\n//# sourceMappingURL=index.esm.js.map\n","import Qute from '@qutejs/runtime';\nimport { document as document$1 } from '@qutejs/window';\n\n/*\n@see https://tympanus.net/codrops/2013/06/25/nifty-modal-window-effects/ for modal effects\n@see https://davidwalsh.name/css-vertical-center for vertical centering using translate\n*/\n\nfunction toggleScroll(enable) {\n\tvar body = document$1.body;\n\tif (enable) {\n        Object.assign(body.style, {overflow: 'initial', height: 'initial'});\n\t} else {\n        Object.assign(body.style, {overflow: 'hidden', height: '100vh'});\n\t}\n}\n\nfunction getFocusableElements(root) {\n\treturn (root || document$1).querySelectorAll('button, a[href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])');\n}\n\nfunction createModal(id, content, effect) {\n\tvar container = document$1.createElement('DIV');\n\tcontainer.id = id;\n\tvar modal = document$1.createElement('DIV');\n\tmodal.className = effect ? 'md-modal md-effect-'+effect : 'md-modal';\n\tmodal.tabIndex = -1;\n\tvar contentEl = document$1.createElement('DIV');\n\tcontentEl.className = 'md-content';\n\tmodal.appendChild(contentEl);\n\tvar overlay = document$1.createElement('DIV');\n\toverlay.className = 'md-overlay';\n\tcontainer.appendChild(modal);\n\tcontainer.appendChild(overlay);\n\n\tif (content.jquery) {\n\t\tcontentEl.appendChild(content[0]);\n\t} else if (typeof content === 'string') {\n\t\tcontentEl.innerHTML = content;\n\t} else if (Array.isArray(content)) {\n\t\tfor (var i=0, l=content.length; i<l; i++) {\n\t\t\tcontentEl.appendChild(content[i]);\n\t\t}\n\t} else { // assume a element\n\t\tcontentEl.appendChild(content);\n\t}\n\n\treturn container;\n}\n\n\nfunction Modal(name, content, settings) {\n\tthis.id = '--qute-modal-'+name;\n\tthis.settings = {\n\t\teffect: null,\n\t\tcloseOnEsc: true,\n\t\tcloseOnClick: true,\n\t\tdisableScroll: true\n\t};\n\tif (settings) {\n\t\tObject.assign(this.settings, settings);\n\t}\n\tthis.el = createModal(this.id, content, settings.effect);\n\tthis.activeElement = null;\n\tthis.cleanup = null;\n}\nModal.prototype = {\n\topen: function() {\n\t\tvar modal = this.el.firstChild;\n\t\tvar cl = modal.classList;\n\t\tif (cl.contains('md-show')) { return; } // already visible\n\n\t\tvar self = this;\n\t\tvar settings = this.settings;\n\t\tsettings.open && settings.open(this);\n\n\t\tcl.add('md-show');\n\t\t// 0. save focus status\n\t\tthis.activeElement = document$1.activeElement; // save the active element before opening\n\t\t// 1. disable scroll\n\t\tif (settings.disableScroll) { toggleScroll(false); }\n\t\t// 2. add click listener to handle close and other actions\n\t\tthis.addListener(this.el, 'click', function(e) {\n\t\t\tvar handled = false, target = e.target;\n\t\t\tif ((target === self.el.lastChild && settings.closeOnClick) || target.classList.contains('md-close')) {\n\t\t\t\t// click on overlay or .md-close\n\t\t\t\tself.close();\n\t\t\t\thandled = true;\n\t\t\t} else if (settings.action) {\n\t\t\t\tvar action = target.getAttribute('data-md-action');\n\t\t\t\tif (action === 'close') {\n\t\t\t\t\tself.close();\n\t\t\t\t\thandled = true;\n\t\t\t\t} else if (action) {\n\t\t\t\t\tsettings.action(action, target);\n\t\t\t\t\thandled = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (handled) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t});\n\t\t//3. add keydown listener to trap focus inside the modal and to handle close on escape\n\t\tvar focusable = getFocusableElements(modal);\n\t\tvar firstFocusable, lastFocusable;\n\t\tif (focusable.length) {\n\t\t\tfirstFocusable = focusable[0];\n\t\t\tlastFocusable = focusable[focusable.length-1];\n\t\t}\n\t\tthis.addListener(modal, 'keydown', function(e) {\n\t\t\tif (e.keyCode === 27) {\n\t\t\t\tself.settings.closeOnEsc && self.close();\n\t\t\t} else if (firstFocusable && e.keyCode === 9) {\n\t\t\t\tvar toFocus, focus = document$1.activeElement;\n\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\tif (firstFocusable === focus) {\n\t\t\t\t\t\ttoFocus = lastFocusable;\n\t\t\t\t\t}\n\t\t\t\t} else if (lastFocusable === focus) {\n\t\t\t\t\ttoFocus = firstFocusable;\n\t\t\t\t}\n\t\t\t\tif (toFocus) {\n\t\t\t\t\ttoFocus.focus();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// acquire focus - set focus on .md-focus marked element otherwise on the modal itself\n\t\tvar toFocus = modal.getElementsByClassName('md-focus')[0] || modal;\n\t\tfunction acquireFocus() {\n\t\t\ttoFocus.focus();\n\t\t\tsettings.ready && settings.ready(this);\n\t\t}\n\t\tif (settings.effect) {\n\t\t\tvar transitionEnd = function() {\n\t\t\t\tacquireFocus();\n\t\t\t\tmodal.firstChild.removeEventListener('transitionend', transitionEnd);\n\t\t\t};\n\t\t\tmodal.firstChild.addEventListener('transitionend', transitionEnd);\n\t\t} else {\n\t\t\tacquireFocus();\n\t\t}\n\t},\n\tclose: function() {\n\t\tthis.el.firstChild.classList.remove('md-show');\n\t\tthis.settings.close && this.settings.close(this);\n\t\tif (this.settings.disableScroll) { toggleScroll(true); }\n\t\tif (this.activeElement) { this.activeElement.focus(); }\n\t\tthis.activeElement = null;\n\t\tif (this.cleanup) {\n\t\t\tthis.cleanup();\n\t\t\tthis.cleanup = null;\n\t\t}\n\t},\n\taddListener: function(el, name, fn) {\n\t\tel.addEventListener(name, fn);\n\t\tvar nextCleanup = this.cleanup;\n\t\tthis.cleanup = function() {\n\t\t\tel.removeEventListener(name, fn);\n\t\t\tnextCleanup && nextCleanup();\n\t\t};\n\t},\n\t// dinamically change the effect\n\teffect: function(effect) {\n\t\tthis.settings.effect = effect;\n\t\tif (this.el) {\n\t\t\tthis.el.firstChild.className = effect ? 'md-modal md-effect-'+effect : 'md-modal';\n\t\t}\n\t}\n\n};\n\nvar css = \"\\n.md-close {\\n\\topacity: .5;\\n}\\n.md-close:hover {\\n\\topacity: .8;\\n}\\n.md-close:before {\\n\\tposition: absolute;\\n\\tright:0;\\n\\ttop:0;\\n\\tcursor: pointer;\\n\\tcontent: \\\"\\\\00d7\\\";\\n\\tfont-size: 24px;\\n\\tline-height: 24px;\\n\\tfont-weight: 500;\\n\\tpadding: 6px 14px;\\n}\\n\\n.md-modal {\\n\\tposition: fixed;\\n\\ttop: 50%;\\n\\tleft: 50%;\\n\\twidth: 50%;\\n\\tmax-width: 630px;\\n\\tmin-width: 320px;\\n\\theight: auto;\\n\\tz-index: 2000;\\n\\tvisibility: hidden;\\n\\t-webkit-backface-visibility: hidden;\\n\\t-moz-backface-visibility: hidden;\\n\\tbackface-visibility: hidden;\\n\\t-webkit-transform: translateX(-50%) translateY(-50%);\\n\\t-moz-transform: translateX(-50%) translateY(-50%);\\n\\t-ms-transform: translateX(-50%) translateY(-50%);\\n\\ttransform: translateX(-50%) translateY(-50%);\\n}\\n.md-modal:focus {\\n\\toutline:none;\\n}\\n\\n.md-show {\\n\\tvisibility: visible;\\n}\\n\\n.md-overlay {\\n\\tposition: fixed;\\n\\twidth: 100%;\\n\\theight: 100%;\\n\\tvisibility: hidden;\\n\\ttop: 0;\\n\\tleft: 0;\\n\\tz-index: 1000;\\n\\topacity: 0;\\n\\tbackground: rgba(0,0,0,0.6);\\n\\t-webkit-transition: all 0.3s;\\n\\t-moz-transition: all 0.3s;\\n\\ttransition: all 0.3s;\\n}\\n\\n.md-show ~ .md-overlay {\\n\\topacity: 1;\\n\\tvisibility: visible;\\n}\\n\\n/* Content styles */\\n.md-content {\\n\\tcolor: #333;\\n\\tbackground: white;\\n\\tposition: relative;\\n\\tborder-radius: 3px;\\n\\tmargin: 0 auto;\\n}\\n\\n/* ---------------------- effects --------------------- */\\n\\n/* Effect 1: Fade in and scale up */\\n.md-effect-scale-up .md-content {\\n\\t-webkit-transform: scale(0.7);\\n\\t-moz-transform: scale(0.7);\\n\\t-ms-transform: scale(0.7);\\n\\ttransform: scale(0.7);\\n\\topacity: 0;\\n\\t-webkit-transition: all 0.3s;\\n\\t-moz-transition: all 0.3s;\\n\\ttransition: all 0.3s;\\n}\\n\\n.md-show.md-effect-scale-up .md-content {\\n\\t-webkit-transform: scale(1);\\n\\t-moz-transform: scale(1);\\n\\t-ms-transform: scale(1);\\n\\ttransform: scale(1);\\n\\topacity: 1;\\n}\\n\\n/* Effect 2: Slide from the right */\\n.md-effect-slide-right .md-content {\\n\\t-webkit-transform: translateX(20%);\\n\\t-moz-transform: translateX(20%);\\n\\t-ms-transform: translateX(20%);\\n\\ttransform: translateX(20%);\\n\\topacity: 0;\\n\\t-webkit-transition: all 0.3s cubic-bezier(0.25, 0.5, 0.5, 0.9);\\n\\t-moz-transition: all 0.3s cubic-bezier(0.25, 0.5, 0.5, 0.9);\\n\\ttransition: all 0.3s cubic-bezier(0.25, 0.5, 0.5, 0.9);\\n}\\n\\n.md-show.md-effect-slide-right .md-content {\\n\\t-webkit-transform: translateX(0);\\n\\t-moz-transform: translateX(0);\\n\\t-ms-transform: translateX(0);\\n\\ttransform: translateX(0);\\n\\topacity: 1;\\n}\\n\\n/* Effect 3: Slide from the bottom */\\n.md-effect-slide-bottom .md-content {\\n\\t-webkit-transform: translateY(20%);\\n\\t-moz-transform: translateY(20%);\\n\\t-ms-transform: translateY(20%);\\n\\ttransform: translateY(20%);\\n\\topacity: 0;\\n\\t-webkit-transition: all 0.3s;\\n\\t-moz-transition: all 0.3s;\\n\\ttransition: all 0.3s;\\n}\\n\\n.md-show.md-effect-slide-bottom .md-content {\\n\\t-webkit-transform: translateY(0);\\n\\t-moz-transform: translateY(0);\\n\\t-ms-transform: translateY(0);\\n\\ttransform: translateY(0);\\n\\topacity: 1;\\n}\\n\\n/* Effect 4: Newspaper */\\n.md-effect-newspaper .md-content {\\n\\t-webkit-transform: scale(0) rotate(720deg);\\n\\t-moz-transform: scale(0) rotate(720deg);\\n\\t-ms-transform: scale(0) rotate(720deg);\\n\\ttransform: scale(0) rotate(720deg);\\n\\topacity: 0;\\n}\\n\\n.md-show.md-effect-newspaper ~ .md-overlay,\\n.md-effect-newspaper .md-content {\\n\\t-webkit-transition: all 0.5s;\\n\\t-moz-transition: all 0.5s;\\n\\ttransition: all 0.5s;\\n}\\n\\n.md-show.md-effect-newspaper .md-content {\\n\\t-webkit-transform: scale(1) rotate(0deg);\\n\\t-moz-transform: scale(1) rotate(0deg);\\n\\t-ms-transform: scale(1) rotate(0deg);\\n\\ttransform: scale(1) rotate(0deg);\\n\\topacity: 1;\\n}\\n\\n/* Effect 5: fall */\\n.md-effect-fall.md-modal {\\n\\t-webkit-perspective: 1300px;\\n\\t-moz-perspective: 1300px;\\n\\tperspective: 1300px;\\n}\\n\\n.md-effect-fall .md-content {\\n\\t-webkit-transform-style: preserve-3d;\\n\\t-moz-transform-style: preserve-3d;\\n\\ttransform-style: preserve-3d;\\n\\t-webkit-transform: translateZ(600px) rotateX(20deg);\\n\\t-moz-transform: translateZ(600px) rotateX(20deg);\\n\\t-ms-transform: translateZ(600px) rotateX(20deg);\\n\\ttransform: translateZ(600px) rotateX(20deg);\\n\\topacity: 0;\\n}\\n\\n.md-show.md-effect-fall .md-content {\\n\\t-webkit-transition: all 0.3s ease-in;\\n\\t-moz-transition: all 0.3s ease-in;\\n\\ttransition: all 0.3s ease-in;\\n\\t-webkit-transform: translateZ(0px) rotateX(0deg);\\n\\t-moz-transform: translateZ(0px) rotateX(0deg);\\n\\t-ms-transform: translateZ(0px) rotateX(0deg);\\n\\ttransform: translateZ(0px) rotateX(0deg);\\n\\topacity: 1;\\n}\\n\\n/* Effect 6: side fall */\\n.md-effect-side-fall.md-modal {\\n\\t-webkit-perspective: 1300px;\\n\\t-moz-perspective: 1300px;\\n\\tperspective: 1300px;\\n}\\n\\n.md-effect-side-fall .md-content {\\n\\t-webkit-transform-style: preserve-3d;\\n\\t-moz-transform-style: preserve-3d;\\n\\ttransform-style: preserve-3d;\\n\\t-webkit-transform: translate(30%) translateZ(600px) rotate(10deg);\\n\\t-moz-transform: translate(30%) translateZ(600px) rotate(10deg);\\n\\t-ms-transform: translate(30%) translateZ(600px) rotate(10deg);\\n\\ttransform: translate(30%) translateZ(600px) rotate(10deg);\\n\\topacity: 0;\\n}\\n\\n.md-show.md-effect-side-fall .md-content {\\n\\t-webkit-transition: all 0.3s ease-in;\\n\\t-moz-transition: all 0.3s ease-in;\\n\\ttransition: all 0.3s ease-in;\\n\\t-webkit-transform: translate(0%) translateZ(0) rotate(0deg);\\n\\t-moz-transform: translate(0%) translateZ(0) rotate(0deg);\\n\\t-ms-transform: translate(0%) translateZ(0) rotate(0deg);\\n\\ttransform: translate(0%) translateZ(0) rotate(0deg);\\n\\topacity: 1;\\n}\\n\\n/* Effect 7:  slide and stick to top */\\n.md-effect-sticky-up {\\n\\ttop: 0;\\n\\t-webkit-transform: translateX(-50%);\\n\\t-moz-transform: translateX(-50%);\\n\\t-ms-transform: translateX(-50%);\\n\\ttransform: translateX(-50%);\\n}\\n\\n.md-effect-sticky-up .md-content {\\n\\t-webkit-transform: translateY(-200%);\\n\\t-moz-transform: translateY(-200%);\\n\\t-ms-transform: translateY(-200%);\\n\\ttransform: translateY(-200%);\\n\\t-webkit-transition: all .3s;\\n\\t-moz-transition: all .3s;\\n\\ttransition: all .3s;\\n\\topacity: 0;\\n}\\n\\n.md-show.md-effect-sticky-up .md-content {\\n\\t-webkit-transform: translateY(0%);\\n\\t-moz-transform: translateY(0%);\\n\\t-ms-transform: translateY(0%);\\n\\ttransform: translateY(0%);\\n\\tborder-radius: 0 0 3px 3px;\\n\\topacity: 1;\\n}\\n\\n\\n\";\n\nQute.css(css);\n\nvar modal_id = 0;\n\n/**\n */\nvar index = Qute(\"modal\", {\n\tinit: function() {\n\t\treturn {\n\t\t\tanimation: null,\n\t\t\tcloseOnEsc: true,\n\t\t\tcloseOnClick: true,\n\t\t\tdisableScroll: true\n\t\t };\n\t},\n\trender: function() {\n\t\treturn document.createComment('[modal]');\n\t},\n\tcreated: function() {\n\t\tvar slots = this.$slots;\n\t\tif (!slots || !slots.default) { throw new Error('<modal> requires a content!'); }\n\n\t\tvar self = this;\n\t\tthis.modal = new Modal('qute-modal-'+(modal_id++), slots.default, {\n\t\t\teffect: this.animation,\n\t\t\tcloseOnEsc:this.closeOnEsc,\n\t\t\tcloseOnClick: this.closeOnClick,\n\t\t\tdisableScroll: this.disableScroll,\n\t\t\topen: function(modal) {\n\t\t\t\tself.emit(\"open\", self.modal.el);\n\t\t\t},\n\t\t\tclose: function(modal) {\n\t\t\t\tself.emit(\"close\", self.modal.el);\n\t\t\t},\n\t\t\tready: function(modal) {\n\t\t\t\tself.emit(\"ready\", self.modal.el);\n\t\t\t},\n\t\t\taction: function(action, target) {\n\t\t\t\tself.emit(\"action\", {modal: self.modal.el, name: action, target: target});\n\t\t\t}\n\t\t});\n\t},\n\tconnected: function() {\n\t\tdocument.body.appendChild(this.modal.el);\n\t},\n\tdisconnected: function() {\n\t\tdocument.body.removeChild(this.modal.el);\n\t},\n\topen: function() {\n\t\tthis.modal.open();\n\t},\n\tclose: function() {\n\t\tthis.modal.close();\n\t}\n}).channel(function(msg) {\n\tif (msg === 'open') {\n\t\tthis.open();\n\t} else if (msg === 'close') {\n\t\tthis.close();\n\t}\n}).watch('animation', function(value) {\n\tthis.modal.effect(value);\n\treturn false;\n}).watch('closeOnEsc', function(value) {\n\tthis.modal.settings.closeOnEsc = !!value;\n\treturn false;\n}).watch('closeOnClick', function(value) {\n\tthis.modal.settings.closeOnClick = !!value;\n\treturn false;\n}).watch('disableScroll', function(value) {\n\tthis.modal.settings.disableScroll = !!value;\n\treturn false;\n});\n\nexport default index;\n//# sourceMappingURL=index.esm.js.map\n","import Qute from '@qutejs/runtime';\nimport window, { document as document$1 } from '@qutejs/window';\n\n//TODO: 1. add position classes to be able to adapt the effects: bottom, top, right, left\n// 2. remove popup.css and use some global animation css?\n// 3. use same api notations and styles with modal.js\n\nfunction toBottom(erect, rect, crect, out) {\n\tout.top = rect.bottom;\n\tif (out.top + erect.height > crect.bottom) { // flip to top\n\t\tout.top = rect.top - erect.height;\n\t}\n}\n\nfunction toTop(erect, rect, crect, out) {\n\tout.top = rect.top - erect.height;\n\tif (out.top < crect.top) { // flip to bottom\n\t\tout.top = rect.bottom;\n\t}\n}\n\nfunction toVStart(erect, rect, crect, out) {\n\tout.top = rect.top;\n\tif (out.top + erect.height > crect.bottom) { // flip\n\t\tout.top = rect.bottom - erect.height;\n\t}\n}\n\nfunction toVEnd(erect, rect, crect, out) {\n\tout.top = rect.bottom - erect.height;\n\tif (out.top < crect.top) { // flip\n\t\tout.top = rect.top;\n\t}\n}\n\nfunction toVCenter(erect, rect, crect, out) {\n\tout.top = rect.top + (rect.height - erect.height) / 2;\n}\n\nfunction toRight(erect, rect, crect, out) {\n\tout.left = rect.right;\n\tif (out.left + erect.width > crect.right) { // flip to left\n\t\tout.left = rect.left - erect.width;\n\t}\n}\n\nfunction toLeft(erect, rect, crect, out) {\n\tout.left = rect.left - erect.width;\n\tif (out.left < crect.left) { // flip to right\n\t\tout.left = rect.right;\n\t}\n}\n\n\nfunction toHStart(erect, rect, crect, out) {\n\tout.left = rect.left;\n\tif (out.left + erect.width > crect.right) { // flip\n\t\tout.left = rect.right - erect.width;\n\t}\n}\n\nfunction toHEnd(erect, rect, crect, out) {\n\tout.left = rect.right - erect.width;\n\tif (out.left < crect.left) { // flip\n\t\tout.left = rect.left;\n\t}\n}\n\nfunction toHCenter(erect, rect, crect, out) {\n\tout.left = rect.left + (rect.width - erect.width) / 2;\n}\n\n\n\nvar POS_FNS = {\n\ttop: toTop,\n\tbottom: toBottom,\n\tleft: toLeft,\n\tright: toRight\n};\n\nvar VALIGN_FNS = {\n\tstart: toVStart,\n\tend: toVEnd,\n\tcenter: toVCenter,\n\ttop: toTop,\n\tbottom: toBottom\n};\n\nvar HALIGN_FNS = {\n\tstart: toHStart,\n\tend: toHEnd,\n\tcenter: toHCenter,\n\tleft: toLeft,\n\tright: toRight\n};\n\n\n\n/*\n* Get the visible client rect contenttaining the target - relative to viewport\n*/\nfunction getVisibleClientRect(target, overflowingParents) {\n\tvar left=0, top=0, right = window.innerWidth, bottom = window.innerHeight;\n\tif (overflowingParents.length) {\n\t\tfor (var i=0,l=overflowingParents.length; i<l; i++) {\n\t\t\tvar parent = overflowingParents[i];\n\t\t\t// TODO bounding client rect includes the border -> use clientRect to remove border?\n\t\t\tvar prect = parent.getBoundingClientRect();\n\t\t\tif (prect.left > left) { left = prect.left; }\n\t\t\tif (prect.right < right) { right = prect.right; }\n\t\t\tif (prect.top > top) { top = prect.top; }\n\t\t\tif (prect.bottom < bottom) { bottom = prect.bottom; }\n\t\t}\n\t}\n\treturn {\n\t\tleft: left, top: top,\n\t\tright: right, bottom: bottom,\n\t\twidth: right-left, height: bottom-top\n\t};\n}\n\nfunction createPopup(content) {\n\tvar el = document$1.createElement('DIV');\n\tel.className = 'qute-popup';\n\tvar style = el.style;\n\tstyle.visibility = 'hidden';\n\tstyle.position = 'absolute';\n\tstyle.overflow = 'hidden'; // needed by some effects (e.g. slide in)\n\n\tvar contentEl = document$1.createElement('DIV');\n\tcontentEl.className = 'qute-popup-content';\n\tcontentEl.style.position = 'relative';\n\tel.appendChild(contentEl);\n\n\tif (content.jquery) {\n\t\tcontentEl.appendChild(content[0]);\n\t} else if (typeof content === 'string') {\n\t\tcontentEl.innerHTML = content;\n\t} else if (Array.isArray(content)) {\n\t\tfor (var i=0, l=content.length; i<l; i++) {\n\t\t\tcontentEl.appendChild(content[i]);\n\t\t}\n\t} else { // assume a element\n\t\tcontentEl.appendChild(content);\n\t}\n\treturn el;\n}\n/*\n * options: closeOnClick, position, align\n */\nfunction Popup(content) {\n\tthis.el = createPopup(content);\n\tthis.pos = 'bottom';\n\tthis.align = 'start';\n\tthis.closeOnClickOpt = true;\n\tthis.effectName = null;\n}\nPopup.prototype = {\n\tupdate: function(anchor) {\n\t\tif (anchor.jquery) { anchor = anchor[0]; }\n\t\tvar crect = getVisibleClientRect(anchor, this.ofs);\n\t\tvar rect = anchor.getBoundingClientRect();\n\t\t// if anchor is not hidden by the overflow then hide the popup\n\t\tif (rect.top >= crect.bottom || rect.bottom <= crect.top\n\t\t\t|| rect.left >= crect.right || rect.right <= crect.left) {\n\t\t\tthis.el.style.visibility = 'hidden';\n\t\t\treturn;\n\t\t}\n\n\t\tvar style = this.el.style;\n\t\t// first check for special modifier 'fill' (before getting the boundingclient rect since setting the height/width will modify the rect)\n\t\tvar align = this.align;\n\t\tif (align === 'fill') {\n\t\t\tif (this.pos ===  'bottom' || this.pos === 'top') {\n\t\t\t\tstyle.width = anchor.offsetWidth+'px';\n\t\t\t} else {\n\t\t\t\tstyle.height = anchor.offsetHeight+'px';\n\t\t\t}\n\t\t\talign = 'start';\n\t\t} else {\n\t\t\tstyle.width && (style.width = '');\n\t\t\tstyle.height && (style.height = '');\n\t\t}\n\n\n\t\tvar erect = this.el.getBoundingClientRect(); // we only need width and height\n\t\tvar out = {};\n\n\t\tvar posFn = POS_FNS[this.pos];\n\t\tif (!posFn) { throw new Error('Invalid position argument: '+this.pos+'. Expecting: top|bottom|left|right'); }\n\t\tposFn(erect, rect, crect, out);\n\n\t\tvar ALIGN_FNS = out.top == null ? VALIGN_FNS : HALIGN_FNS;\n\t\tvar alignFn = ALIGN_FNS[align];\n\t\tif (!alignFn) { throw new Error('Invalid vert align argument: '+align+'. Expecting: '+Object.keys(ALIGN_FNS).join('|')); }\n\t\talignFn(erect, rect, crect, out);\n\n\t\t//var className = out.position+' '+out.align;\n\t\t//if (this.className) className = this.className + ' ' + className;\n\t\t//this.el.className = this.c\n\n\n\t\tstyle.left = (out.left + window.pageXOffset)+'px';\n\t\tstyle.top = (out.top + window.pageYOffset)+'px';\n\t\tstyle.visibility = 'visible';\n\n\t\treturn this;\n\t},\n\topen: function(anchor) {\n\t\t// compute overflowing parents and register scroll listeners\n\t\tif (this.el.parentNode) { // already opened\n\t\t\treturn;\n\t\t}\n\t\tvar updating = false, self = this;\n\t\tvar updateFn = function() {\n\t\t\tif (!updating) {\n\t\t\t\twindow.requestAnimationFrame(function() {\n\t\t\t\t\tself.update(anchor);\n\t\t\t\t\tupdating = false;\n\t\t\t\t});\n\t\t\t\tupdating = true;\n\t\t\t}\n\t\t};\n\t\tvar ofs = [],\n\t\t\tbody = document$1.body,\n\t\t\tparent = anchor.parentNode;\n\t\twhile (parent && parent !== body) {\n\t\t\tif (parent.scrollHeight > parent.clientHeight || parent.scrollWidth > parent.clientWidth) {\n\t\t\t\tofs.push(parent);\n\t\t\t\tparent.addEventListener('scroll', updateFn);\n\t\t\t}\n\t\t\tparent = parent.parentNode;\n\t\t}\n\t\twindow.addEventListener('scroll', updateFn);\n\t\twindow.addEventListener('resize', updateFn);\n\t\t// TODO add resize listener\n\n\t\tthis.ofs = ofs;\n\t\t// add close on click listener\n\t\tvar closeOnClick;\n\t\tif (this.closeOnClickOpt) {\n\t\t\tcloseOnClick = function(e) {\n\t\t\t\tif (!self.el.contains(e.target)) {\n\t\t\t\t\tself.close();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\twindow.setTimeout(function() {\n\t\t\t\tdocument$1.addEventListener('click', closeOnClick);\n\t\t\t}, 0);\n\t\t}\n\n\n\t\tthis.cleanup = function() {\n\t\t\tif (closeOnClick) {\n\t\t\t\tdocument$1.removeEventListener('click', closeOnClick);\n\t\t\t}\n\t\t\twindow.removeEventListener('resize', updateFn);\n\t\t\twindow.removeEventListener('scroll', updateFn);\n\t\t\tfor (var i=0,l=ofs.length; i<l; i++) {\n\t\t\t\tofs[i].removeEventListener('scroll', updateFn);\n\t\t\t}\n\t\t};\n\n\t\tthis.onOpen && this.onOpen(this);\n\t\t// mount the popup\n\t\tdocument$1.body.appendChild(this.el);\n\t\t// show it\n\t\tthis.update(anchor);\n\t\tthis.el.classList.add('qute-show');\n\t},\n\tclose: function() {\n\t\tthis.onClose && this.onClose(this);\n\t\tthis.cleanup();\n\t\tvar el = this.el;\n\t\tel.classList.remove('qute-show');\n\t\tif (this.effectName) {\n\t\t\tvar fn = function() {\n\t\t\t\tel.style.visibility = 'hidden';\n\t\t\t\tel.parentNode && el.parentNode.removeChild(el);\n\t\t\t\tel.removeEventListener('transitionend', fn);\n\t\t\t};\n\t\t\tel.addEventListener('transitionend', fn);\n\t\t} else {\n\t\t\tel.style.visibility = 'hidden';\n\t\t\tel.parentNode.removeChild(el);\n\t\t}\n\t},\n\tposition: function(position, align) {\n\t\tif (align === undefined) {\n\t\t\tposition = position.trim();\n\t\t\tvar i = position.indexOf(' ');\n\t\t\tif (i > -1) {\n\t\t\t\talign = position.substring(i+1).trim();\n\t\t\t\tposition = position.substring(0, i);\n\t\t\t}\n\t\t}\n\t\tthis.pos = position;\n\t\tif (align) { this.align = align; }\n\t\treturn this;\n\t},\n\tcloseOnClick: function(closeOnClick) {\n\t\tthis.closeOnClickOpt = closeOnClick;\n\t\treturn this;\n\t},\n\teffect: function(effect) {\n\t\tthis.effectName = effect;\n\t\tthis.el.className = effect ? 'qute-popup qute-effect-'+effect : 'qute-popup';\n\t\treturn this;\n\t}\n};\n\nvar css = \"\\n.qute-popup.qute-effect-fade .qute-popup-content {\\n\\topacity: 0;\\n\\t-webkit-transition: opacity 0.3s;\\n\\t-moz-transition: opacity 0.3s;\\n\\t-ms-transition: opacity 0.3s;\\n\\ttransition: opacity 0.3s;\\n}\\n.qute-popup.qute-effect-fade.qute-show .qute-popup-content {\\n\\topacity: 1;\\n}\\n\\n\\n.qute-popup.qute-effect-slide .qute-popup-content {\\n\\t-webkit-transform: translateY(-20%);\\n\\t-moz-transform: translateY(-20%);\\n\\t-ms-transform: translateY(-20%);\\n\\ttransform: translateY(-20%);\\n\\topacity: 0;\\n\\t-webkit-transition: opacity 0.3s, transform 0.3s;\\n\\t-moz-transition: opacity 0.3s, transform 0.3s;\\n\\t-ms-transition: opacity 0.3s, transform 0.3s;\\n\\ttransition: opacity 0.3s, transform 0.3s;\\n}\\n.qute-popup.qute-effect-slide.qute-show .qute-popup-content {\\n\\t-webkit-transform: translateY(0);\\n\\t-moz-transform: translateY(0);\\n\\t-ms-transform: translateY(0);\\n\\ttransform: translateY(0);\\n\\topacity: 1;\\n}\\n\";\n\nQute.css(css);\n\n/*\nAttributes:\n\n- animation: optional: is set can be one of fade or slidde\n- position is a string in the form of \"position algin\" where\n\tposition is one of: top, bottom, left, right\n\tand align is one of: start, end, center, fill, top, bottom, left, right\n\n\tleft and right align are only valid for vertical positions.\n\ttop and bottom align are ony valid for horizontal positions\n\n- auto-close: boolean - toggle close on click. Defaults to true\n\nThe defaults are: animation: null, position: \"bottom start\", auto-close: true\n*/\nvar index = Qute('popup', {\n\tinit: function init() {\n\t\treturn {\n\t\t\tposition: 'bottom start',\n\t\t\tanimation: null,\n\t\t\tautoClose: true\n\t\t}\n\t},\n\trender: function() {\n\t\treturn document.createComment('[popup]');\n\t},\n\tcreated: function() {\n\t\tvar slots = this.$slots;\n\t\tif (!slots || !slots.default) { throw new Error('<popup> requires a content!'); }\n\t\tthis.popup = new Popup(slots.default).effect(this.animation).position(this.position).closeOnClick(this.autoClose);\n\t\tvar self = this;\n\t\tthis.popup.onOpen = function() {\n\t\t\tself.emit(\"open\", self.popup.el);\n\t\t};\n\t\tthis.popup.onClose = function() {\n\t\t\tself.emit(\"close\", self.popup.el);\n\t\t};\n\t},\n\topen: function(target) {\n\t\tthis.popup.open(target);\n\t},\n\tclose: function() {\n\t\tthis.popup.close();\n\t}\n}).channel(function(msg, data) {\n\tif (msg === 'open') {\n\t\tthis.open(data);\n\t} else if (msg === 'close') {\n\t\tthis.close();\n\t}\n}).watch('position', function(value) {\n\tthis.popup.position(value);\n\treturn false;\n}).watch('animation', function(value) {\n\tthis.popup.effect(value);\n\treturn false;\n}).watch('autoClose', function(value) {\n\tthis.popup.closeOnClick(!!value);\n\treturn false;\n});\n\nexport default index;\n//# sourceMappingURL=index.esm.js.map\n","import { document } from '@qutejs/window';\nimport Qute from '@qutejs/runtime';\n\nvar css = \".spinner {\\n  margin: 0 auto;\\n  text-align: center;\\n}\\n\\n.spinner > div {\\n  width: 18px;\\n  height: 18px;\\n  background-color: #333;\\n\\n  border-radius: 100%;\\n  display: inline-block;\\n  -webkit-animation: sk-bouncedelay 1.4s infinite ease-in-out both;\\n  animation: sk-bouncedelay 1.4s infinite ease-in-out both;\\n}\\n\\n.spinner .bounce1 {\\n  -webkit-animation-delay: -0.32s;\\n  animation-delay: -0.32s;\\n}\\n\\n.spinner .bounce2 {\\n  -webkit-animation-delay: -0.16s;\\n  animation-delay: -0.16s;\\n}\\n\\n@-webkit-keyframes sk-bouncedelay {\\n  0%, 80%, 100% { -webkit-transform: scale(0) }\\n  40% { -webkit-transform: scale(1.0) }\\n}\\n\\n@keyframes sk-bouncedelay {\\n  0%, 80%, 100% {\\n    -webkit-transform: scale(0);\\n    transform: scale(0);\\n  } 40% {\\n    -webkit-transform: scale(1.0);\\n    transform: scale(1.0);\\n  }\\n}\";\n\nQute.css(css);\n\n/*\nQute.register(\"loader-ellipsis\", function($){return $.h(\"div\",{\"class\":\"spinner\"},[$.t(\" \"),$.h(\"div\",{\"class\":\"bounce1\"},null),$.t(\" \"),$.h(\"div\",{\"class\":\"bounce2\"},null),$.t(\" \"),$.h(\"div\",{\"class\":\"bounce3\"},null),$.t(\" \")]);}, true);\n\n\n\n\n\n\n*/\n\nfunction updateStyle(div, color, size) {\n\tvar style = div.style;\n\tif (color) { style.backgroundColor = color; }\n\tif (size) {\n\t\tstyle.width = size;\n\t\tstyle.height = size;\n\t}\n}\n\nvar ellipsis = Qute('spinner', function(r, xattrs) {\n\tvar color = xattrs && xattrs.color;\n\tvar size = xattrs && xattrs.size;\n\n\tvar loader = document.createElement('DIV');\n\tloader.className = 'spinner';\n\n\tvar div = document.createElement('DIV');\n\tupdateStyle(div, color, size);\n\tdiv.className = 'bounce1';\n\tloader.appendChild(div);\n\n\tdiv = document.createElement('DIV');\n\tupdateStyle(div, color, size);\n\tdiv.className = 'bounce2';\n\tloader.appendChild(div);\n\n\tdiv = document.createElement('DIV');\n    updateStyle(div, color, size);\n\tdiv.className = 'bounce3';\n\tloader.appendChild(div);\n\n\treturn loader;\n});\n\nexport default ellipsis;\n//# sourceMappingURL=index.esm.js.map\n"],"names":["window","DOMException","reason","this","message","prototype","Error","checkIfValidClassListEntry","O","V","wsIndex","search","wsRE","DOMTokenList","hasOwnProp","Object","hasOwnProperty","defineProperty","allowTokenListConstruction","skipPropChange","TypeError","toString","toLocaleString","value","add","arguments$1","arguments","a","v","argLen","length","val","ele","proto","i","Len","resStr","className","remove","is","whenPropChanges","evt","event","prop","propertyName","target","srcElement","protoObjProto","strval","tokens","trim","split","resTokenList","oldLen","cI","cLen","sub","innerI","classList","Element","enumerable","get","call","detachEvent","protoObj","toks","configurable","set","newVal","writeable","attachEvent","polyfillClassList","DOMTokenListProto","testClass","document","createElement","item","n","toggle","oldValue","replace","oldToken","newToken","contains","forEach","f","tArg","entries","that","next","done","values","keys","assign","varArgs","to","index","nextSource","nextKey","writable","String","startsWith","rawPos","pos","substring","CustomEvent","params","bubbles","cancelable","detail","createEvent","initCustomEvent","capitalizeFirst","toUpperCase","kebabToCamel","indexOf","out","s","ERR","resolve","apply","stopEvent","e","preventDefault","stopPropagation","chainFnAfter","fn","prevFn","arg","closestVM","el","__qute__","parentNode","filterKeys","obj","filter","incl","key","matches","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","ownerDocument","querySelectorAll","closest","parentElement","nodeType","Array","slice","UpdateQueue","maxNestedLoops","queue","after","push","op","self","setTimeout","run","runAfter","runAfterCb","cnt","max","shift","l","Context","data","$topics","lifecycle","post","topic","msg","listeners","postAsync","subscribe","listenerFn","subscribeOnce","onceSubscription","unsubscribe","splice","freeze","VMS","XTAGS","getTag","tag","registerTag","templateFn","isCompiled","$compiled","$tag","getVMOrTag","addClassMap","cl","createListener","vm","createListeners","$listeners","SetAttr","model","valFn","changedKey","getAttribute","removeAttribute","setAttribute","SetInnerHTML","innerHTML","SetDisplay","display","style","__qute_display","SetToggle","attrs","SetClass","elt","isArray","bindClass","SetStyle","bindStyle","SetProp","$set","SetDOMAttrs","$attrs","SetFuncAttrs","vmAttrs","SetFuncAttr","SetVMAttrs","parentVM","parentAttrs","Emitter","emit","$el","dispatchEvent","undefined","emitAsync","timeout","appendChildren","parent","children","appendChild","applyListeners","doNotWrap","addEventListener","extractSlots","namedSlots","nestedCnt","hasContent","child","nodeName","slot","slotChildren","node","firstChild","nextSibling","nodeValue","default","RenderingProto","x","expr","text","createTextNode","up","t","g","isFn","xattrs","XTag","h","charCodeAt","hh","content","type","converter","Qute","converters","r","_v","slots","__VM__","$ctx","$create","oldVm","functx","$bindings","bindings","slotName","defaultChildren","$slots","frag","createDocumentFragment","createComment","w","isExpr","changeCb","noCache","childrenFn","marker","cache","cview","viewFrag","propKey","initialUpdate","viewXTag","$disconnect","removeChild","previousSibling","Rendering","insertBefore","$connect","$update","_if","_else","start","end","state","ieFrag","newState","listFn","iterationFn","list","$createListFragment","forFrag","newList","k","ll","ups","eval","xattr","isc","vms","$push","ctx","$parent","ListFragment","rendering","updateChildren","first","$up","clear","getInsertion","createItem","hasNext","insert","from","count","childR","__qute_ctx__","move","dstNode","append","AP","ListProto","listRendering","lfs","lf","$data","bind","$updateNow","ops","$redraw","$insert","$remove","$move","toJSON","List","ar","unshift","pop","deleteCount","argsl","len","sort","cmp","reverse","cb","thisArg","map","find","findIndex","reduce","initialValue","reduceRight","elem","lastIndexOf","isEnumerable","defProp","old","watcher","$watch","update","listProp","ViewModel","init","render","camelKey","def","BaseVm","ViewModelImpl","VMType","VMProto","create","constructor","dst","src","getOwnPropertyDescriptor","assignPropDefs","$super","template","watch","on","selector","$init","thisObj","$on","channel","listenFn","$channel","listen","channelName","setup","setupFn","cleanup","$clean","$root","$st","$r","connected","disconnected","$load","parentRendering","created","mount","elOrId","getElementById","body","unmount","wrapper","removeEventListener","name","toHTML","outerHTML","link","renderFn","QUTE_STYLE","splitList","rx","makeSymbols","acc","css","doc","id","textContent","head","xtagName","register","snapshotRegistry","restoreRegistry","snapshot","vmOrTemplate","STAG_RX","ETAG_RX","ATTR_RX","voids","else","case","area","base","br","col","embed","hr","img","input","meta","param","source","track","wbr","TAG_RX","TAG_END_RX","ATTR_RX$1","CNT_LINES_RX","getTagName","match","parseAttrs","attrsDecl","lastIndex","m","exec","newLines","join","parseXTags","handler","partText","stag","etag","transpile","compiler","opts","imports","import","compile","handleTemplate","JSON","stringify","removeNewLines","VAR_RX","EXPR_RX","OBJ_RX","ARROW_FN_RX","HTML_TAGS","_s","_key","__x","p1","p2","symbols","_x","_xo","c","charAt","_r","_cb","test","arrowFn","open","args","close","bs","be","localSymbols","getArrowFn","_fn","_nodes","_xattrs","directives","events","_events","attrValue","attr","RootNode","lastChild","TextNode","isBlank","DomNode","parseXAttrs","directive","isAttr","onChange","fname","pre","xcontent","StaticNode","ListNode","ctype","html","stack","tagName","isVoid","ExprNode","parts","FOR_RX","parseForExpr","listNode","forCtx","forSymbols","ElseNode","MUSTACHE_RX","NODES","if","change","valueAttr","changeAttr","for","process","processor","processSlot","SYMBOLS","true","false","null","$1","console","$","Compiler","collector","top","lastText","pushText","NodeType","parse","handleStartTag","toLowerCase","handleEndTag","comment","parseHTML","compileFn","Function","loadXTags","static","IMPORT_RX","EXPORT_RX","Loader","createScript","code","deps","p3","p4","path","warning","hasExport","buble","transform","comp","script","Script","loadScript","scriptEl","wnd","load","scripts","PRINT_RX","errors","5","10","11","12","13","14","15","20","23","24","25","26","27","28","30","31","32","33","34","35","36","37","38","39","loadXTag","xtagFn","textOrId","xtags","getElementsByTagName","loadScripts","objectAssign","off","History","checkUrl","location","history","routeStripper","rootStripper","trailingSlash","pathStripper","atRoot","pathname","root","getHash","href","getFragment","fragment","forcePushState","_hasPushState","_wantsHashChange","decodeURI","options","started","hashChange","_wantsPushState","pushState","loc","hash","replaceState","title","silent","loadUrl","stop","navigate","trigger","url","_updateHash","callback","hasPushState","VARS_RX","absPath","VARS_RX$1","TextMatcher","segment","ANY","PathBinding","pattern","isModifier","vars","prefix","nextIndex","mod","matcher","RegExp","$vars","compilePath","PathMapping","Router","navigo","routes","redirects","QuteRouter","quteCtx","install","b","localeCompare","binding","handlerFromString","createRedirect","visited","detectCycles","settings","loadCb","route","QuteRouterProto","toggleScroll","enable","document$1","overflow","height","Modal","effect","closeOnEsc","closeOnClick","disableScroll","container","modal","tabIndex","contentEl","overlay","jquery","createModal","activeElement","expandVars","router","addListener","handled","action","firstFocusable","lastFocusable","focusable","keyCode","toFocus","focus","shiftKey","getElementsByClassName","transitionEnd","acquireFocus","ready","nextCleanup","modal_id","animation","toBottom","erect","rect","crect","bottom","toTop","toRight","left","right","width","toLeft","POS_FNS","VALIGN_FNS","center","HALIGN_FNS","Popup","visibility","position","createPopup","align","closeOnClickOpt","effectName","anchor","overflowingParents","innerWidth","innerHeight","prect","getBoundingClientRect","getVisibleClientRect","ofs","offsetWidth","offsetHeight","posFn","ALIGN_FNS","alignFn","pageXOffset","pageYOffset","updating","updateFn","requestAnimationFrame","scrollHeight","clientHeight","scrollWidth","clientWidth","onOpen","onClose","autoClose","popup","updateStyle","div","color","size","backgroundColor","loader"],"mappings":"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"}