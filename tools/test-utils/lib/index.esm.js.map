{"version":3,"file":"index.esm.js","sources":["../src/snapshot.js"],"sourcesContent":["import { join, dirname } from 'path';\nimport fs from 'fs';\nimport assert from 'assert';\n\n function getCallerFile() {\n \tvar orig = Error.prepareStackTrace;\n \tError.prepareStackTrace = function(_, stack){ return stack; };\n \tvar stack = new Error().stack;\n\tError.prepareStackTrace = orig;\n\t// 0 is this function itself\n\t// 1 is the calling function: snapshot\n\t// 2 is the caller of the snapshot function\n\treturn stack[2].getFileName();\n};\n\nexport default function snapshot(id, content, ignoreSpaces) {\n\tif (ignoreSpaces) content = content.trim().replace(/>\\s+/g, '>').replace(/\\s+</g, '<');\n\tvar snapshotsDir = join(dirname(getCallerFile()), 'snapshots');\n\tvar snapshotFile = join(snapshotsDir, id);\n\tif (!fs.existsSync(snapshotsDir)) fs.mkdirSync(snapshotsDir);\n\tif (!fs.existsSync(snapshotFile)) {\n\t\tfs.writeFileSync(snapshotFile, content);\n\t\tconsole.log('Creating snapshot:', snapshotFile);\n\t} else {\n\t\tvar snapshotContent = fs.readFileSync(snapshotFile);\n\t\tassert.equal(content, String(snapshotContent));\n\t}\n}\n"],"names":[],"mappings":";;;;AAIC,SAAS,aAAa,GAAG;EACxB,IAAI,IAAI,GAAG,KAAK,CAAC,iBAAiB,CAAC;EACnC,KAAK,CAAC,iBAAiB,GAAG,SAAS,CAAC,EAAE,KAAK,CAAC,EAAE,OAAO,KAAK,CAAC,EAAE,CAAC;EAC9D,IAAI,KAAK,GAAG,IAAI,KAAK,EAAE,CAAC,KAAK,CAAC;CAC/B,KAAK,CAAC,iBAAiB,GAAG,IAAI,CAAC;;;;CAI/B,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;CAC9B,AACD;AACA,AAAe,SAAS,QAAQ,CAAC,EAAE,EAAE,OAAO,EAAE,YAAY,EAAE;CAC3D,IAAI,YAAY,EAAE,OAAO,GAAG,OAAO,CAAC,IAAI,EAAE,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;CACvF,IAAI,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC;CAC/D,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;CAC1C,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,YAAY,CAAC,EAAE,EAAE,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;CAC7D,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,YAAY,CAAC,EAAE;EACjC,EAAE,CAAC,aAAa,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;EACxC,OAAO,CAAC,GAAG,CAAC,oBAAoB,EAAE,YAAY,CAAC,CAAC;EAChD,MAAM;EACN,IAAI,eAAe,GAAG,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;EACpD,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC;EAC/C;CACD;;;;"}