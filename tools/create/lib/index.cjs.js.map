{"version":3,"file":"index.cjs.js","sources":["../src/project.js","../src/utils.js","../src/index.js"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport mkdirp from 'mkdirp';\n\n// fs.mkdirSync recursive is not supported on earlier node versions\nfunction mkdirSync(dir) {\n  mkdirp.sync(dir);\n}\n\nvar VAR_RX = /%%\\s*([a-zA-Z_$][0-9a-zA-Z_$]*)\\s*%%/g\nfunction evalTemplate(content, vars) {\n  return content.replace(VAR_RX, function(m, p1) {\n    return p1 in vars ? vars[p1] : m;\n  });\n}\n\nfunction copyFile(src, dst, vars) {\n  var file = dst, content = fs.readFileSync(src, \"utf8\");\n  if (dst.endsWith('.t')) {\n    file = dst.substring(0, dst.length-2);\n    content = evalTemplate(content, vars);\n  }\n  fs.writeFileSync(file, content);\n}\n\n// copy content of src dir into another dir (create if missing) by transforming the given transformer\nfunction copyTree(src, dst, vars) {\n  var src = path.normalize(src);\n  var dst = path.normalize(dst);\n  if (!fs.existsSync(dst)) {\n    fs.mkdirSync(dst);\n  }\n\n  fs.readdirSync(src).forEach(file => {\n    _copyTree(path.join(src, file), path.join(dst, file), vars);\n  });\n\n}\nfunction _copyTree(src, dst, vars) {\n    var stats = fs.lstatSync(src);\n    if (stats.isDirectory()) {\n      mkdirSync(dst);\n      fs.readdirSync(src).forEach(file => {\n        _copyTree(path.join(src, file), path.join(dst, file), vars);\n      });\n    } else if (stats.isFile()) {\n        copyFile(src, dst, vars);\n    } // ignore symbolic links\n}\n\nfunction createProject(type, target, vars) {\n  copyTree(path.normalize(path.join(__dirname, '../templates/common')), target, vars);\n  copyTree(path.normalize(path.join(__dirname, '../templates/'+type)), target, vars);\n}\n\nexport default createProject;\n\n","import { spawnSync } from 'child_process';\n\nvar CAMEL_TO_KEBAB_RX = /([\\$A-Za-z0-9])([A-Z])/g;\n\nfunction camelToKebab(value) {\n\treturn value.replace(CAMEL_TO_KEBAB_RX, '$1-$2').toLowerCase();\n}\n\nfunction capitalizeFirst(value) {\n\treturn value[0].toUpperCase()+value.substring(1);\n}\n\nfunction kebabToCamel(value) {\n\tvar i = value.indexOf('-');\n\tif (i == -1) return value;\n\tvar out = value.substring(0, i);\n\tvar s = i+1;\n\ti = value.indexOf('-', s);\n\twhile (i > -1) {\n\t\tout += capitalizeFirst(value.substring(s, i));\n\t\ts = i+1;\n\t\ti = value.indexOf('-', s);\n\t}\n\tif (s < value.length) {\n\t\tout += capitalizeFirst(value.substring(s));\n\t}\n\treturn out;\n}\n\nfunction normalizeName(value) {\n\treturn camelToKebab(value.trim().replace(/\\s+/g, '-'));\n}\n\nfunction componentName(value) {\n\treturn capitalizeFirst(kebabToCamel(value));\n}\n\nfunction npmInstall(cwd, depType, dep) {\n    var args = ['install', depType, dep];\n    return spawnSync(\"npm\", args, {\n        cwd: cwd,\n        //stdio: 'inherit',\n    });\n}\n\n// for dev. only - as a fallback for install to be able install local qute packages\nfunction npmLink(cwd, dep) {\n    var args = ['link', dep];\n    return spawnSync(\"npm\", args, {\n        cwd: cwd,\n        //stdio: 'inherit',\n    });\n}\n\n export {\n \tcomponentName, normalizeName, npmInstall, npmLink\n }\n\n","/*\n\nThis utility will walk you through creating a package.json file.\nIt only covers the most common items, and tries to guess sensible defaults.\n\nSee `npm help json` for definitive documentation on these fields\nand exactly what they do.\n\nUse `npm install <pkg>` afterwards to install a package and\nsave it as a dependency in the package.json file.\n\nPress ^C at any time to quit.\npackage name: (jsprompt)\nversion: (1.0.0)\ndescription:\nentry point: (index.js)\ntest command:\ngit repository:\nkeywords:\nauthor:\nlicense: (ISC)\nAbout to write to /Users/bogdan/tmp/jsprompt/package.json:\n\n{\n  \"name\": \"jsprompt\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n  },\n  \"author\": \"\",\n  \"license\": \"ISC\"\n}\n\n\nIs this OK? (yes)\n*/\n\nimport fs from 'fs';\nimport path from 'path';\nimport prompts from 'prompts';\nimport Progress from 'progress';\nimport createProject from './project.js';\n\nimport { normalizeName, componentName, npmInstall } from './utils.js';\n\n\nfunction installDeps(target) {\n      var cmds = [\n      ['-D', 'rollup'],\n      ['-D', 'rollup-plugin-commonjs'],\n      ['-D', 'rollup-plugin-node-resolve'],\n      ['-D', 'rollup-plugin-buble'],\n      ['-D', 'rollup-plugin-uglify'],\n      ['-D', 'rollup-plugin-postcss'],\n      ['-D', 'rollup-plugin-koa-devserver'],\n      // test deps\n      ['-D', 'mocha'],\n      ['-D', '@babel/core'],\n      ['-D', '@babel/register'],\n      ['-D', '@babel/preset-env'],\n      ['-D', 'source-map-support'],\n      ['-P', '@qutejs/window'],\n      ['-P', '@qutejs/runtime'],\n      ['-D', '@qutejs/dev'],\n      ['-D', '@qutejs/rollup-plugin-qute'],\n      ['-D', '@qutejs/register'],\n      //['-D', '@qutejs/test-utils']\n    ];\n    var progress = new Progress('Installing dependencies [:bar] :percent > :token', {\n      total: cmds.length+1,\n      //width: cmds.length\n    });\n    cmds.forEach(function(args) {\n      progress.tick({token: args[1]});\n      npmInstall(target, args[0], args[1]);\n    });\n    progress.tick({token: 'done'});\n}\n\nasync function main(target, type) {\n  target = target ? path.resolve(target) : process.cwd();\n  if (fs.existsSync(path.join(target, 'package.json'))) {\n  \tconsole.log(\"You already have a package.json file. This tool should be used to create new Qute projects\");\n  \tprocess.exit(1);\n  }\n\n  var questions = [\n    {type: 'text', name: 'name', message: \"package name\", initial: path.basename(target)},\n    {type: 'text', name: 'version', message: 'version', initial:'1.0.0'},\n    {type: 'text', name: 'description', message: 'description'},\n    {type: 'text', name: 'author', message: 'author'},\n    {type: 'text', name: 'license', message: 'license', initial: 'MIT'}\n  ];\n  if (!type) {\n    questions.unshift({\n      type: 'select', name: 'type',\n      message: 'Which kind of project do you want to create?',\n      choices: [\n        {title: 'Qute application', value:'app', description: 'Build a web application'},\n        {title: 'Qute component', value:'component', description: 'Build a reusable component'}\n      ]});\n  }\n\n  var response = await prompts(questions);\n  //response = Object.assign(response, builtinVars);\n  response.name = normalizeName(response.name); // kebab case form\n  response.componentName = componentName(response.name);\n  createProject(response.type, target, response);\n  installDeps(target);\n}\n\nexport default main;\n"],"names":["spawnSync"],"mappings":"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"}