{"version":3,"file":"index.cjs.js","sources":["../src/project.js","../src/utils.js","../src/index.js"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\n\nvar VAR_RX = /%%\\s*([a-zA-Z_$][0-9a-zA-Z_$]*)\\s*%%/g\nfunction evalTemplate(content, vars) {\n  return content.replace(VAR_RX, function(m, p1) {\n    return p1 in vars ? vars[p1] : m;\n  });\n}\n\nfunction copyFile(src, dst, vars) {\n  var file = dst, content = fs.readFileSync(src, \"utf8\");\n  if (dst.endsWith('.t')) {\n    file = dst.substring(0, dst.length-2);\n    content = evalTemplate(content, vars);\n  }\n  fs.writeFileSync(file, content);\n}\n\n// copy content of src dir into another dir (create if missing) by transforming the given transformer\nfunction copyTree(src, dst, vars) {\n  var src = path.normalize(src);\n  var dst = path.normalize(dst);\n  if (!fs.existsSync(dst)) {\n    fs.mkdirSync(dst);\n  }\n\n  fs.readdirSync(src).forEach(file => {\n    _copyTree(path.join(src, file), path.join(dst, file), vars);\n  });\n\n}\nfunction _copyTree(src, dst, vars) {\n    var stats = fs.lstatSync(src);\n    if (stats.isDirectory()) {\n      fs.mkdirSync(dst, {recursive:true});\n      fs.readdirSync(src).forEach(file => {\n        _copyTree(path.join(src, file), path.join(dst, file), vars);\n      });\n    } else if (stats.isFile()) {\n        copyFile(src, dst, vars);\n    } // ignore symbolic links\n}\n\nfunction createProject(type, target, vars) {\n  copyTree(path.normalize(path.join(__dirname, '../templates/common')), target, vars);\n  copyTree(path.normalize(path.join(__dirname, '../templates/'+type)), target, vars);\n}\n\nexport default createProject;\n\n","import { spawnSync } from 'child_process';\n\nvar CAMEL_TO_KEBAB_RX = /([\\$A-Za-z0-9])([A-Z])/g;\n\nfunction camelToKebab(value) {\n\treturn value.replace(CAMEL_TO_KEBAB_RX, '$1-$2').toLowerCase();\n}\n\nfunction capitalizeFirst(value) {\n\treturn value[0].toUpperCase()+value.substring(1);\n}\n\nfunction kebabToCamel(value) {\n\tvar i = value.indexOf('-');\n\tif (i == -1) return value;\n\tvar out = value.substring(0, i);\n\tvar s = i+1;\n\ti = value.indexOf('-', s);\n\twhile (i > -1) {\n\t\tout += capitalizeFirst(value.substring(s, i));\n\t\ts = i+1;\n\t\ti = value.indexOf('-', s);\n\t}\n\tif (s < value.length) {\n\t\tout += capitalizeFirst(value.substring(s));\n\t}\n\treturn out;\n}\n\nfunction normalizeName(value) {\n\treturn camelToKebab(value.trim().replace(/\\s+/g, '-'));\n}\n\nfunction componentName(value) {\n\treturn capitalizeFirst(kebabToCamel(value));\n}\n\nfunction npmInstall(cwd, depType, dep) {\n    var args = ['install', depType, dep];\n    return spawnSync(\"npm\", args, {\n        cwd: cwd,\n        //stdio: 'inherit',\n    });\n}\n\n// for dev. only - as a fallback for install to be able install local qute packages\nfunction npmLink(cwd, dep) {\n    var args = ['link', dep];\n    return spawnSync(\"npm\", args, {\n        cwd: cwd,\n        //stdio: 'inherit',\n    });\n}\n\n export {\n \tcomponentName, normalizeName, npmInstall, npmLink\n }\n\n","/*\n\nThis utility will walk you through creating a package.json file.\nIt only covers the most common items, and tries to guess sensible defaults.\n\nSee `npm help json` for definitive documentation on these fields\nand exactly what they do.\n\nUse `npm install <pkg>` afterwards to install a package and\nsave it as a dependency in the package.json file.\n\nPress ^C at any time to quit.\npackage name: (jsprompt)\nversion: (1.0.0)\ndescription:\nentry point: (index.js)\ntest command:\ngit repository:\nkeywords:\nauthor:\nlicense: (ISC)\nAbout to write to /Users/bogdan/tmp/jsprompt/package.json:\n\n{\n  \"name\": \"jsprompt\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n  },\n  \"author\": \"\",\n  \"license\": \"ISC\"\n}\n\n\nIs this OK? (yes)\n*/\n\nimport fs from 'fs';\nimport path from 'path';\nimport prompts from 'prompts';\nimport Progress from 'progress';\nimport createProject from './project.js';\n\nimport { normalizeName, componentName, npmInstall } from './utils.js';\n\n\nfunction installDeps(target) {\n      var cmds = [\n      ['-D', 'rollup'],\n      ['-D', 'rollup-plugin-commonjs'],\n      ['-D', 'rollup-plugin-node-resolve'],\n      ['-D', 'rollup-plugin-buble'],\n      ['-D', 'rollup-plugin-uglify'],\n      ['-D', 'rollup-plugin-postcss'],\n      ['-D', 'rollup-plugin-serve'],\n      ['-D', 'rollup-plugin-livereload'],\n      // test deps\n      ['-D', 'mocha'],\n      ['-D', '@babel/core'],\n      ['-D', '@babel/register'],\n      ['-D', '@babel/preset-env'],\n      ['-D', 'source-map-support'],\n      ['-P', '@qutejs/window'],\n      ['-P', '@qutejs/runtime'],\n      ['-D', '@qutejs/dev'],\n      ['-D', '@qutejs/rollup-plugin-qute'],\n      ['-D', '@qutejs/register'],\n      //['-D', '@qutejs/test-utils']\n    ];\n    var progress = new Progress('Installing dependencies [:bar] :percent > :token', {\n      total: cmds.length+1,\n      //width: cmds.length\n    });\n    cmds.forEach(function(args) {\n      progress.tick({token: args[1]});\n      npmInstall(target, args[0], args[1]);\n    });\n    progress.tick({token: 'done'});\n}\n\nasync function main(target, type) {\n  target = target ? path.resolve(target) : process.cwd();\n  if (fs.existsSync(path.join(target, 'package.json'))) {\n  \tconsole.log(\"You already have a package.json file. This tool should be used to create new Qute projects\");\n  \tprocess.exit(1);\n  }\n\n  var questions = [\n    {type: 'text', name: 'name', message: \"package name\", initial: path.basename(target)},\n    {type: 'text', name: 'version', message: 'version', initial:'1.0.0'},\n    {type: 'text', name: 'description', message: 'description'},\n    {type: 'text', name: 'author', message: 'author'},\n    {type: 'text', name: 'license', message: 'license', initial: 'MIT'}\n  ];\n  if (!type) {\n    questions.unshift({\n      type: 'select', name: 'type',\n      message: 'Which kind of project do you want to create?',\n      choices: [\n        {title: 'Qute application', value:'app', description: 'Build a web application'},\n        {title: 'Qute component', value:'component', description: 'Build a reusable component'}\n      ]});\n  }\n\n  var response = await prompts(questions);\n  //response = Object.assign(response, builtinVars);\n  response.name = normalizeName(response.name); // kebab case form\n  response.componentName = componentName(response.name);\n  createProject(response.type, target, response);\n  installDeps(target);\n}\n\nexport default main;\n"],"names":["spawnSync"],"mappings":"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"}